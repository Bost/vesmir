#lang racket/base

(define (partial fun . args)
  (lambda x (apply fun (append args x))))

;; > aws s3 ls s3://vesmir/2021-12-01_Martin/
(define files
  '(
    "20211222_141930.jpg"
    "20211222_141940.jpg"
    "20211222_141944.jpg"
    "20211222_141949.jpg"
    ;; "20211222_142041.jpg"
    ;; "20211222_142045.jpg"
    ;; "20211222_142121.jpg"
    ;; "20211222_142126.jpg"
    ;; "20211222_142130.jpg"
    ;; "20211222_142134.jpg"
    ;; "20211222_142336.jpg"
    ;; "20211222_142340.jpg"
    ;; "20211222_142346.jpg"
    ;; "20211222_143144.jpg"
    ;; "20211222_143149.jpg"
    ;; "20211222_143155.jpg"
    ;; "20211222_143157.jpg"
    ;; "20211222_143504.jpg"
    ;; "20211222_143542.jpg"
    ;; "20211222_143549.jpg"
    ;; "20211222_143602.jpg"
    ;; "20211222_143618.jpg"
    ;; "20211222_143641.jpg"
    ;; "20211222_143940.jpg"
    ;; "20211222_144036.jpg"
    ;; "20211222_144038.jpg"
    ;; "20211222_144043.jpg"
    ;; "20211222_144105.jpg"
    ;; "20211222_144108.jpg"
    ;; "20211222_144230.jpg"
    ;; "20211222_144234.jpg"
    ;; "20211222_144255.jpg"
    ;; "20211222_144300.jpg"
    ;; "20211222_144405.jpg"
    ;; "20211222_144408.jpg"
    ;; "20211222_144411.jpg"
    ;; "20211222_144505.jpg"
    ;; "20211222_144547.jpg"
    ;; "20211222_144718.jpg"
    ;; "20211222_144727.jpg"
    ;; "20211222_144735.jpg"
    ;; "20211222_144740.jpg"
    ;; "20211222_144742.jpg"
    ;; "20211222_144859.jpg"
    ;; "20211222_144902.jpg"
    ;; "20211222_144906.jpg"
    ;; "20211222_144948.jpg"
    ;; "20211222_144954.jpg"
    ;; "20211222_145224.jpg"
    ;; "20211222_145347.jpg"
    ;; "20211222_145449.jpg"
    ;; "20211222_145451.jpg"
    ;; "20211222_145459.jpg"
    ;; "20211222_145511.jpg"
    ;; "20211222_145513.jpg"
    ;; "20211223_153231.jpg"
    ;; "20211223_153235.jpg"
    ;; "20211223_153241.jpg"
    ;; "20211223_153305.jpg"
    ;; "20211223_153415.jpg"
    ;; "20211224_144607.jpg"
    ;; "20211224_144610.jpg"
    ;; "20211224_144620.jpg"
    ;; "20211224_144905.jpg"
    ;; "20211224_144931.jpg"
    ;; "20211224_145050.jpg"
    ;; "20211224_145133.jpg"
    ;; "20211224_145159.jpg"
    ;; "20211224_145206.jpg"
    ;; "20211224_145218.jpg"
    ;; "20211224_145452.jpg"
    ;; "20211224_145453.jpg"
    ;; "20211224_145553.jpg"
    ;; "20211224_145740.jpg"
    ;; "20211224_145938.jpg"
    ;; "20211225_145145.jpg"
    ;; "20211226_151957.jpg"
    ;; "20211226_152003.jpg"
    ;; "20211226_152006.jpg"
    ;; "20211226_152012.jpg"
    ;; "20211226_152013.jpg"
    ;; "20211226_152114.jpg"
    ;; "20211226_152117.jpg"
    ;; "20211226_152226.jpg"
    ;; "20211226_152228.jpg"
    ;; "20211226_152230.jpg"
    ;; "20211226_152236.jpg"
    ;; "20211226_152325.jpg"
    ;; "20211226_152503.jpg"
    ;; "20211226_152508.jpg"
    ;; "20211226_152511.jpg"
    ;; "20211226_152514.jpg"
    ;; "20211226_152540.jpg"
    ;; "20211226_152542.jpg"
    ;; "20211226_152546.jpg"
    ;; "20211226_152549.jpg"
    ;; "20211226_153258.jpg"
    ;; "20211226_153300.jpg"
    ;; "20211226_154051_002.jpg"
    ;; "20211226_154051_006.jpg"
    ;; "20211226_154051_015.jpg"
    ;; "20211226_154051_023.jpg"
    ;; "20211226_154051_028.jpg"
    ;; "20211226_154107.jpg"
    ;; "20211226_154110.jpg"
    ;; "20211226_154112.jpg"
    ;; "20211226_154114.jpg"
    ;; "20211226_154117.jpg"
    ;; "20211226_154248.jpg"
    ;; "20211226_154250.jpg"
    ;; "20211226_154307.jpg"
    ;; "20211226_154308.jpg"
    ;; "20211226_154310.jpg"
    ;; "20211226_155933.jpg"
    ;; "20211226_155937.jpg"
    ;; "20211226_155939.jpg"
    ;; "20211226_160958.jpg"
    ))

(define (html-tag fpath)
  (let* ([full-fpath (string-append
                      "https://vesmir.s3.eu-central-1.amazonaws.com/2021-12-01_Martin/"
                      fpath)]
         [href (list 'href full-fpath)]
         [src (list 'src full-fpath)]
         [a-attrs (list '[target "_blank"] href)]
         [img-attrs (list src)]
         [img (list 'img img-attrs)]
         [a (list 'a a-attrs img)])
    a
    #;(append '(a ([target "_blank"] [href full-fpath])
                #;(img ([src full-fpath])))
            )
    #;'(a ([target "_blank"] [href full-fpath])
        (img ([src full-fpath])))))

(define (tags)
  (map html-tag files))

#;(provide (all-defined-out))
(provide tags)
