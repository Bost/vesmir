import * as $rjs_core from '../../../../runtime/core.js';import * as M0 from "../../../../collects/racket/private/map.rkt.js";import * as M1 from "../../../racketscript-compiler/racketscript/interop.rkt.js";import * as M2 from "../../../../runtime/kernel.rkt.js";import * as M3 from "../private/jscommon.rkt.js";import * as M4 from "../../../../collects/racket/private/list.rkt.js";import * as M5 from "../../../racketscript-compiler/racketscript/private/interop.rkt.js";import * as M6 from "./private/color.rkt.js";var let_result1372 = M2.make_struct_type($rjs_core.PrimitiveSymbol.make("posn"),false,2,0,false,M2.rnull,false,false,$rjs_core.Pair.makeList(0,1),false,$rjs_core.PrimitiveSymbol.make("posn"));var struct_2361 = let_result1372.getAt(0);var make_2362 = let_result1372.getAt(1);var __p2363 = let_result1372.getAt(2);var __ref2364 = let_result1372.getAt(3);var __set_bang_2365 = let_result1372.getAt(4);var let_result1373 = M2.values(struct_2361,make_2362,__p2363,M2.make_struct_field_accessor(__ref2364,0,$rjs_core.PrimitiveSymbol.make("x")),M2.make_struct_field_accessor(__ref2364,1,$rjs_core.PrimitiveSymbol.make("y")));var struct_posn = let_result1373.getAt(0);var make_posn = let_result1373.getAt(1);var posn_p = let_result1373.getAt(2);var posn_x = let_result1373.getAt(3);var posn_y = let_result1373.getAt(4);var ___gt_web_color = function(p2366) {if (M2.string_p(p2366)!==false) {var if_res1376 = M6.string__gt_web_color(p2366);} else {if (M6.color_p(p2366)!==false) {var if_res1375 = M6.color__gt_web_color(p2366);} else {if (M2.symbol_p(p2366)!==false) {var if_res1374 = M6.string__gt_web_color(M2.symbol__gt_string(p2366));} else {var if_res1374 = M2.error($rjs_core.PrimitiveSymbol.make("color"),$rjs_core.UString.make("invalid color"));}var if_res1375 = if_res1374;}var if_res1376 = if_res1375;}return if_res1376;};var print_image = function(d2367) {var canvas2368 = M3.document.createElement("canvas");var ctx2369 = canvas2368.getContext("2d");M3.document.body.appendChild(canvas2368);M3.document.body.appendChild(M3.document.createElement("br"));canvas2368.width = d2367.width;canvas2368.height = d2367.height;ctx2369.save();ctx2369.translate(d2367.width/2,d2367.height/2);d2367.render(ctx2369,0,0);return ctx2369.restore();};var canvas2370 = M3.document.createElement("canvas");var __times_invisible_canvas_context_times_ = canvas2370.getContext("2d");var empty_image = {'type':$rjs_core.UString.make("empty-image"),'width':0,'height':0,'render':function(ctx2371, x2372, y2373) {return M2.rvoid();}};var image_height = function(i2374) {return i2374.height;};var image_width = function(i2375) {return i2375.width;};var EmptyScene = function(width2376, height2377, borders_p2378) {var this2379 = this;this2379.type = $rjs_core.UString.make("empty-scene");this2379.width = width2376;this2379.height = height2377;this2379.borders_p = borders_p2378;return null;};EmptyScene.prototype.render = function(ctx2380, x2381, y2382) {return M2.rvoid();};var Text = function(text2383, size2384, color2385, face2386, family2387, style2388, weight2389, underline_p2390) {var this2391 = this;this2391.type = $rjs_core.UString.make("text");this2391.text = text2383;this2391.size = size2384;this2391.color = ___gt_web_color(color2385);this2391.face = face2386;this2391.family = family2387;this2391.style = style2388;this2391.weight = weight2389;this2391.underline = underline_p2390;return this2391._updateMetrics();};Text.prototype._updateMetrics = function() {var this2392 = this;var font2393 = M2.string_append(this2392.weight,$rjs_core.UString.make(" "),this2392.style,$rjs_core.UString.make(" "),M2.number__gt_string(this2392.size),$rjs_core.UString.make("px "),this2392.face,$rjs_core.UString.make(" "),this2392.family);__times_invisible_canvas_context_times_.font = M1.js_string(font2393);var let_result1377 = M2.values();var metrics2394 = __times_invisible_canvas_context_times_.measureText(M1.js_string(this2392.text));this2392.font = font2393;this2392.width = metrics2394.width;this2392.height = this2392.size;return null;};Text.prototype.render = function(ctx2395, x2396, y2397) {var this2398 = this;ctx2395.save();ctx2395.translate(x2396,y2397);ctx2395.font = M1.js_string(this2398.font);ctx2395.textAlign = "center";ctx2395.textBaseline = "middle";ctx2395.fillStyle = M1.js_string(this2398.color);ctx2395.fillText(M1.js_string(this2398.text),0,0);return ctx2395.restore();};var Line = function(x2399, y2400, pen_or_color2401) {var this2402 = this;this2402.type = $rjs_core.UString.make("line");this2402.width = M3.abs_plus_ceil(x2399);this2402.height = M3.abs_plus_ceil(y2400);this2402.mode = false;this2402.pen = pen_or_color2401;return null;};Line.prototype.render = function(ctx2403, x2404, y2405) {var this2406 = this;ctx2403.save();var let_result1378 = M2.values();ctx2403.translate(x2404,y2405);var let_result1379 = M2.values();ctx2403.beginPath();var let_result1380 = M2.values();var sx2407 = M2.__(M2.abs(this2406.x/2));var sy2408 = M2.__(M2.abs(this2406.y/2));if (M2.__gt__eq_(x2404,0)!==false) {var if_res1381 = M2.__gt__eq_(y2405,0);} else {var if_res1381 = false;}if (if_res1381!==false) {ctx2403.moveTo(sx2407,sy2408);var if_res1388 = ctx2403.lineTo(sx2407+x2404,sy2408+y2405);} else {if (M2.__gt__eq_(x2404,0)!==false) {var if_res1382 = M2.__lt_(y2405,0);} else {var if_res1382 = false;}if (if_res1382!==false) {ctx2403.moveTo(sx2407+x2404,sy2408);var if_res1387 = ctx2403.lineTo(sx2407,sy2408-y2405);} else {if (M2.__lt_(x2404,0)!==false) {var if_res1383 = M2.__gt__eq_(y2405,0);} else {var if_res1383 = false;}if (if_res1383!==false) {ctx2403.moveTo(sx2407,sy2408+y2405);var if_res1386 = ctx2403.lineTo(sx2407-x2404,sy2408);} else {if (M2.__lt_(x2404,0)!==false) {var if_res1384 = M2.__lt_(y2405,0);} else {var if_res1384 = false;}if (if_res1384!==false) {ctx2403.moveTo(sx2407-x2404,sy2408-y2405);var if_res1385 = ctx2403.lineTo(sx2407,sy2408);} else {var if_res1385 = M2.rvoid();}var if_res1386 = if_res1385;}var if_res1387 = if_res1386;}var if_res1388 = if_res1387;}if_res1388;var or_part2409 = M2.equal_p($rjs_core.UString.make("outline"),$rjs_core.PrimitiveSymbol.make("outline"));if (or_part2409!==false) {var if_res1389 = or_part2409;} else {var if_res1389 = M2.equal_p($rjs_core.UString.make("outline"),$rjs_core.UString.make("outline"));}if (if_res1389!==false) {ctx2403.strokeStyle = M1.js_string(___gt_web_color(this2406.pen));var if_res1392 = ctx2403.stroke();} else {var or_part2410 = M2.equal_p($rjs_core.UString.make("outline"),$rjs_core.PrimitiveSymbol.make("solid"));if (or_part2410!==false) {var if_res1390 = or_part2410;} else {var if_res1390 = M2.equal_p($rjs_core.UString.make("outline"),$rjs_core.UString.make("solid"));}if (if_res1390!==false) {ctx2403.fillStyle = M1.js_string(___gt_web_color(this2406.pen));var if_res1391 = ctx2403.fill();} else {var if_res1391 = M2.rvoid();}var if_res1392 = if_res1391;}if_res1392;ctx2403.closePath();return ctx2403.restore();};var Rectangle = function(width2411, height2412, mode2413, pen_or_color2414) {var this2415 = this;this2415.type = $rjs_core.UString.make("rectangle");this2415.width = width2411;this2415.height = height2412;this2415.mode = mode2413;this2415.pen = pen_or_color2414;return null;};Rectangle.prototype.render = function(ctx2416, x2417, y2418) {var this2419 = this;ctx2416.save();ctx2416.translate(x2417,y2418);ctx2416.beginPath();var width2420 = this2419.width;var height2421 = this2419.height;var start_x2422 = M2.__(width2420/2);var start_y2423 = M2.__(height2421/2);ctx2416.rect(start_x2422,start_y2423,width2420,height2421);var or_part2424 = M2.equal_p(this2419.mode,$rjs_core.PrimitiveSymbol.make("outline"));if (or_part2424!==false) {var if_res1393 = or_part2424;} else {var if_res1393 = M2.equal_p(this2419.mode,$rjs_core.UString.make("outline"));}if (if_res1393!==false) {ctx2416.strokeStyle = M1.js_string(___gt_web_color(this2419.pen));var if_res1396 = ctx2416.stroke();} else {var or_part2425 = M2.equal_p(this2419.mode,$rjs_core.PrimitiveSymbol.make("solid"));if (or_part2425!==false) {var if_res1394 = or_part2425;} else {var if_res1394 = M2.equal_p(this2419.mode,$rjs_core.UString.make("solid"));}if (if_res1394!==false) {ctx2416.fillStyle = M1.js_string(___gt_web_color(this2419.pen));var if_res1395 = ctx2416.fill();} else {var if_res1395 = M2.rvoid();}var if_res1396 = if_res1395;}if_res1396;ctx2416.closePath();return ctx2416.restore();};var Circle = function(radius2426, mode2427, pen_or_color2428) {var this2429 = this;var diameter2430 = radius2426*2;this2429.type = $rjs_core.UString.make("circle");this2429.radius = radius2426;this2429.width = diameter2430;this2429.height = diameter2430;this2429.mode = mode2427;this2429.pen = pen_or_color2428;return null;};Circle.prototype.render = function(ctx2431, x2432, y2433) {var this2434 = this;var radius2435 = this2434.radius;ctx2431.save();ctx2431.translate(x2432,y2433);ctx2431.beginPath();ctx2431.ellipse(0,0,radius2435,radius2435,0,0,M3.Math.PI*2);var or_part2436 = M2.equal_p(this2434.mode,$rjs_core.PrimitiveSymbol.make("outline"));if (or_part2436!==false) {var if_res1397 = or_part2436;} else {var if_res1397 = M2.equal_p(this2434.mode,$rjs_core.UString.make("outline"));}if (if_res1397!==false) {ctx2431.strokeStyle = M1.js_string(___gt_web_color(this2434.pen));var if_res1400 = ctx2431.stroke();} else {var or_part2437 = M2.equal_p(this2434.mode,$rjs_core.PrimitiveSymbol.make("solid"));if (or_part2437!==false) {var if_res1398 = or_part2437;} else {var if_res1398 = M2.equal_p(this2434.mode,$rjs_core.UString.make("solid"));}if (if_res1398!==false) {ctx2431.fillStyle = M1.js_string(___gt_web_color(this2434.pen));var if_res1399 = ctx2431.fill();} else {var if_res1399 = M2.rvoid();}var if_res1400 = if_res1399;}if_res1400;ctx2431.closePath();return ctx2431.restore();};var Polygon = function(vertices2438, mode2439, pen_or_color2440) {var this2441 = this;var xs2442 = M0.map(posn_x,vertices2438);var ys2443 = M0.map(posn_y,vertices2438);var width2444 = M2.apply(M2.max,xs2442)-M2.apply(M2.min,xs2442);var height2445 = M2.apply(M2.max,ys2443)-M2.apply(M2.min,xs2442);this2441.type = $rjs_core.UString.make("polygon");this2441.vertices = vertices2438;this2441.width = width2444;this2441.height = height2445;this2441.mode = mode2439;this2441.pen = pen_or_color2440;return null;};Polygon.prototype.render = function(ctx2446, x2447, y2448) {var this2449 = this;var first_point2450 = M2.car(this2449.vertices);var rest_points2451 = M2.cdr(this2449.vertices);var radius2452 = this2449.radius;ctx2446.save();ctx2446.translate(x2447,y2448);ctx2446.beginPath();ctx2446.moveTo(posn_x(first_point2450),posn_y(first_point2450));var loop2453 = function(points2454) {if (M2.null_p(points2454)!==false) {var if_res1401 = M2.rvoid();} else {var pt2455 = M2.car(points2454);ctx2446.lineTo(posn_x(pt2455),posn_y(pt2455));var if_res1401 = loop2453(M2.cdr(points2454));}return if_res1401;};loop2453(rest_points2451);var or_part2456 = M2.equal_p(this2449.mode,$rjs_core.PrimitiveSymbol.make("outline"));if (or_part2456!==false) {var if_res1402 = or_part2456;} else {var if_res1402 = M2.equal_p(this2449.mode,$rjs_core.UString.make("outline"));}if (if_res1402!==false) {ctx2446.strokeStyle = M1.js_string(___gt_web_color(this2449.pen));var if_res1405 = ctx2446.stroke();} else {var or_part2457 = M2.equal_p(this2449.mode,$rjs_core.PrimitiveSymbol.make("solid"));if (or_part2457!==false) {var if_res1403 = or_part2457;} else {var if_res1403 = M2.equal_p(this2449.mode,$rjs_core.UString.make("solid"));}if (if_res1403!==false) {ctx2446.fillStyle = M1.js_string(___gt_web_color(this2449.pen));var if_res1404 = ctx2446.fill();} else {var if_res1404 = M2.rvoid();}var if_res1405 = if_res1404;}if_res1405;ctx2446.closePath();return ctx2446.restore();};var empty_scene = function(width2458, height2459) {return new EmptyScene(width2458,height2459,false);};var text = function(txt2460, size2461, color2462) {return new Text(txt2460,size2461,color2462,$rjs_core.UString.make(""),$rjs_core.UString.make("serif"),$rjs_core.UString.make("normal"),$rjs_core.UString.make("normal"),false);};var text_by_font = function(txt2463, size2464, color2465, face2466, family2467, style2468, weight2469, underline_p2470) {var or_part2471 = face2466;if (or_part2471!==false) {var if_res1409 = or_part2471;} else {var if_res1409 = $rjs_core.UString.make("");}if (M2.symbol_p(family2467)!==false) {var if_res1408 = M2.symbol__gt_string(family2467);} else {var if_res1408 = family2467;}if (M2.symbol_p(style2468)!==false) {var if_res1407 = M2.symbol__gt_string(style2468);} else {var if_res1407 = style2468;}if (M2.symbol_p(weight2469)!==false) {var if_res1406 = M2.symbol__gt_string(weight2469);} else {var if_res1406 = weight2469;}return new Text(txt2463,size2464,color2465,if_res1409,if_res1408,if_res1407,if_res1406,underline_p2470);};var line = function(x2472, y2473, pen_or_color2474) {return new Line(x2472,y2473,pen_or_color2474);};var rectangle = function(w2475, h2476, m2477, p2478) {return new Rectangle(w2475,h2476,m2477,p2478);};var square = function(s2479, m2480, p2481) {return new Rectangle(s2479,s2479,m2480,p2481);};var circle = function(r2482, m2483, p2484) {return new Circle(r2482,m2483,p2484);};var triangle = function(side2485, mode2486, color2487) {var height2488 = side2485*(M2.sqrt(3)/2);return new Polygon(M2.list(make_posn(M2.__(side2485/2),height2488/2),make_posn(0,M2.__(height2488/2)),make_posn(side2485/2,height2488/2)),mode2486,color2487);};var Overlay = function(x_place2489, y_place2490, ima2491, imb2492) {var this2493 = this;var ima_cx2494 = ima2491.width/2;var ima_cy2495 = ima2491.height/2;var imb_cx2496 = imb2492.width/2;var imb_cy2497 = imb2492.height/2;var tmp2499 = x_place2489;if (M2.equal_p(tmp2499,$rjs_core.UString.make("beside"))!==false) {var if_res1412 = ima2491.width+imb2492.width;} else {if (M2.number_p(x_place2489)!==false) {if (M2.positive_p(x_place2489)!==false) {var if_res1410 = M2.max(ima2491.width,imb2492.width+x_place2489);} else {var if_res1410 = M2.max(imb2492.width,ima2491.width-x_place2489);}var if_res1411 = if_res1410;} else {var if_res1411 = M2.max(ima2491.width,imb2492.width);}var if_res1412 = if_res1411;}var width2498 = if_res1412;var tmp2501 = y_place2490;if (M2.equal_p(tmp2501,$rjs_core.UString.make("above"))!==false) {var if_res1415 = ima2491.height+imb2492.height;} else {if (M2.number_p(y_place2490)!==false) {if (M2.positive_p(y_place2490)!==false) {var if_res1413 = M2.max(ima2491.height,imb2492.height+y_place2490);} else {var if_res1413 = M2.max(imb2492.height,ima2491.height-y_place2490);}var if_res1414 = if_res1413;} else {var if_res1414 = M2.max(ima2491.height,imb2492.height);}var if_res1415 = if_res1414;}var height2500 = if_res1415;var δ_edge_x2502 = width2498/2;var δ_edge_y2503 = height2500/2;var tmp2506 = x_place2489;if (M2.equal_p(tmp2506,$rjs_core.UString.make("left"))!==false) {var if_res1422 = M2.values(ima_cx2494-δ_edge_x2502,imb_cx2496-δ_edge_x2502);} else {if (M2.equal_p(tmp2506,$rjs_core.UString.make("right"))!==false) {var if_res1421 = M2.values(δ_edge_x2502-ima_cx2494,δ_edge_x2502-imb_cx2496);} else {if (M2.equal_p(tmp2506,$rjs_core.UString.make("beside"))!==false) {var if_res1420 = M2.values(ima_cx2494-δ_edge_x2502,δ_edge_x2502-imb_cx2496);} else {if (M2.equal_p(tmp2506,$rjs_core.UString.make("middle"))!==false) {var if_res1416 = true;} else {var if_res1416 = M2.equal_p(tmp2506,$rjs_core.UString.make("center"));}if (if_res1416!==false) {var if_res1419 = M2.values(0,0);} else {if (M2.number_p(x_place2489)!==false) {var local_width2507 = M2.max(ima2491.width,imb2492.width);var local_acx2508 = ima_cx2494-(local_width2507/2);var local_bcx2509 = imb_cx2496-(local_width2507/2);var acx_bcx2510 = δ_edge_x2502-(local_width2507/2);if (M2.positive_p(x_place2489)!==false) {var if_res1417 = M2.values(local_acx2508-acx_bcx2510,x_place2489+(local_bcx2509-acx_bcx2510));} else {var if_res1417 = M2.values(local_acx2508-x_place2489-acx_bcx2510,local_bcx2509-acx_bcx2510);}var if_res1418 = if_res1417;} else {var if_res1418 = M2.error($rjs_core.UString.make("invalid x-place align"));}var if_res1419 = if_res1418;}var if_res1420 = if_res1419;}var if_res1421 = if_res1420;}var if_res1422 = if_res1421;}var let_result1423 = if_res1422;var δ_a_x2504 = let_result1423.getAt(0);var δ_b_x2505 = let_result1423.getAt(1);var tmp2513 = y_place2490;if (M2.equal_p(tmp2513,$rjs_core.UString.make("top"))!==false) {var if_res1430 = M2.values(ima_cy2495-δ_edge_y2503,imb_cy2497-δ_edge_y2503);} else {if (M2.equal_p(tmp2513,$rjs_core.UString.make("bottom"))!==false) {var if_res1429 = M2.values(δ_edge_y2503-ima_cy2495,δ_edge_y2503-imb_cy2497);} else {if (M2.equal_p(tmp2513,$rjs_core.UString.make("above"))!==false) {var if_res1428 = M2.values(ima_cy2495-δ_edge_y2503,δ_edge_y2503-imb_cy2497);} else {if (M2.equal_p(tmp2513,$rjs_core.UString.make("middle"))!==false) {var if_res1424 = true;} else {var if_res1424 = M2.equal_p(tmp2513,$rjs_core.UString.make("center"));}if (if_res1424!==false) {var if_res1427 = M2.values(0,0);} else {if (M2.number_p(y_place2490)!==false) {var local_height2514 = M2.max(ima2491.height,imb2492.height);var local_acy2515 = ima_cy2495-(local_height2514/2);var local_bcy2516 = imb_cy2497-(local_height2514/2);var acy_bcy2517 = δ_edge_y2503-(local_height2514/2);if (M2.positive_p(y_place2490)!==false) {var if_res1425 = M2.values(local_acy2515-acy_bcy2517,y_place2490+(local_bcy2516-acy_bcy2517));} else {var if_res1425 = M2.values(local_acy2515-y_place2490-acy_bcy2517,local_bcy2516-acy_bcy2517);}var if_res1426 = if_res1425;} else {var if_res1426 = M2.error($rjs_core.UString.make("invalid y-place align"));}var if_res1427 = if_res1426;}var if_res1428 = if_res1427;}var if_res1429 = if_res1428;}var if_res1430 = if_res1429;}var let_result1431 = if_res1430;var δ_a_y2511 = let_result1431.getAt(0);var δ_b_y2512 = let_result1431.getAt(1);this2493.type = $rjs_core.UString.make("overlay");this2493.ima = ima2491;this2493.imb = imb2492;this2493.width = width2498;this2493.height = height2500;this2493.aDx = δ_a_x2504;this2493.aDy = δ_a_y2511;this2493.bDx = δ_b_x2505;this2493.bDy = δ_b_y2512;return null;};Overlay.prototype.render = function(ctx2518, x2519, y2520) {var this2521 = this;var ima2522 = this2521.ima;var imb2523 = this2521.imb;ctx2518.save();ctx2518.translate(x2519,y2520);imb2523.render(ctx2518,this2521.bDx,this2521.bDy);ima2522.render(ctx2518,this2521.aDx,this2521.aDy);return ctx2518.restore();};var Container = function(childs2524, posns2525, width2526, height2527) {var this2528 = this;this2528.type = $rjs_core.UString.make("container");this2528.childs = childs2524;this2528.posns = posns2525;this2528.width = width2526;this2528.height = height2527;return null;};Container.prototype.render = function(ctx2529, x2530, y2531) {var this2532 = this;var width2533 = this2532.width;var height2534 = this2532.height;ctx2529.save();ctx2529.translate(x2530-(width2533/2),y2531-(height2534/2));ctx2529.beginPath();ctx2529.rect(0,0,M2.sub1(width2533),M2.sub1(height2534));ctx2529.clip();var loop2535 = function(childs2536, posns2537) {if (M2.null_p(childs2536)!==false) {var if_res1432 = M2.rvoid();} else {var child2538 = M2.car(childs2536);var posn2539 = M2.car(posns2537);child2538.render(ctx2529,posn_x(posn2539),posn_y(posn2539));var if_res1432 = loop2535(M2.cdr(childs2536),M2.cdr(posns2537));}return if_res1432;};loop2535(this2532.childs,this2532.posns);return ctx2529.restore();};var Bitmap = function(data2540) {var this2541 = this;var image2542 = new Image;image2542.crossOrigin = "anonymous";image2542.src = M1.js_string(data2540);this2541.image = image2542;this2541.width = image2542.width;this2541.height = image2542.height;return null;};Bitmap.prototype.render = function(ctx2543, x2544, y2545) {var this2546 = this;var image2547 = this2546.image;ctx2543.save();ctx2543.translate(x2544,y2545);ctx2543.drawImage(image2547,M2.__(image2547.width/2),M2.__(image2547.height/2));return ctx2543.restore();};var Freeze = function(img2548) {var this2549 = this;var canvas2550 = M3.document.createElement("canvas");var ctx2551 = canvas2550.getContext("2d");var width2552 = img2548.width;var height2553 = img2548.height;canvas2550.width = width2552;canvas2550.height = height2553;ctx2551.save();ctx2551.translate(width2552/2,height2553/2);img2548.render(ctx2551,0,0);ctx2551.restore();this2549.width = width2552;this2549.height = height2553;this2549.canvas = canvas2550;return null;};Freeze.prototype.render = function(ctx2554, x2555, y2556) {var this2557 = this;var width2558 = this2557.width;var height2559 = this2557.height;ctx2554.save();ctx2554.translate(x2555,y2556);ctx2554.drawImage(this2557.canvas,M2.__(width2558/2),M2.__(height2559/2));return ctx2554.restore();};var Rotate = function(image2560, angle2561) {var this2562 = this;var width2563 = image2560.width;var height2564 = image2560.height;var θ2565 = (M3.Math.PI*angle2561)/180.0;var sin_θ2566 = M2.sin(θ2565);var cos_θ2567 = M2.cos(θ2565);var x12568 = cos_θ2567*width2563;var y12569 = sin_θ2566*width2563;var x22570 = M2.__(sin_θ2566)*height2564;var y22571 = cos_θ2567*height2564;var x32572 = x12568+x22570;var y32573 = y12569+y22571;var min_x2574 = M2.min(0,x12568,x22570,x32572);var max_x2575 = M2.max(0,x12568,x22570,x32572);var min_y2576 = M2.min(0,y12569,y22571,y32573);var max_y2577 = M2.max(0,y12569,y22571,y32573);var rotated_width2578 = M2.floor(max_x2575-min_x2574);var rotated_height2579 = M2.floor(max_y2577-min_y2576);this2562.image = image2560;this2562.width = rotated_width2578;this2562.height = rotated_height2579;this2562.degrees = angle2561;this2562.radians = θ2565;return null;};Rotate.prototype.render = function(ctx2580, x2581, y2582) {var this2583 = this;ctx2580.save();ctx2580.translate(x2581,y2582);ctx2580.rotate(this2583.radians);this2583.image.render(ctx2580,0,0);return ctx2580.restore();};var Scale = function(image2584, x_factor2585, y_factor2586) {var this2587 = this;this2587.image = image2584;this2587.x_factor = x_factor2585;this2587.y_factor = y_factor2586;this2587.width = M2.abs(M2.floor(image2584.width*x_factor2585));this2587.height = M2.abs(M2.floor(image2584.height*y_factor2586));return null;};Scale.prototype.render = function(ctx2588, x2589, y2590) {var this2591 = this;ctx2588.save();ctx2588.translate(x2589,y2590);ctx2588.scale(this2591.x_factor,this2591.y_factor);this2591.image.render(ctx2588,0,0);return ctx2588.restore();};var container = function(childs2592, posns2593, width2594, height2595) {return new Container(childs2592,posns2593,width2594,height2595);};var place_image = function(child2596, cx2597, cy2598, base2599) {var width2600 = base2599.width;var height2601 = base2599.height;return container(M2.list(base2599,child2596),M2.list(make_posn(width2600/2,height2601/2),make_posn(cx2597,cy2598)),width2600,height2601);};var place_images = function(images2602, posns2603, scene2604) {var width2605 = scene2604.width;var height2606 = scene2604.height;return container(M2.cons(scene2604,images2602),M2.cons(make_posn(width2605/2,height2606/2),posns2603),width2605,height2606);};var __align_image_pos = function(image2607, pos2608, x_place2609, y_place2610) {var x2611 = posn_x(pos2608);var y2612 = posn_y(pos2608);var tmp2614 = x_place2609;if (M2.equal_p(tmp2614,$rjs_core.UString.make("left"))!==false) {var if_res1436 = (image2607.width/2)+x2611;} else {if (M2.equal_p(tmp2614,$rjs_core.UString.make("right"))!==false) {var if_res1435 = x2611-(image2607.width/2);} else {if (M2.equal_p(tmp2614,$rjs_core.UString.make("center"))!==false) {var if_res1433 = true;} else {var if_res1433 = M2.equal_p(tmp2614,$rjs_core.UString.make("middle"));}if (if_res1433!==false) {var if_res1434 = x2611;} else {var if_res1434 = M2.rvoid();}var if_res1435 = if_res1434;}var if_res1436 = if_res1435;}var new_x2613 = if_res1436;var tmp2616 = y_place2610;if (M2.equal_p(tmp2616,$rjs_core.UString.make("top"))!==false) {var if_res1440 = (image2607.height/2)+y2612;} else {if (M2.equal_p(tmp2616,$rjs_core.UString.make("bottom"))!==false) {var if_res1439 = y2612-(image2607.height/2);} else {if (M2.equal_p(tmp2616,$rjs_core.UString.make("center"))!==false) {var if_res1437 = true;} else {var if_res1437 = M2.equal_p(tmp2616,$rjs_core.UString.make("middle"));}if (if_res1437!==false) {var if_res1438 = y2612;} else {var if_res1438 = M2.rvoid();}var if_res1439 = if_res1438;}var if_res1440 = if_res1439;}var new_y2615 = if_res1440;return make_posn(new_x2613,new_y2615);};var place_image_by_align = function(image2617, x2618, y2619, x_place2620, y_place2621, scene2622) {var new_pos2623 = __align_image_pos(image2617,make_posn(x2618,y2619),x_place2620,y_place2621);return place_image(image2617,posn_x(new_pos2623),posn_y(new_pos2623),scene2622);};var place_images_by_align = function(images2624, posns2625, x_place2626, y_place2627, scene2628) {var new_posns2629 = M0.map(function(i2630, p2631) {return __align_image_pos(i2630,p2631,x_place2626,y_place2627);},images2624,posns2625);return place_images(images2624,new_posns2629,scene2628);};var __single_overlay = function(x_place2632, y_place2633, ima2634, imb2635) {return new Overlay(x_place2632,y_place2633,ima2634,imb2635);};var __single_underlay = function(x_place2636, y_place2637, ima2638, imb2639) {return new Overlay(x_place2636,y_place2637,imb2639,ima2638);};var overlay_by_align = $rjs_core.attachProcedureArity(function(x_place2640, y_place2641, ima2642, imb2643, ...imn26441441) {var imn2644 = $rjs_core.Pair.listFromArray(imn26441441);return M4.foldl(function(img2645, acc2646) {return __single_overlay(x_place2640,y_place2641,acc2646,img2645);},empty_image,M2.cons(ima2642,M2.cons(imb2643,imn2644)));});var overlay = $rjs_core.attachProcedureArity(function(ima2647, imb2648, ...imn26491442) {var imn2649 = $rjs_core.Pair.listFromArray(imn26491442);return M4.foldl(function(img2650, acc2651) {return __single_overlay($rjs_core.UString.make("middle"),$rjs_core.UString.make("middle"),acc2651,img2650);},empty_image,M2.cons(ima2647,M2.cons(imb2648,imn2649)));});var overlay_by_xy = function(ima2652, x2653, y2654, imb2655) {return new Overlay(x2653,y2654,ima2652,imb2655);};var underlay = $rjs_core.attachProcedureArity(function(ima2656, imb2657, ...imn26581443) {var imn2658 = $rjs_core.Pair.listFromArray(imn26581443);return M4.foldl(function(img2659, acc2660) {return __single_underlay($rjs_core.UString.make("middle"),$rjs_core.UString.make("middle"),acc2660,img2659);},empty_image,M2.cons(ima2656,M2.cons(imb2657,imn2658)));});var underlay_by_align = $rjs_core.attachProcedureArity(function(x_place2661, y_place2662, ima2663, imb2664, ...imn26651444) {var imn2665 = $rjs_core.Pair.listFromArray(imn26651444);return M4.foldl(function(img2666, acc2667) {return __single_underlay(x_place2661,y_place2662,acc2667,img2666);},empty_image,M2.cons(ima2663,M2.cons(imb2664,imn2665)));});var underlay_by_xy = function(ima2668, x2669, y2670, imb2671) {return new Overlay(M2.__(x2669),M2.__(y2670),imb2671,ima2668);};var above_by_align = $rjs_core.attachProcedureArity(function(x_place2672, i12673, i22674, ...is26751445) {var is2675 = $rjs_core.Pair.listFromArray(is26751445);return M4.foldl(function(img2676, acc2677) {return __single_overlay(x_place2672,$rjs_core.UString.make("above"),acc2677,img2676);},empty_image,M2.cons(i12673,M2.cons(i22674,is2675)));});var above = $rjs_core.attachProcedureArity(function(i12678, i22679, ...is26801446) {var is2680 = $rjs_core.Pair.listFromArray(is26801446);return M4.foldl(function(img2681, acc2682) {return __single_overlay($rjs_core.UString.make("middle"),$rjs_core.UString.make("above"),acc2682,img2681);},empty_image,M2.cons(i12678,M2.cons(i22679,is2680)));});var beside_by_align = $rjs_core.attachProcedureArity(function(y_place2683, i12684, i22685, ...is26861447) {var is2686 = $rjs_core.Pair.listFromArray(is26861447);return M4.foldl(function(img2687, acc2688) {return __single_overlay($rjs_core.UString.make("beside"),y_place2683,acc2688,img2687);},empty_image,M2.cons(i12684,M2.cons(i22685,is2686)));});var beside = $rjs_core.attachProcedureArity(function(i12689, i22690, ...is26911448) {var is2691 = $rjs_core.Pair.listFromArray(is26911448);return M4.foldl(function(img2692, acc2693) {return __single_overlay($rjs_core.UString.make("beside"),$rjs_core.UString.make("middle"),acc2693,img2692);},empty_image,M2.cons(i12689,M2.cons(i22690,is2691)));});var rotate = function(angle2694, image2695) {return new Rotate(image2695,M2.__(angle2694));};var scale = function(factor2696, image2697) {return new Scale(image2697,factor2696,factor2696);};var flip_horizontal = function(image2698) {return new Scale(image2698,-1,1);};var flip_vertical = function(image2699) {return new Scale(image2699,1,-1);};var bitmap_by_data = function(data2700) {return new Bitmap(data2700);};var bitmap_by_url = function(url2701) {return new Bitmap(url2701);};var frame = function(img2702) {return color_frame($rjs_core.UString.make("black"),img2702);};var color_frame = function(color2703, img2704) {return overlay(rectangle(image_width(img2704),image_height(img2704),$rjs_core.PrimitiveSymbol.make("outline"),color2703),img2704);};var freeze = function(img2705) {return new Freeze(img2705);};var __rjs_quoted__ = {};__rjs_quoted__.empty_image = empty_image;__rjs_quoted__.posn_p = posn_p;__rjs_quoted__.make_posn = make_posn;__rjs_quoted__.posn_y = posn_y;__rjs_quoted__.posn_x = posn_x;__rjs_quoted__.___gt_web_color = ___gt_web_color;__rjs_quoted__.struct_posn = struct_posn;export { __rjs_quoted__,posn_x,posn_y,posn_p,make_posn,struct_posn,print_image,freeze,bitmap_by_url,bitmap_by_data,flip_horizontal,flip_vertical,scale,rotate,beside,beside_by_align,above,above_by_align,underlay_by_xy,underlay,overlay,overlay_by_xy,overlay_by_align,place_images_by_align,place_image_by_align,place_images,place_image,color_frame,frame,triangle,text_by_font,text,circle,square,rectangle,line,image_width,image_height,empty_scene,empty_image };