import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "./kw.rkt.js";var cl1258 = function(f2252, l2253) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1265 = true;} else {if (M0.procedure_p(f2252)!==false) {if (M0.procedure_arity_includes_p(f2252,1)!==false) {var if_res1263 = M0.list_p(l2253);} else {var if_res1263 = false;}var if_res1264 = if_res1263;} else {var if_res1264 = false;}var if_res1265 = if_res1264;}if (if_res1265!==false) {var loop2254 = function(l2255) {if (M0.null_p(l2255)!==false) {var if_res1266 = M0.rnull;} else {var r2256 = M0.cdr(l2255);var if_res1266 = M0.cons(f2252(M0.car(l2255)),loop2254(r2256));}return if_res1266;};var if_res1267 = loop2254(l2253);} else {var if_res1267 = gen_map(f2252,M0.list(l2253));}return if_res1267;};var cl1259 = function(f2257, l12258, l22259) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1272 = true;} else {if (M0.procedure_p(f2257)!==false) {if (M0.procedure_arity_includes_p(f2257,2)!==false) {if (M0.list_p(l12258)!==false) {if (M0.list_p(l22259)!==false) {var if_res1268 = M0.__eq_(M0.length(l12258),M0.length(l22259));} else {var if_res1268 = false;}var if_res1269 = if_res1268;} else {var if_res1269 = false;}var if_res1270 = if_res1269;} else {var if_res1270 = false;}var if_res1271 = if_res1270;} else {var if_res1271 = false;}var if_res1272 = if_res1271;}if (if_res1272!==false) {var loop2260 = function(l12261, l22262) {if (M0.null_p(l12261)!==false) {var if_res1273 = M0.rnull;} else {var r12263 = M0.cdr(l12261);var r22264 = M0.cdr(l22262);var if_res1273 = M0.cons(f2257(M0.car(l12261),M0.car(l22262)),loop2260(r12263,r22264));}return if_res1273;};var if_res1274 = loop2260(l12258,l22259);} else {var if_res1274 = gen_map(f2257,M0.list(l12258,l22259));}return if_res1274;};var cl1260 = $rjs_core.attachProcedureArity(function(f2265, l2266, ...args22671275) {var args2267 = $rjs_core.Pair.listFromArray(args22671275);return gen_map(f2265,M0.cons(l2266,args2267));});var map2251 = $rjs_core.attachProcedureArity(function() {var fixed_lam1261 = {'2':cl1258,'3':cl1259}[arguments.length];if (fixed_lam1261!==undefined) {return fixed_lam1261.apply(null,arguments);} else {if (M0.__gt__eq_(cl1260.length,1)!==false) {var if_res1262 = cl1260.apply(null,arguments);} else {var if_res1262 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}return if_res1262;}},[M0.make_arity_at_least(2)]);var map2 = map2251;var cl1276 = function(f2269, l2270) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1283 = true;} else {if (M0.procedure_p(f2269)!==false) {if (M0.procedure_arity_includes_p(f2269,1)!==false) {var if_res1281 = M0.list_p(l2270);} else {var if_res1281 = false;}var if_res1282 = if_res1281;} else {var if_res1282 = false;}var if_res1283 = if_res1282;}if (if_res1283!==false) {var loop2271 = function(l2272) {if (M0.null_p(l2272)!==false) {var if_res1284 = M0.rvoid();} else {var r2273 = M0.cdr(l2272);f2269(M0.car(l2272));var if_res1284 = loop2271(r2273);}return if_res1284;};var if_res1285 = loop2271(l2270);} else {var if_res1285 = gen_for_each(f2269,M0.list(l2270));}return if_res1285;};var cl1277 = function(f2274, l12275, l22276) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1290 = true;} else {if (M0.procedure_p(f2274)!==false) {if (M0.procedure_arity_includes_p(f2274,2)!==false) {if (M0.list_p(l12275)!==false) {if (M0.list_p(l22276)!==false) {var if_res1286 = M0.__eq_(M0.length(l12275),M0.length(l22276));} else {var if_res1286 = false;}var if_res1287 = if_res1286;} else {var if_res1287 = false;}var if_res1288 = if_res1287;} else {var if_res1288 = false;}var if_res1289 = if_res1288;} else {var if_res1289 = false;}var if_res1290 = if_res1289;}if (if_res1290!==false) {var loop2277 = function(l12278, l22279) {if (M0.null_p(l12278)!==false) {var if_res1291 = M0.rvoid();} else {var r12280 = M0.cdr(l12278);var r22281 = M0.cdr(l22279);f2274(M0.car(l12278),M0.car(l22279));var if_res1291 = loop2277(r12280,r22281);}return if_res1291;};var if_res1292 = loop2277(l12275,l22276);} else {var if_res1292 = gen_for_each(f2274,M0.list(l12275,l22276));}return if_res1292;};var cl1278 = $rjs_core.attachProcedureArity(function(f2282, l2283, ...args22841293) {var args2284 = $rjs_core.Pair.listFromArray(args22841293);return gen_for_each(f2282,M0.cons(l2283,args2284));});var for_each2268 = $rjs_core.attachProcedureArity(function() {var fixed_lam1279 = {'2':cl1276,'3':cl1277}[arguments.length];if (fixed_lam1279!==undefined) {return fixed_lam1279.apply(null,arguments);} else {if (M0.__gt__eq_(cl1278.length,1)!==false) {var if_res1280 = cl1278.apply(null,arguments);} else {var if_res1280 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}return if_res1280;}},[M0.make_arity_at_least(2)]);var for_each2 = for_each2268;var cl1294 = function(f2286, l2287) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1301 = true;} else {if (M0.procedure_p(f2286)!==false) {if (M0.procedure_arity_includes_p(f2286,1)!==false) {var if_res1299 = M0.list_p(l2287);} else {var if_res1299 = false;}var if_res1300 = if_res1299;} else {var if_res1300 = false;}var if_res1301 = if_res1300;}if (if_res1301!==false) {if (M0.null_p(l2287)!==false) {var if_res1304 = true;} else {var loop2288 = function(l2289) {if (M0.null_p(M0.cdr(l2289))!==false) {var if_res1303 = f2286(M0.car(l2289));} else {var r2290 = M0.cdr(l2289);if (f2286(M0.car(l2289))!==false) {var if_res1302 = loop2288(r2290);} else {var if_res1302 = false;}var if_res1303 = if_res1302;}return if_res1303;};var if_res1304 = loop2288(l2287);}var if_res1305 = if_res1304;} else {var if_res1305 = gen_andmap(f2286,M0.list(l2287));}return if_res1305;};var cl1295 = function(f2291, l12292, l22293) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1310 = true;} else {if (M0.procedure_p(f2291)!==false) {if (M0.procedure_arity_includes_p(f2291,2)!==false) {if (M0.list_p(l12292)!==false) {if (M0.list_p(l22293)!==false) {var if_res1306 = M0.__eq_(M0.length(l12292),M0.length(l22293));} else {var if_res1306 = false;}var if_res1307 = if_res1306;} else {var if_res1307 = false;}var if_res1308 = if_res1307;} else {var if_res1308 = false;}var if_res1309 = if_res1308;} else {var if_res1309 = false;}var if_res1310 = if_res1309;}if (if_res1310!==false) {if (M0.null_p(l12292)!==false) {var if_res1313 = true;} else {var loop2294 = function(l12295, l22296) {if (M0.null_p(M0.cdr(l12295))!==false) {var if_res1312 = f2291(M0.car(l12295),M0.car(l22296));} else {var r12297 = M0.cdr(l12295);var r22298 = M0.cdr(l22296);if (f2291(M0.car(l12295),M0.car(l22296))!==false) {var if_res1311 = loop2294(r12297,r22298);} else {var if_res1311 = false;}var if_res1312 = if_res1311;}return if_res1312;};var if_res1313 = loop2294(l12292,l22293);}var if_res1314 = if_res1313;} else {var if_res1314 = gen_andmap(f2291,M0.list(l12292,l22293));}return if_res1314;};var cl1296 = $rjs_core.attachProcedureArity(function(f2299, l2300, ...args23011315) {var args2301 = $rjs_core.Pair.listFromArray(args23011315);return gen_andmap(f2299,M0.cons(l2300,args2301));});var andmap2285 = $rjs_core.attachProcedureArity(function() {var fixed_lam1297 = {'2':cl1294,'3':cl1295}[arguments.length];if (fixed_lam1297!==undefined) {return fixed_lam1297.apply(null,arguments);} else {if (M0.__gt__eq_(cl1296.length,1)!==false) {var if_res1298 = cl1296.apply(null,arguments);} else {var if_res1298 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}return if_res1298;}},[M0.make_arity_at_least(2)]);var andmap2 = andmap2285;var cl1316 = function(f2303, l2304) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1323 = true;} else {if (M0.procedure_p(f2303)!==false) {if (M0.procedure_arity_includes_p(f2303,1)!==false) {var if_res1321 = M0.list_p(l2304);} else {var if_res1321 = false;}var if_res1322 = if_res1321;} else {var if_res1322 = false;}var if_res1323 = if_res1322;}if (if_res1323!==false) {if (M0.null_p(l2304)!==false) {var if_res1326 = false;} else {var loop2305 = function(l2306) {if (M0.null_p(M0.cdr(l2306))!==false) {var if_res1325 = f2303(M0.car(l2306));} else {var r2307 = M0.cdr(l2306);var or_part2308 = f2303(M0.car(l2306));if (or_part2308!==false) {var if_res1324 = or_part2308;} else {var if_res1324 = loop2305(r2307);}var if_res1325 = if_res1324;}return if_res1325;};var if_res1326 = loop2305(l2304);}var if_res1327 = if_res1326;} else {var if_res1327 = gen_ormap(f2303,M0.list(l2304));}return if_res1327;};var cl1317 = function(f2309, l12310, l22311) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1332 = true;} else {if (M0.procedure_p(f2309)!==false) {if (M0.procedure_arity_includes_p(f2309,2)!==false) {if (M0.list_p(l12310)!==false) {if (M0.list_p(l22311)!==false) {var if_res1328 = M0.__eq_(M0.length(l12310),M0.length(l22311));} else {var if_res1328 = false;}var if_res1329 = if_res1328;} else {var if_res1329 = false;}var if_res1330 = if_res1329;} else {var if_res1330 = false;}var if_res1331 = if_res1330;} else {var if_res1331 = false;}var if_res1332 = if_res1331;}if (if_res1332!==false) {if (M0.null_p(l12310)!==false) {var if_res1335 = false;} else {var loop2312 = function(l12313, l22314) {if (M0.null_p(M0.cdr(l12313))!==false) {var if_res1334 = f2309(M0.car(l12313),M0.car(l22314));} else {var r12315 = M0.cdr(l12313);var r22316 = M0.cdr(l22314);var or_part2317 = f2309(M0.car(l12313),M0.car(l22314));if (or_part2317!==false) {var if_res1333 = or_part2317;} else {var if_res1333 = loop2312(r12315,r22316);}var if_res1334 = if_res1333;}return if_res1334;};var if_res1335 = loop2312(l12310,l22311);}var if_res1336 = if_res1335;} else {var if_res1336 = gen_ormap(f2309,M0.list(l12310,l22311));}return if_res1336;};var cl1318 = $rjs_core.attachProcedureArity(function(f2318, l2319, ...args23201337) {var args2320 = $rjs_core.Pair.listFromArray(args23201337);return gen_ormap(f2318,M0.cons(l2319,args2320));});var ormap2302 = $rjs_core.attachProcedureArity(function() {var fixed_lam1319 = {'2':cl1316,'3':cl1317}[arguments.length];if (fixed_lam1319!==undefined) {return fixed_lam1319.apply(null,arguments);} else {if (M0.__gt__eq_(cl1318.length,1)!==false) {var if_res1320 = cl1318.apply(null,arguments);} else {var if_res1320 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}return if_res1320;}},[M0.make_arity_at_least(2)]);var ormap2 = ormap2302;var check_args = function(who2321, f2322, ls2323) {if (M0.procedure_p(f2322)!==false) {var if_res1338 = M0.rvoid();} else {var if_res1338 = M0.raise_argument_error(who2321,$rjs_core.UString.make("procedure?"),f2322);}if_res1338;var loop2324 = function(prev_len2325, ls2326, i2327) {if (M0.null_p(ls2326)!==false) {var if_res1342 = M0.rvoid();} else {var l2328 = M0.car(ls2326);if (M0.list_p(l2328)!==false) {var if_res1339 = M0.rvoid();} else {var if_res1339 = M0.raise_argument_error(who2321,$rjs_core.UString.make("list?"),l2328);}if_res1339;var len2329 = M0.length(l2328);if (prev_len2325!==false) {var if_res1340 = M0.not(M0.__eq_(len2329,prev_len2325));} else {var if_res1340 = false;}if (if_res1340!==false) {var if_res1341 = M0.raise_arguments_error(who2321,$rjs_core.UString.make("all lists must have same size"),$rjs_core.UString.make("first list length"),prev_len2325,$rjs_core.UString.make("other list length"),len2329,$rjs_core.UString.make("procedure"),f2322);} else {var if_res1341 = M0.rvoid();}if_res1341;var if_res1342 = loop2324(len2329,M0.cdr(ls2326),M0.add1(i2327));}return if_res1342;};loop2324(false,ls2323,1);if (M0.procedure_arity_includes_p(f2322,M0.length(ls2323))!==false) {var if_res1359 = M0.rvoid();} else {var let_result1343 = M1.procedure_keywords(f2322);var required_keywords2330 = let_result1343.getAt(0);var optional_keywords2331 = let_result1343.getAt(1);if (M0.pair_p(required_keywords2330)!==false) {var if_res1358 = M0.string_append($rjs_core.UString.make("argument mismatch;\n"),$rjs_core.UString.make(" the given procedure expects keyword arguments"));} else {var if_res1358 = M0.string_append($rjs_core.UString.make("argument mismatch;\n"),$rjs_core.UString.make(" the given procedure's expected number of arguments does not match"),$rjs_core.UString.make(" the given number of lists"));}var temp1357 = $rjs_core.UString.make("given procedure");var n2333 = M0.object_name(f2322);if (M0.symbol_p(n2333)!==false) {var if_res1354 = M0.symbol__gt_string(n2333);} else {var if_res1354 = false;}var or_part2332 = if_res1354;if (or_part2332!==false) {var if_res1355 = or_part2332;} else {var if_res1355 = $rjs_core.UString.make("#<procedure>");}var temp1356 = M0.unquoted_printing_string(if_res1355);var a2334 = M0.procedure_arity(f2322);if (M0.pair_p(required_keywords2330)!==false) {var if_res1353 = M0.rnull;} else {if (M0.integer_p(a2334)!==false) {var if_res1352 = M0.list($rjs_core.UString.make("expected"),a2334);} else {if (M0.arity_at_least_p(a2334)!==false) {var if_res1351 = M0.list($rjs_core.UString.make("expected"),M0.unquoted_printing_string(M0.string_append($rjs_core.UString.make("at least "),M0.number__gt_string(M0.arity_at_least_value(a2334)))));} else {var if_res1351 = M0.rnull;}var if_res1352 = if_res1351;}var if_res1353 = if_res1352;}if (M0.pair_p(required_keywords2330)!==false) {var if_res1350 = M0.rnull;} else {var if_res1350 = M0.list($rjs_core.UString.make("given"),M0.length(ls2323));}if (M0.pair_p(required_keywords2330)!==false) {var temp1348 = $rjs_core.UString.make("required keywords");var loop2335 = function(kws2336) {if (M0.null_p(kws2336)!==false) {var if_res1347 = M0.rnull;} else {var if_res1347 = M0.list_times_($rjs_core.UString.make(" "),M0.string_append($rjs_core.UString.make("#:"),M0.__rjs_quoted__.keyword__gt_string(M0.car(kws2336))),loop2335(M0.cdr(kws2336)));}return if_res1347;};var if_res1349 = M0.list(temp1348,M0.unquoted_printing_string(M0.apply(M0.string_append,M0.cdr(loop2335(required_keywords2330)))));} else {var if_res1349 = M0.rnull;}var w2337 = M0.quotient(M0.error_print_width(),M0.length(ls2323));if (M0.__gt_(w2337,10)!==false) {var temp1345 = $rjs_core.UString.make("argument lists...");var loop2338 = function(ls2339) {if (M0.null_p(ls2339)!==false) {var if_res1344 = M0.rnull;} else {var if_res1344 = M0.cons(M0.string_append($rjs_core.UString.make("\n   "),M0.error_value__gt_string_handler()(M0.car(ls2339),w2337)),loop2338(M0.cdr(ls2339)));}return if_res1344;};var if_res1346 = M0.list(temp1345,M0.unquoted_printing_string(M0.apply(M0.string_append,loop2338(ls2323))));} else {var if_res1346 = M0.rnull;}var if_res1359 = M0.apply(M0.raise_arguments_error,who2321,if_res1358,temp1357,temp1356,M0.append(if_res1353,if_res1350,if_res1349,if_res1346));}return if_res1359;};var gen_map = function(f2340, ls2341) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1360 = true;} else {var if_res1360 = check_args($rjs_core.PrimitiveSymbol.make("map"),f2340,ls2341);}if_res1360;var loop2342 = function(ls2343) {if (M0.null_p(M0.car(ls2343))!==false) {var if_res1361 = M0.rnull;} else {var next_ls2344 = map2(M0.cdr,ls2343);var if_res1361 = M0.cons(M0.apply(f2340,map2(M0.car,ls2343)),loop2342(next_ls2344));}return if_res1361;};return loop2342(ls2341);};var gen_for_each = function(f2345, ls2346) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1362 = true;} else {var if_res1362 = check_args($rjs_core.PrimitiveSymbol.make("for-each"),f2345,ls2346);}if_res1362;var loop2347 = function(ls2348) {if (M0.null_p(M0.car(ls2348))!==false) {var if_res1363 = M0.rvoid();} else {var next_ls2349 = map2(M0.cdr,ls2348);M0.apply(f2345,map2(M0.car,ls2348));var if_res1363 = loop2347(next_ls2349);}return if_res1363;};return loop2347(ls2346);};var gen_andmap = function(f2350, ls2351) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1364 = true;} else {var if_res1364 = check_args($rjs_core.PrimitiveSymbol.make("andmap"),f2350,ls2351);}if_res1364;var loop2352 = function(ls2353) {if (M0.null_p(M0.car(ls2353))!==false) {var if_res1367 = true;} else {if (M0.null_p(M0.cdar(ls2353))!==false) {var if_res1366 = M0.apply(f2350,map2(M0.car,ls2353));} else {var next_ls2354 = map2(M0.cdr,ls2353);if (M0.apply(f2350,map2(M0.car,ls2353))!==false) {var if_res1365 = loop2352(next_ls2354);} else {var if_res1365 = false;}var if_res1366 = if_res1365;}var if_res1367 = if_res1366;}return if_res1367;};return loop2352(ls2351);};var gen_ormap = function(f2355, ls2356) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1368 = true;} else {var if_res1368 = check_args($rjs_core.PrimitiveSymbol.make("ormap"),f2355,ls2356);}if_res1368;var loop2357 = function(ls2358) {if (M0.null_p(M0.car(ls2358))!==false) {var if_res1371 = false;} else {if (M0.null_p(M0.cdar(ls2358))!==false) {var if_res1370 = M0.apply(f2355,map2(M0.car,ls2358));} else {var next_ls2359 = map2(M0.cdr,ls2358);var or_part2360 = M0.apply(f2355,map2(M0.car,ls2358));if (or_part2360!==false) {var if_res1369 = or_part2360;} else {var if_res1369 = loop2357(next_ls2359);}var if_res1370 = if_res1369;}var if_res1371 = if_res1370;}return if_res1371;};return loop2357(ls2356);};M0.rvoid();var __rjs_quoted__ = {};export { __rjs_quoted__,ormap2 as ormap,andmap2 as andmap,for_each2 as for_each,map2 as map };