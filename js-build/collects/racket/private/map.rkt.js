import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "./kw.rkt.js";var cl953 = function(f1630, l1631) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res960 = true;} else {if (M0.procedure_p(f1630)!==false) {if (M0.procedure_arity_includes_p(f1630,1)!==false) {var if_res958 = M0.list_p(l1631);} else {var if_res958 = false;}var if_res959 = if_res958;} else {var if_res959 = false;}var if_res960 = if_res959;}if (if_res960!==false) {var loop1632 = function(l1633) {if (M0.null_p(l1633)!==false) {var if_res961 = M0.rnull;} else {var r1634 = M0.cdr(l1633);var if_res961 = M0.cons(f1630(M0.car(l1633)),loop1632(r1634));}return if_res961;};var if_res962 = loop1632(l1631);} else {var if_res962 = gen_map(f1630,M0.list(l1631));}return if_res962;};var cl954 = function(f1635, l11636, l21637) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res967 = true;} else {if (M0.procedure_p(f1635)!==false) {if (M0.procedure_arity_includes_p(f1635,2)!==false) {if (M0.list_p(l11636)!==false) {if (M0.list_p(l21637)!==false) {var if_res963 = M0.__eq_(M0.length(l11636),M0.length(l21637));} else {var if_res963 = false;}var if_res964 = if_res963;} else {var if_res964 = false;}var if_res965 = if_res964;} else {var if_res965 = false;}var if_res966 = if_res965;} else {var if_res966 = false;}var if_res967 = if_res966;}if (if_res967!==false) {var loop1638 = function(l11639, l21640) {if (M0.null_p(l11639)!==false) {var if_res968 = M0.rnull;} else {var r11641 = M0.cdr(l11639);var r21642 = M0.cdr(l21640);var if_res968 = M0.cons(f1635(M0.car(l11639),M0.car(l21640)),loop1638(r11641,r21642));}return if_res968;};var if_res969 = loop1638(l11636,l21637);} else {var if_res969 = gen_map(f1635,M0.list(l11636,l21637));}return if_res969;};var cl955 = $rjs_core.attachProcedureArity(function(f1643, l1644, ...args1645970) {var args1645 = $rjs_core.Pair.listFromArray(args1645970);return gen_map(f1643,M0.cons(l1644,args1645));});var map1629 = $rjs_core.attachProcedureArity(function() {var fixed_lam956 = {'2':cl953,'3':cl954}[arguments.length];if (fixed_lam956!==undefined) {return fixed_lam956.apply(null,arguments);} else {if (M0.__gt__eq_(cl955.length,1)!==false) {var if_res957 = cl955.apply(null,arguments);} else {var if_res957 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}return if_res957;}},[M0.make_arity_at_least(2)]);var map2 = map1629;var cl971 = function(f1647, l1648) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res978 = true;} else {if (M0.procedure_p(f1647)!==false) {if (M0.procedure_arity_includes_p(f1647,1)!==false) {var if_res976 = M0.list_p(l1648);} else {var if_res976 = false;}var if_res977 = if_res976;} else {var if_res977 = false;}var if_res978 = if_res977;}if (if_res978!==false) {var loop1649 = function(l1650) {if (M0.null_p(l1650)!==false) {var if_res979 = M0.rvoid();} else {var r1651 = M0.cdr(l1650);f1647(M0.car(l1650));var if_res979 = loop1649(r1651);}return if_res979;};var if_res980 = loop1649(l1648);} else {var if_res980 = gen_for_each(f1647,M0.list(l1648));}return if_res980;};var cl972 = function(f1652, l11653, l21654) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res985 = true;} else {if (M0.procedure_p(f1652)!==false) {if (M0.procedure_arity_includes_p(f1652,2)!==false) {if (M0.list_p(l11653)!==false) {if (M0.list_p(l21654)!==false) {var if_res981 = M0.__eq_(M0.length(l11653),M0.length(l21654));} else {var if_res981 = false;}var if_res982 = if_res981;} else {var if_res982 = false;}var if_res983 = if_res982;} else {var if_res983 = false;}var if_res984 = if_res983;} else {var if_res984 = false;}var if_res985 = if_res984;}if (if_res985!==false) {var loop1655 = function(l11656, l21657) {if (M0.null_p(l11656)!==false) {var if_res986 = M0.rvoid();} else {var r11658 = M0.cdr(l11656);var r21659 = M0.cdr(l21657);f1652(M0.car(l11656),M0.car(l21657));var if_res986 = loop1655(r11658,r21659);}return if_res986;};var if_res987 = loop1655(l11653,l21654);} else {var if_res987 = gen_for_each(f1652,M0.list(l11653,l21654));}return if_res987;};var cl973 = $rjs_core.attachProcedureArity(function(f1660, l1661, ...args1662988) {var args1662 = $rjs_core.Pair.listFromArray(args1662988);return gen_for_each(f1660,M0.cons(l1661,args1662));});var for_each1646 = $rjs_core.attachProcedureArity(function() {var fixed_lam974 = {'2':cl971,'3':cl972}[arguments.length];if (fixed_lam974!==undefined) {return fixed_lam974.apply(null,arguments);} else {if (M0.__gt__eq_(cl973.length,1)!==false) {var if_res975 = cl973.apply(null,arguments);} else {var if_res975 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}return if_res975;}},[M0.make_arity_at_least(2)]);var for_each2 = for_each1646;var cl989 = function(f1664, l1665) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res996 = true;} else {if (M0.procedure_p(f1664)!==false) {if (M0.procedure_arity_includes_p(f1664,1)!==false) {var if_res994 = M0.list_p(l1665);} else {var if_res994 = false;}var if_res995 = if_res994;} else {var if_res995 = false;}var if_res996 = if_res995;}if (if_res996!==false) {if (M0.null_p(l1665)!==false) {var if_res999 = true;} else {var loop1666 = function(l1667) {if (M0.null_p(M0.cdr(l1667))!==false) {var if_res998 = f1664(M0.car(l1667));} else {var r1668 = M0.cdr(l1667);if (f1664(M0.car(l1667))!==false) {var if_res997 = loop1666(r1668);} else {var if_res997 = false;}var if_res998 = if_res997;}return if_res998;};var if_res999 = loop1666(l1665);}var if_res1000 = if_res999;} else {var if_res1000 = gen_andmap(f1664,M0.list(l1665));}return if_res1000;};var cl990 = function(f1669, l11670, l21671) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1005 = true;} else {if (M0.procedure_p(f1669)!==false) {if (M0.procedure_arity_includes_p(f1669,2)!==false) {if (M0.list_p(l11670)!==false) {if (M0.list_p(l21671)!==false) {var if_res1001 = M0.__eq_(M0.length(l11670),M0.length(l21671));} else {var if_res1001 = false;}var if_res1002 = if_res1001;} else {var if_res1002 = false;}var if_res1003 = if_res1002;} else {var if_res1003 = false;}var if_res1004 = if_res1003;} else {var if_res1004 = false;}var if_res1005 = if_res1004;}if (if_res1005!==false) {if (M0.null_p(l11670)!==false) {var if_res1008 = true;} else {var loop1672 = function(l11673, l21674) {if (M0.null_p(M0.cdr(l11673))!==false) {var if_res1007 = f1669(M0.car(l11673),M0.car(l21674));} else {var r11675 = M0.cdr(l11673);var r21676 = M0.cdr(l21674);if (f1669(M0.car(l11673),M0.car(l21674))!==false) {var if_res1006 = loop1672(r11675,r21676);} else {var if_res1006 = false;}var if_res1007 = if_res1006;}return if_res1007;};var if_res1008 = loop1672(l11670,l21671);}var if_res1009 = if_res1008;} else {var if_res1009 = gen_andmap(f1669,M0.list(l11670,l21671));}return if_res1009;};var cl991 = $rjs_core.attachProcedureArity(function(f1677, l1678, ...args16791010) {var args1679 = $rjs_core.Pair.listFromArray(args16791010);return gen_andmap(f1677,M0.cons(l1678,args1679));});var andmap1663 = $rjs_core.attachProcedureArity(function() {var fixed_lam992 = {'2':cl989,'3':cl990}[arguments.length];if (fixed_lam992!==undefined) {return fixed_lam992.apply(null,arguments);} else {if (M0.__gt__eq_(cl991.length,1)!==false) {var if_res993 = cl991.apply(null,arguments);} else {var if_res993 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}return if_res993;}},[M0.make_arity_at_least(2)]);var andmap2 = andmap1663;var cl1011 = function(f1681, l1682) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1018 = true;} else {if (M0.procedure_p(f1681)!==false) {if (M0.procedure_arity_includes_p(f1681,1)!==false) {var if_res1016 = M0.list_p(l1682);} else {var if_res1016 = false;}var if_res1017 = if_res1016;} else {var if_res1017 = false;}var if_res1018 = if_res1017;}if (if_res1018!==false) {if (M0.null_p(l1682)!==false) {var if_res1021 = false;} else {var loop1683 = function(l1684) {if (M0.null_p(M0.cdr(l1684))!==false) {var if_res1020 = f1681(M0.car(l1684));} else {var r1685 = M0.cdr(l1684);var or_part1686 = f1681(M0.car(l1684));if (or_part1686!==false) {var if_res1019 = or_part1686;} else {var if_res1019 = loop1683(r1685);}var if_res1020 = if_res1019;}return if_res1020;};var if_res1021 = loop1683(l1682);}var if_res1022 = if_res1021;} else {var if_res1022 = gen_ormap(f1681,M0.list(l1682));}return if_res1022;};var cl1012 = function(f1687, l11688, l21689) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1027 = true;} else {if (M0.procedure_p(f1687)!==false) {if (M0.procedure_arity_includes_p(f1687,2)!==false) {if (M0.list_p(l11688)!==false) {if (M0.list_p(l21689)!==false) {var if_res1023 = M0.__eq_(M0.length(l11688),M0.length(l21689));} else {var if_res1023 = false;}var if_res1024 = if_res1023;} else {var if_res1024 = false;}var if_res1025 = if_res1024;} else {var if_res1025 = false;}var if_res1026 = if_res1025;} else {var if_res1026 = false;}var if_res1027 = if_res1026;}if (if_res1027!==false) {if (M0.null_p(l11688)!==false) {var if_res1030 = false;} else {var loop1690 = function(l11691, l21692) {if (M0.null_p(M0.cdr(l11691))!==false) {var if_res1029 = f1687(M0.car(l11691),M0.car(l21692));} else {var r11693 = M0.cdr(l11691);var r21694 = M0.cdr(l21692);var or_part1695 = f1687(M0.car(l11691),M0.car(l21692));if (or_part1695!==false) {var if_res1028 = or_part1695;} else {var if_res1028 = loop1690(r11693,r21694);}var if_res1029 = if_res1028;}return if_res1029;};var if_res1030 = loop1690(l11688,l21689);}var if_res1031 = if_res1030;} else {var if_res1031 = gen_ormap(f1687,M0.list(l11688,l21689));}return if_res1031;};var cl1013 = $rjs_core.attachProcedureArity(function(f1696, l1697, ...args16981032) {var args1698 = $rjs_core.Pair.listFromArray(args16981032);return gen_ormap(f1696,M0.cons(l1697,args1698));});var ormap1680 = $rjs_core.attachProcedureArity(function() {var fixed_lam1014 = {'2':cl1011,'3':cl1012}[arguments.length];if (fixed_lam1014!==undefined) {return fixed_lam1014.apply(null,arguments);} else {if (M0.__gt__eq_(cl1013.length,1)!==false) {var if_res1015 = cl1013.apply(null,arguments);} else {var if_res1015 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}return if_res1015;}},[M0.make_arity_at_least(2)]);var ormap2 = ormap1680;var check_args = function(who1699, f1700, ls1701) {if (M0.procedure_p(f1700)!==false) {var if_res1033 = M0.rvoid();} else {var if_res1033 = M0.raise_argument_error(who1699,$rjs_core.UString.make("procedure?"),f1700);}if_res1033;var loop1702 = function(prev_len1703, ls1704, i1705) {if (M0.null_p(ls1704)!==false) {var if_res1037 = M0.rvoid();} else {var l1706 = M0.car(ls1704);if (M0.list_p(l1706)!==false) {var if_res1034 = M0.rvoid();} else {var if_res1034 = M0.raise_argument_error(who1699,$rjs_core.UString.make("list?"),l1706);}if_res1034;var len1707 = M0.length(l1706);if (prev_len1703!==false) {var if_res1035 = M0.not(M0.__eq_(len1707,prev_len1703));} else {var if_res1035 = false;}if (if_res1035!==false) {var if_res1036 = M0.raise_arguments_error(who1699,$rjs_core.UString.make("all lists must have same size"),$rjs_core.UString.make("first list length"),prev_len1703,$rjs_core.UString.make("other list length"),len1707,$rjs_core.UString.make("procedure"),f1700);} else {var if_res1036 = M0.rvoid();}if_res1036;var if_res1037 = loop1702(len1707,M0.cdr(ls1704),M0.add1(i1705));}return if_res1037;};loop1702(false,ls1701,1);if (M0.procedure_arity_includes_p(f1700,M0.length(ls1701))!==false) {var if_res1054 = M0.rvoid();} else {var let_result1038 = M1.procedure_keywords(f1700);var required_keywords1708 = let_result1038.getAt(0);var optional_keywords1709 = let_result1038.getAt(1);if (M0.pair_p(required_keywords1708)!==false) {var if_res1053 = M0.string_append($rjs_core.UString.make("argument mismatch;\n"),$rjs_core.UString.make(" the given procedure expects keyword arguments"));} else {var if_res1053 = M0.string_append($rjs_core.UString.make("argument mismatch;\n"),$rjs_core.UString.make(" the given procedure's expected number of arguments does not match"),$rjs_core.UString.make(" the given number of lists"));}var temp1052 = $rjs_core.UString.make("given procedure");var n1711 = M0.object_name(f1700);if (M0.symbol_p(n1711)!==false) {var if_res1049 = M0.symbol__gt_string(n1711);} else {var if_res1049 = false;}var or_part1710 = if_res1049;if (or_part1710!==false) {var if_res1050 = or_part1710;} else {var if_res1050 = $rjs_core.UString.make("#<procedure>");}var temp1051 = M0.unquoted_printing_string(if_res1050);var a1712 = M0.procedure_arity(f1700);if (M0.pair_p(required_keywords1708)!==false) {var if_res1048 = M0.rnull;} else {if (M0.integer_p(a1712)!==false) {var if_res1047 = M0.list($rjs_core.UString.make("expected"),a1712);} else {if (M0.arity_at_least_p(a1712)!==false) {var if_res1046 = M0.list($rjs_core.UString.make("expected"),M0.unquoted_printing_string(M0.string_append($rjs_core.UString.make("at least "),M0.number__gt_string(M0.arity_at_least_value(a1712)))));} else {var if_res1046 = M0.rnull;}var if_res1047 = if_res1046;}var if_res1048 = if_res1047;}if (M0.pair_p(required_keywords1708)!==false) {var if_res1045 = M0.rnull;} else {var if_res1045 = M0.list($rjs_core.UString.make("given"),M0.length(ls1701));}if (M0.pair_p(required_keywords1708)!==false) {var temp1043 = $rjs_core.UString.make("required keywords");var loop1713 = function(kws1714) {if (M0.null_p(kws1714)!==false) {var if_res1042 = M0.rnull;} else {var if_res1042 = M0.list_times_($rjs_core.UString.make(" "),M0.string_append($rjs_core.UString.make("#:"),M0.__rjs_quoted__.keyword__gt_string(M0.car(kws1714))),loop1713(M0.cdr(kws1714)));}return if_res1042;};var if_res1044 = M0.list(temp1043,M0.unquoted_printing_string(M0.apply(M0.string_append,M0.cdr(loop1713(required_keywords1708)))));} else {var if_res1044 = M0.rnull;}var w1715 = M0.quotient(M0.error_print_width(),M0.length(ls1701));if (M0.__gt_(w1715,10)!==false) {var temp1040 = $rjs_core.UString.make("argument lists...");var loop1716 = function(ls1717) {if (M0.null_p(ls1717)!==false) {var if_res1039 = M0.rnull;} else {var if_res1039 = M0.cons(M0.string_append($rjs_core.UString.make("\n   "),M0.error_value__gt_string_handler()(M0.car(ls1717),w1715)),loop1716(M0.cdr(ls1717)));}return if_res1039;};var if_res1041 = M0.list(temp1040,M0.unquoted_printing_string(M0.apply(M0.string_append,loop1716(ls1701))));} else {var if_res1041 = M0.rnull;}var if_res1054 = M0.apply(M0.raise_arguments_error,who1699,if_res1053,temp1052,temp1051,M0.append(if_res1048,if_res1045,if_res1044,if_res1041));}return if_res1054;};var gen_map = function(f1718, ls1719) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1055 = true;} else {var if_res1055 = check_args($rjs_core.PrimitiveSymbol.make("map"),f1718,ls1719);}if_res1055;var loop1720 = function(ls1721) {if (M0.null_p(M0.car(ls1721))!==false) {var if_res1056 = M0.rnull;} else {var next_ls1722 = map2(M0.cdr,ls1721);var if_res1056 = M0.cons(M0.apply(f1718,map2(M0.car,ls1721)),loop1720(next_ls1722));}return if_res1056;};return loop1720(ls1719);};var gen_for_each = function(f1723, ls1724) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1057 = true;} else {var if_res1057 = check_args($rjs_core.PrimitiveSymbol.make("for-each"),f1723,ls1724);}if_res1057;var loop1725 = function(ls1726) {if (M0.null_p(M0.car(ls1726))!==false) {var if_res1058 = M0.rvoid();} else {var next_ls1727 = map2(M0.cdr,ls1726);M0.apply(f1723,map2(M0.car,ls1726));var if_res1058 = loop1725(next_ls1727);}return if_res1058;};return loop1725(ls1724);};var gen_andmap = function(f1728, ls1729) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1059 = true;} else {var if_res1059 = check_args($rjs_core.PrimitiveSymbol.make("andmap"),f1728,ls1729);}if_res1059;var loop1730 = function(ls1731) {if (M0.null_p(M0.car(ls1731))!==false) {var if_res1062 = true;} else {if (M0.null_p(M0.cdar(ls1731))!==false) {var if_res1061 = M0.apply(f1728,map2(M0.car,ls1731));} else {var next_ls1732 = map2(M0.cdr,ls1731);if (M0.apply(f1728,map2(M0.car,ls1731))!==false) {var if_res1060 = loop1730(next_ls1732);} else {var if_res1060 = false;}var if_res1061 = if_res1060;}var if_res1062 = if_res1061;}return if_res1062;};return loop1730(ls1729);};var gen_ormap = function(f1733, ls1734) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1063 = true;} else {var if_res1063 = check_args($rjs_core.PrimitiveSymbol.make("ormap"),f1733,ls1734);}if_res1063;var loop1735 = function(ls1736) {if (M0.null_p(M0.car(ls1736))!==false) {var if_res1066 = false;} else {if (M0.null_p(M0.cdar(ls1736))!==false) {var if_res1065 = M0.apply(f1733,map2(M0.car,ls1736));} else {var next_ls1737 = map2(M0.cdr,ls1736);var or_part1738 = M0.apply(f1733,map2(M0.car,ls1736));if (or_part1738!==false) {var if_res1064 = or_part1738;} else {var if_res1064 = loop1735(next_ls1737);}var if_res1065 = if_res1064;}var if_res1066 = if_res1065;}return if_res1066;};return loop1735(ls1734);};M0.rvoid();var __rjs_quoted__ = {};export { __rjs_quoted__,ormap2 as ormap,andmap2 as andmap,for_each2 as for_each,map2 as map };