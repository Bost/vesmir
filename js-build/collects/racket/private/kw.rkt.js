import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/unsafe.rkt.js";var let_result1067 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("keyword-impersonator"));var prop_keyword_impersonator = let_result1067.getAt(0);var keyword_impersonator_p = let_result1067.getAt(1);var keyword_impersonator_ref = let_result1067.getAt(2);var keyword_procedure_impersonator_of = function(v1739) {if (keyword_impersonator_p(v1739)!==false) {var if_res1068 = keyword_impersonator_ref(v1739)(v1739);} else {var if_res1068 = false;}return if_res1068;};var let_result1069 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("keyword-procedure"),false,4,0,false,M0.list(M0.cons(M0.prop_checked_procedure,true),M0.cons(M0.prop_impersonator_of,keyword_procedure_impersonator_of)),M0.current_inspector(),false,$rjs_core.Pair.makeList(0,1,2,3));var struct_keyword_procedure = let_result1069.getAt(0);var mk_kw_proc = let_result1069.getAt(1);var keyword_procedure_p = let_result1069.getAt(2);var keyword_procedure_ref = let_result1069.getAt(3);var keyword_procedure_set_bang_ = let_result1069.getAt(4);var keyword_procedure_checker = M0.make_struct_field_accessor(keyword_procedure_ref,0);var keyword_procedure_proc = M0.make_struct_field_accessor(keyword_procedure_ref,1);var keyword_procedure_required = M0.make_struct_field_accessor(keyword_procedure_ref,2);var keyword_procedure_allowed = M0.make_struct_field_accessor(keyword_procedure_ref,3);var let_result1070 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_keyword_method = let_result1070.getAt(0);var make_km = let_result1070.getAt(1);var keyword_method_p = let_result1070.getAt(2);var km_ref = let_result1070.getAt(3);var km_set_bang_ = let_result1070.getAt(4);var generate_arity_string = function(proc1740) {var let_result1071 = procedure_keywords(proc1740);var req1741 = let_result1071.getAt(0);var allowed1742 = let_result1071.getAt(1);var a1743 = M0.procedure_arity(proc1740);var keywords_desc1744 = function(opt1746, req1747) {var temp1077 = $rjs_core.UString.make("~a with keyword~a~a");if (M0.null_p(M0.cdr(req1747))!==false) {var if_res1076 = M0.format($rjs_core.UString.make("an ~aargument"),opt1746);} else {var if_res1076 = M0.format($rjs_core.UString.make("~aarguments"),opt1746);}if (M0.null_p(M0.cdr(req1747))!==false) {var if_res1075 = $rjs_core.UString.make("");} else {var if_res1075 = $rjs_core.UString.make("s");}var tmp1748 = M0.length(req1747);if (M0.equal_p(tmp1748,1)!==false) {var if_res1074 = M0.format($rjs_core.UString.make(" ~a"),M0.car(req1747));} else {if (M0.equal_p(tmp1748,2)!==false) {var if_res1073 = M0.format($rjs_core.UString.make(" ~a and ~a"),M0.car(req1747),M0.cadr(req1747));} else {var loop1749 = function(req1750) {if (M0.null_p(M0.cdr(req1750))!==false) {var if_res1072 = M0.format($rjs_core.UString.make(" and ~a"),M0.car(req1750));} else {var if_res1072 = M0.format($rjs_core.UString.make(" ~a,~a"),M0.car(req1750),loop1749(M0.cdr(req1750)));}return if_res1072;};var if_res1073 = loop1749(req1747);}var if_res1074 = if_res1073;}return M0.format(temp1077,if_res1076,if_res1075,if_res1074);};var method_adjust1745 = function(a1751) {var or_part1752 = okm_p(proc1740);if (or_part1752!==false) {var if_res1078 = or_part1752;} else {var if_res1078 = keyword_method_p(proc1740);}if (if_res1078!==false) {if (M0.zero_p(a1751)!==false) {var if_res1079 = 0;} else {var if_res1079 = M0.sub1(a1751);}var if_res1080 = if_res1079;} else {var if_res1080 = a1751;}return if_res1080;};if (M0.number_p(a1743)!==false) {var a1753 = method_adjust1745(a1743);var if_res1087 = M0.format($rjs_core.UString.make("~a"),a1753);} else {if (M0.arity_at_least_p(a1743)!==false) {var a1754 = method_adjust1745(M0.arity_at_least_value(a1743));var if_res1086 = M0.format($rjs_core.UString.make("at least ~a"),a1754);} else {var if_res1086 = $rjs_core.UString.make("a different number");}var if_res1087 = if_res1086;}if (M0.null_p(req1741)!==false) {var if_res1085 = $rjs_core.UString.make("");} else {var if_res1085 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc1744($rjs_core.UString.make(""),req1741));}if (allowed1742!==false) {var loop1756 = function(req1757, allowed1758) {if (M0.null_p(req1757)!==false) {var if_res1082 = allowed1758;} else {if (M0.eq_p(M0.car(req1757),M0.car(allowed1758))!==false) {var if_res1081 = loop1756(M0.cdr(req1757),M0.cdr(allowed1758));} else {var if_res1081 = M0.cons(M0.car(allowed1758),loop1756(req1757,M0.cdr(allowed1758)));}var if_res1082 = if_res1081;}return if_res1082;};var others1755 = loop1756(req1741,allowed1742);if (M0.null_p(others1755)!==false) {var if_res1083 = $rjs_core.UString.make("");} else {var if_res1083 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc1744($rjs_core.UString.make("optional "),others1755));}var if_res1084 = if_res1083;} else {var if_res1084 = $rjs_core.UString.make(" plus arbitrary keyword arguments");}return M0.string_append(if_res1087,if_res1085,if_res1084);};var let_result1088 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string)),M0.current_inspector(),0);var struct_okp = let_result1088.getAt(0);var make_optional_keyword_procedure = let_result1088.getAt(1);var okp_p = let_result1088.getAt(2);var okp_ref = let_result1088.getAt(3);var okp_set_bang_ = let_result1088.getAt(4);var let_result1089 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_okm = let_result1089.getAt(0);var make_optional_keyword_method = let_result1089.getAt(1);var okm_p = let_result1089.getAt(2);var okm_ref = let_result1089.getAt(3);var okm_set_bang_ = let_result1089.getAt(4);var let_result1090 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("named-keyword-procedure"));var prop_named_keyword_procedure = let_result1090.getAt(0);var named_keyword_procedure_p = let_result1090.getAt(1);var keyword_procedure_name_plus_fail = let_result1090.getAt(2);var let_result1092 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),function(v1759, info_l1760) {if (M0.exact_integer_p(v1759)!==false) {var if_res1091 = M0.make_struct_field_accessor(M0.list_ref(info_l1760,3),v1759);} else {var if_res1091 = false;}return if_res1091;});var prop_procedure_accessor = let_result1092.getAt(0);var procedure_accessor_p = let_result1092.getAt(1);var procedure_accessor_ref = let_result1092.getAt(2);var let_result1093 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),false,M0.list(M0.cons(M0.prop_procedure,M0.values),M0.cons(prop_procedure_accessor,M0.values)),true);var new_prop_procedure = let_result1093.getAt(0);var new_procedure_p = let_result1093.getAt(1);var new_procedure_ref = let_result1093.getAt(2);var let_result1094 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v1761) {return kpp_ref(v1761,0);})));var struct_keyword_procedure_impersonator = let_result1094.getAt(0);var make_kpp = let_result1094.getAt(1);var keyword_procedure_impersonator_p = let_result1094.getAt(2);var kpp_ref = let_result1094.getAt(3);var kpp_set_bang_ = let_result1094.getAt(4);var let_result1095 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v1762) {return kmp_ref(v1762,0);})));var struct_keyword_method_impersonator = let_result1095.getAt(0);var make_kmp = let_result1095.getAt(1);var keyword_method_impersonator_p = let_result1095.getAt(2);var kmp_ref = let_result1095.getAt(3);var kmp_set_bang_ = let_result1095.getAt(4);var let_result1096 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v1763) {return okpp_ref(v1763,0);})));var struct_okpp = let_result1096.getAt(0);var make_optional_keyword_procedure_impersonator = let_result1096.getAt(1);var okpp_p = let_result1096.getAt(2);var okpp_ref = let_result1096.getAt(3);var okpp_set_bang_ = let_result1096.getAt(4);var let_result1097 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v1764) {return okmp_ref(v1764,0);})));var struct_okmp = let_result1097.getAt(0);var make_optional_keyword_method_impersonator = let_result1097.getAt(1);var okmp_p = let_result1097.getAt(2);var okmp_ref = let_result1097.getAt(3);var okmp_set_bang_ = let_result1097.getAt(4);var let_result1098 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_by_arity_error = let_result1098.getAt(0);var make_kp_by_ae = let_result1098.getAt(1);var kp_by_ae_p = let_result1098.getAt(2);var kp_by_ae_ref = let_result1098.getAt(3);var kp_by_ae_set_bang_ = let_result1098.getAt(4);var let_result1099 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_by_arity_error = let_result1099.getAt(0);var make_km_by_ae = let_result1099.getAt(1);var km_by_ae_p = let_result1099.getAt(2);var km_by_ae_ref = let_result1099.getAt(3);var km_by_ae_set_bang_ = let_result1099.getAt(4);var let_result1100 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_impersonator_by_arity_error = let_result1100.getAt(0);var make_kpi_by_ae = let_result1100.getAt(1);var kpi_by_ae_p = let_result1100.getAt(2);var kpi_by_ae_ref = let_result1100.getAt(3);var kpi_by_ae_set_bang_ = let_result1100.getAt(4);var let_result1101 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_impersonator_by_arity_error = let_result1101.getAt(0);var make_kmi_by_ae = let_result1101.getAt(1);var kmi_by_ae_p = let_result1101.getAt(2);var kmi_by_ae_ref = let_result1101.getAt(3);var kmi_by_ae_set_bang_ = let_result1101.getAt(4);var make_required = function(name1765, fail_proc1766, method_p1767, impersonator_p1768) {var or_part1774 = name1765;if (or_part1774!==false) {var if_res1105 = or_part1774;} else {var if_res1105 = $rjs_core.PrimitiveSymbol.make("unknown");}if (impersonator_p1768!==false) {if (method_p1767!==false) {var if_res1102 = struct_keyword_method_impersonator_by_arity_error;} else {var if_res1102 = struct_keyword_procedure_impersonator_by_arity_error;}var if_res1104 = if_res1102;} else {if (method_p1767!==false) {var if_res1103 = struct_keyword_method_by_arity_error;} else {var if_res1103 = struct_keyword_procedure_by_arity_error;}var if_res1104 = if_res1103;}var let_result1106 = M0.make_struct_type(if_res1105,if_res1104,0,0,false,M0.list(M0.cons(prop_named_keyword_procedure,M0.cons(name1765,fail_proc1766))),M0.current_inspector(),fail_proc1766);var s_1769 = let_result1106.getAt(0);var mk1770 = let_result1106.getAt(1);var __p1771 = let_result1106.getAt(2);var __ref1772 = let_result1106.getAt(3);var __set_bang_1773 = let_result1106.getAt(4);return mk1770;};var cl1107 = function(proc1775) {var proc_name1776 = M0.object_name(proc1775);var plain_proc1777 = $rjs_core.attachProcedureArity(function(...args17781110) {var args1778 = $rjs_core.Pair.listFromArray(args17781110);return M0.apply(proc1775,M0.rnull,M0.rnull,args1778);});if (M0.symbol_p(proc_name1776)!==false) {var if_res1111 = M0.__rjs_quoted__.procedure_rename(plain_proc1777,proc_name1776);} else {var if_res1111 = plain_proc1777;}return make_keyword_procedure(proc1775,if_res1111);};var cl1108 = function(proc1779, plain_proc1780) {if (M0.procedure_p(proc1779)!==false) {var if_res1112 = M0.procedure_arity_mask(proc1779);} else {var if_res1112 = false;}return make_optional_keyword_procedure(make_keyword_checker(M0.rnull,false,if_res1112),proc1779,M0.rnull,false,plain_proc1780);};var make_keyword_procedure = $rjs_core.attachProcedureArity(function() {var fixed_lam1109 = {'1':cl1107,'2':cl1108}[arguments.length];if (fixed_lam1109!==undefined) {return fixed_lam1109.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var keyword_apply = $rjs_core.attachProcedureArity(function(proc1781, kws1782, kw_vals1783, normal_args1784, ...normal_argss17851113) {var normal_argss1785 = $rjs_core.Pair.listFromArray(normal_argss17851113);var type_error1786 = function(what1787, which1788) {return M0.apply(M0.raise_argument_error,$rjs_core.PrimitiveSymbol.make("keyword-apply"),what1787,which1788,proc1781,kws1782,kw_vals1783,normal_args1784,normal_argss1785);};if (M0.procedure_p(proc1781)!==false) {var if_res1114 = M0.rvoid();} else {var if_res1114 = type_error1786($rjs_core.UString.make("procedure?"),0);}if_res1114;var loop1789 = function(ks1790) {if (M0.null_p(ks1790)!==false) {var if_res1121 = M0.rvoid();} else {var or_part1791 = M0.not(M0.pair_p(ks1790));if (or_part1791!==false) {var if_res1115 = or_part1791;} else {var if_res1115 = M0.not(M0.keyword_p(M0.car(ks1790)));}if (if_res1115!==false) {var if_res1120 = type_error1786($rjs_core.UString.make("(listof keyword?)"),1);} else {if (M0.null_p(M0.cdr(ks1790))!==false) {var if_res1119 = M0.rvoid();} else {var or_part1792 = M0.not(M0.pair_p(M0.cdr(ks1790)));if (or_part1792!==false) {var if_res1116 = or_part1792;} else {var if_res1116 = M0.not(M0.keyword_p(M0.cadr(ks1790)));}if (if_res1116!==false) {var if_res1118 = loop1789(M0.cdr(ks1790));} else {if (M0.keyword_lt__p(M0.car(ks1790),M0.cadr(ks1790))!==false) {var if_res1117 = loop1789(M0.cdr(ks1790));} else {var if_res1117 = type_error1786($rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)"),1);}var if_res1118 = if_res1117;}var if_res1119 = if_res1118;}var if_res1120 = if_res1119;}var if_res1121 = if_res1120;}return if_res1121;};loop1789(kws1782);if (M0.list_p(kw_vals1783)!==false) {var if_res1122 = M0.rvoid();} else {var if_res1122 = type_error1786($rjs_core.UString.make("list?"),2);}if_res1122;if (M0.__eq_(M0.length(kws1782),M0.length(kw_vals1783))!==false) {var if_res1123 = M0.rvoid();} else {var if_res1123 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword-apply"),$rjs_core.UString.make("keyword list length does not match value list length"),$rjs_core.UString.make("keyword list length"),M0.length(kws1782),$rjs_core.UString.make("value list length"),M0.length(kw_vals1783),$rjs_core.UString.make("keyword list"),kws1782,$rjs_core.UString.make("value list"),kw_vals1783);}if_res1123;var loop1794 = function(normal_argss1795, pos1796) {if (M0.null_p(M0.cdr(normal_argss1795))!==false) {var l1797 = M0.car(normal_argss1795);if (M0.list_p(l1797)!==false) {var if_res1124 = l1797;} else {var if_res1124 = type_error1786($rjs_core.UString.make("list?"),pos1796);}var if_res1125 = if_res1124;} else {var if_res1125 = M0.cons(M0.car(normal_argss1795),loop1794(M0.cdr(normal_argss1795),M0.add1(pos1796)));}return if_res1125;};var normal_args1793 = loop1794(M0.cons(normal_args1784,normal_argss1785),3);if (M0.null_p(kws1782)!==false) {var if_res1126 = M0.apply(proc1781,normal_args1793);} else {var if_res1126 = M0.apply(keyword_procedure_extract_by_method(kws1782,2+M0.length(normal_args1793),proc1781,0),kws1782,kw_vals1783,normal_args1793);}return if_res1126;});var procedure_keywords = function(p1798) {if (keyword_procedure_p(p1798)!==false) {var if_res1131 = M0.values(keyword_procedure_required(p1798),keyword_procedure_allowed(p1798));} else {if (M0.procedure_p(p1798)!==false) {if (new_procedure_p(p1798)!==false) {var v1799 = new_procedure_ref(p1798);if (M0.procedure_p(v1799)!==false) {var if_res1128 = procedure_keywords(v1799);} else {var a1800 = procedure_accessor_ref(p1798);if (a1800!==false) {var if_res1127 = procedure_keywords(a1800(p1798));} else {var if_res1127 = M0.values(M0.rnull,M0.rnull);}var if_res1128 = if_res1127;}var if_res1129 = if_res1128;} else {var if_res1129 = M0.values(M0.rnull,M0.rnull);}var if_res1130 = if_res1129;} else {var if_res1130 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("procedure-keywords"),$rjs_core.UString.make("procedure?"),p1798);}var if_res1131 = if_res1130;}return if_res1131;};var missing_kw = $rjs_core.attachProcedureArity(function(proc1801, ...args18021132) {var args1802 = $rjs_core.Pair.listFromArray(args18021132);return M0.apply(keyword_procedure_extract_by_method(M0.rnull,0,proc1801,0),M0.rnull,M0.rnull,args1802);});var check_kw_args = function(p1803, kws1804) {var loop1805 = function(kws1806, required1807, allowed1808) {if (M0.null_p(kws1806)!==false) {if (M0.null_p(required1807)!==false) {var if_res1133 = M0.values(false,false);} else {var if_res1133 = M0.values(M0.car(required1807),false);}var if_res1142 = if_res1133;} else {if (M0.pair_p(required1807)!==false) {var if_res1134 = M0.eq_p(M0.car(required1807),M0.car(kws1806));} else {var if_res1134 = false;}if (if_res1134!==false) {var temp1137 = M0.cdr(kws1806);var temp1136 = M0.cdr(required1807);if (allowed1808!==false) {var if_res1135 = M0.cdr(allowed1808);} else {var if_res1135 = false;}var if_res1141 = loop1805(temp1137,temp1136,if_res1135);} else {if (M0.not(allowed1808)!==false) {var if_res1140 = loop1805(M0.cdr(kws1806),required1807,false);} else {if (M0.pair_p(allowed1808)!==false) {if (M0.eq_p(M0.car(allowed1808),M0.car(kws1806))!==false) {var if_res1138 = loop1805(M0.cdr(kws1806),required1807,M0.cdr(allowed1808));} else {var if_res1138 = loop1805(kws1806,required1807,M0.cdr(allowed1808));}var if_res1139 = if_res1138;} else {var if_res1139 = M0.values(false,M0.car(kws1806));}var if_res1140 = if_res1139;}var if_res1141 = if_res1140;}var if_res1142 = if_res1141;}return if_res1142;};return loop1805(kws1804,keyword_procedure_required(p1803),keyword_procedure_allowed(p1803));};var make_keyword_checker = function(req_kws1809, allowed_kws1810, arity_mask1811) {if (M0.not(allowed_kws1810)!==false) {if (M0.null_p(req_kws1809)!==false) {var if_res1145 = function(kws1812, a1813) {if (true!==false) {var if_res1143 = M0.bitwise_bit_set_p(arity_mask1811,a1813);} else {var if_res1143 = false;}return if_res1143;};} else {var if_res1145 = function(kws1814, a1815) {if (subset_p(req_kws1809,kws1814)!==false) {var if_res1144 = M0.bitwise_bit_set_p(arity_mask1811,a1815);} else {var if_res1144 = false;}return if_res1144;};}var if_res1158 = if_res1145;} else {if (M0.null_p(allowed_kws1810)!==false) {var if_res1157 = function(kws1816, a1817) {if (M0.null_p(kws1816)!==false) {var if_res1146 = M0.bitwise_bit_set_p(arity_mask1811,a1817);} else {var if_res1146 = false;}return if_res1146;};} else {if (M0.null_p(req_kws1809)!==false) {var if_res1156 = function(kws1818, a1819) {if (subset_p(kws1818,allowed_kws1810)!==false) {var if_res1147 = M0.bitwise_bit_set_p(arity_mask1811,a1819);} else {var if_res1147 = false;}return if_res1147;};} else {if (M0.list_p(req_kws1809)!==false) {if (M0.list_p(allowed_kws1810)!==false) {var if_res1148 = M0.eq_p(M0.length(req_kws1809),M0.length(allowed_kws1810));} else {var if_res1148 = false;}var if_res1149 = if_res1148;} else {var if_res1149 = false;}if (if_res1149!==false) {var if_res1155 = function(kws1820, a1821) {var loop1822 = function(kws1823, req_kws1824) {if (M0.null_p(req_kws1824)!==false) {var if_res1152 = M0.null_p(kws1823);} else {if (M0.null_p(kws1823)!==false) {var if_res1151 = false;} else {if (M0.eq_p(M0.car(kws1823),M0.car(req_kws1824))!==false) {var if_res1150 = loop1822(M0.cdr(kws1823),M0.cdr(req_kws1824));} else {var if_res1150 = false;}var if_res1151 = if_res1150;}var if_res1152 = if_res1151;}return if_res1152;};if (loop1822(kws1820,req_kws1809)!==false) {var if_res1153 = M0.bitwise_bit_set_p(arity_mask1811,a1821);} else {var if_res1153 = false;}return if_res1153;};} else {var if_res1155 = function(kws1825, a1826) {if (subsets_p(req_kws1809,kws1825,allowed_kws1810)!==false) {var if_res1154 = M0.bitwise_bit_set_p(arity_mask1811,a1826);} else {var if_res1154 = false;}return if_res1154;};}var if_res1156 = if_res1155;}var if_res1157 = if_res1156;}var if_res1158 = if_res1157;}return if_res1158;};var subset_p = function(l11827, l21828) {if (M0.null_p(l11827)!==false) {var if_res1161 = true;} else {if (M0.null_p(l21828)!==false) {var if_res1160 = false;} else {if (M0.eq_p(M0.car(l11827),M0.car(l21828))!==false) {var if_res1159 = subset_p(M0.cdr(l11827),M0.cdr(l21828));} else {var if_res1159 = subset_p(l11827,M0.cdr(l21828));}var if_res1160 = if_res1159;}var if_res1161 = if_res1160;}return if_res1161;};var subsets_p = function(l11829, l21830, l31831) {if (M0.null_p(l11829)!==false) {var if_res1166 = subset_p(l21830,l31831);} else {if (M0.null_p(l21830)!==false) {var if_res1165 = false;} else {if (M0.null_p(l31831)!==false) {var if_res1164 = false;} else {var v21832 = M0.car(l21830);if (M0.eq_p(M0.car(l11829),v21832)!==false) {var if_res1163 = subsets_p(M0.cdr(l11829),M0.cdr(l21830),M0.cdr(l31831));} else {if (M0.eq_p(v21832,M0.car(l31831))!==false) {var if_res1162 = subsets_p(l11829,M0.cdr(l21830),M0.cdr(l31831));} else {var if_res1162 = subsets_p(l11829,l21830,M0.cdr(l31831));}var if_res1163 = if_res1162;}var if_res1164 = if_res1163;}var if_res1165 = if_res1164;}var if_res1166 = if_res1165;}return if_res1166;};var keyword_procedure_extract_by_method = function(kws1833, n1834, p1835, method_n1836) {if (keyword_procedure_p(p1835)!==false) {var if_res1167 = keyword_procedure_checker(p1835)(kws1833,n1834);} else {var if_res1167 = false;}if (if_res1167!==false) {var if_res1197 = keyword_procedure_proc(p1835);} else {if (M0.not(keyword_procedure_p(p1835))!==false) {if (M0.procedure_p(p1835)!==false) {if (new_procedure_p(p1835)!==false) {var a1839 = procedure_accessor_ref(p1835);if (a1839!==false) {var if_res1168 = a1839(p1835);} else {var if_res1168 = false;}var if_res1169 = if_res1168;} else {var if_res1169 = false;}var or_part1838 = if_res1169;if (or_part1838!==false) {var if_res1172 = or_part1838;} else {var or_part1840 = M0.procedure_extract_target(p1835);if (or_part1840!==false) {var if_res1171 = or_part1840;} else {if (new_procedure_p(p1835)!==false) {var if_res1170 = $rjs_core.PrimitiveSymbol.make("method");} else {var if_res1170 = false;}var if_res1171 = if_res1170;}var if_res1172 = if_res1171;}var if_res1173 = if_res1172;} else {var if_res1173 = false;}var if_res1174 = if_res1173;} else {var if_res1174 = false;}var p21837 = if_res1174;if (p21837!==false) {if (M0.eq_p(p21837,$rjs_core.PrimitiveSymbol.make("method"))!==false) {var p31841 = keyword_procedure_extract_by_method(kws1833,M0.add1(n1834),new_procedure_ref(p1835),M0.add1(method_n1836));var if_res1176 = $rjs_core.attachProcedureArity(function(kws1842, kw_args1843, ...args18441175) {var args1844 = $rjs_core.Pair.listFromArray(args18441175);return M0.apply(p31841,kws1842,kw_args1843,M0.cons(p1835,args1844));});} else {var if_res1176 = keyword_procedure_extract_by_method(kws1833,n1834,p21837,method_n1836);}var if_res1196 = if_res1176;} else {var if_res1196 = $rjs_core.attachProcedureArity(function(kws1845, kw_args1846, ...args18471177) {var args1847 = $rjs_core.Pair.listFromArray(args18471177);if (keyword_procedure_p(p1835)!==false) {var if_res1178 = check_kw_args(p1835,kws1845);} else {var if_res1178 = M0.values(false,M0.car(kws1845));}var let_result1179 = if_res1178;var missing_kw1848 = let_result1179.getAt(0);var extra_kw1849 = let_result1179.getAt(1);var or_part1854 = keyword_method_p(p1835);if (or_part1854!==false) {var if_res1180 = or_part1854;} else {var if_res1180 = okm_p(p1835);}if (if_res1180!==false) {var if_res1181 = 1;} else {var if_res1181 = 0;}var method_n1853 = method_n1836+if_res1181;if (M0.__gt__eq_(n1834,method_n1853)!==false) {var if_res1182 = n1834-method_n1853;} else {var if_res1182 = n1834;}var n1850 = if_res1182;if (M0.null_p(args1847)!==false) {var if_res1183 = M0.null_p(kws1845);} else {var if_res1183 = false;}if (if_res1183!==false) {var if_res1184 = $rjs_core.UString.make("");} else {var if_res1184 = M0.apply(M0.string_append,$rjs_core.UString.make("\n  arguments...:"),M0.append(M0.map(function(v1855) {return M0.format($rjs_core.UString.make("\n   ~e"),v1855);},args1847),M0.map(function(kw1856, kw_arg1857) {return M0.format($rjs_core.UString.make("\n   ~a ~e"),kw1856,kw_arg1857);},kws1845,kw_args1846)));}var args_str1851 = if_res1184;var proc_name1852 = function(p1858) {if (named_keyword_procedure_p(p1858)!==false) {var if_res1185 = M0.car(keyword_procedure_name_plus_fail(p1858));} else {var if_res1185 = false;}var or_part1859 = if_res1185;if (or_part1859!==false) {var if_res1187 = or_part1859;} else {var or_part1860 = M0.object_name(p1858);if (or_part1860!==false) {var if_res1186 = or_part1860;} else {var if_res1186 = p1858;}var if_res1187 = if_res1186;}return if_res1187;};var or_part1861 = extra_kw1849;if (or_part1861!==false) {var if_res1194 = or_part1861;} else {var if_res1194 = missing_kw1848;}if (if_res1194!==false) {var if_res1195 = M0.__rjs_quoted__.exn_fail_contract;} else {var if_res1195 = M0.__rjs_quoted__.exn_fail_contract_arity;}if (extra_kw1849!==false) {if (keyword_procedure_p(p1835)!==false) {var if_res1189 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not expect an argument with given keyword\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  given keyword: ~a"),$rjs_core.UString.make("~a")),proc_name1852(p1835),extra_kw1849,args_str1851);} else {if (M0.procedure_p(p1835)!==false) {var if_res1188 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not accept keyword arguments\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a")),proc_name1852(p1835),args_str1851);} else {var if_res1188 = M0.format(M0.string_append($rjs_core.UString.make("application: not a procedure;\n"),$rjs_core.UString.make(" expected a procedure that can be applied to arguments\n"),$rjs_core.UString.make("  given: ~e"),$rjs_core.UString.make("~a")),p1835,args_str1851);}var if_res1189 = if_res1188;}var if_res1193 = if_res1189;} else {if (missing_kw1848!==false) {var if_res1192 = M0.format(M0.string_append($rjs_core.UString.make("application: required keyword argument not supplied\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  required keyword: ~a"),$rjs_core.UString.make("~a")),proc_name1852(p1835),missing_kw1848,args_str1851);} else {var temp1191 = M0.string_append($rjs_core.UString.make("application: no case matching ~a non-keyword argument~a\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a"));if (M0.__eq_(1,n1850-2)!==false) {var if_res1190 = $rjs_core.UString.make("");} else {var if_res1190 = $rjs_core.UString.make("s");}var if_res1192 = M0.format(temp1191,n1850-2,if_res1190,proc_name1852(p1835),args_str1851);}var if_res1193 = if_res1192;}return M0.raise(if_res1195(if_res1193,M0.current_continuation_marks()));});}var if_res1197 = if_res1196;}return if_res1197;};var keyword_procedure_extract = function(p1862, kws1863, n1864) {return keyword_procedure_extract_by_method(kws1863,n1864,p1862,0);};var cl1198 = function(proc1865, arity1866, req_kw1867, allowed_kw1868, name1869) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1865,arity1866,false,name1869,req_kw1867,allowed_kw1868);};var cl1199 = function(proc1870, arity1871, req_kw1872, allowed_kw1873) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1870,arity1871,false,false,req_kw1872,allowed_kw1873);};var procedure_reduce_keyword_arity = $rjs_core.attachProcedureArity(function() {var fixed_lam1200 = {'5':cl1198,'4':cl1199}[arguments.length];if (fixed_lam1200!==undefined) {return fixed_lam1200.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var cl1201 = function(proc1874, mask1875, req_kw1876, allowed_kw1877, name1878) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1874,false,mask1875,name1878,req_kw1876,allowed_kw1877);};var cl1202 = function(proc1879, mask1880, req_kw1881, allowed_kw1882) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1879,false,mask1880,false,req_kw1881,allowed_kw1882);};var procedure_reduce_keyword_arity_mask = $rjs_core.attachProcedureArity(function() {var fixed_lam1203 = {'5':cl1201,'4':cl1202}[arguments.length];if (fixed_lam1203!==undefined) {return fixed_lam1203.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var do_procedure_reduce_keyword_arity = function(who1883, proc1884, arity1885, mask1886, name1887, req_kw1888, allowed_kw1889) {if (okp_p(proc1884)!==false) {var if_res1204 = okp_ref(proc1884,0);} else {var if_res1204 = proc1884;}var p1891 = if_res1204;if (arity1885!==false) {var if_res1205 = M0.__rjs_quoted__.procedure_reduce_arity(p1891,arity1885);} else {var if_res1205 = M0.__rjs_quoted__.procedure_reduce_arity_mask(p1891,mask1886,name1887);}var plain_proc1890 = if_res1205;var sorted_p1892 = function(kws1893) {var loop1894 = function(kws1895) {if (M0.null_p(kws1895)!==false) {var if_res1208 = true;} else {if (M0.null_p(M0.cdr(kws1895))!==false) {var if_res1207 = true;} else {if (M0.keyword_lt__p(M0.car(kws1895),M0.cadr(kws1895))!==false) {var if_res1206 = loop1894(M0.cdr(kws1895));} else {var if_res1206 = false;}var if_res1207 = if_res1206;}var if_res1208 = if_res1207;}return if_res1208;};return loop1894(kws1893);};if (M0.list_p(req_kw1888)!==false) {if (M0.andmap(M0.keyword_p,req_kw1888)!==false) {var if_res1209 = sorted_p1892(req_kw1888);} else {var if_res1209 = false;}var if_res1210 = if_res1209;} else {var if_res1210 = false;}if (if_res1210!==false) {var if_res1213 = M0.rvoid();} else {var temp1212 = $rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)");var or_part1896 = arity1885;if (or_part1896!==false) {var if_res1211 = or_part1896;} else {var if_res1211 = mask1886;}var if_res1213 = M0.raise_argument_error(who1883,temp1212,2,proc1884,if_res1211,req_kw1888,allowed_kw1889);}if_res1213;if (allowed_kw1889!==false) {if (M0.list_p(allowed_kw1889)!==false) {if (M0.andmap(M0.keyword_p,allowed_kw1889)!==false) {var if_res1214 = sorted_p1892(allowed_kw1889);} else {var if_res1214 = false;}var if_res1215 = if_res1214;} else {var if_res1215 = false;}if (if_res1215!==false) {var if_res1218 = M0.rvoid();} else {var temp1217 = $rjs_core.UString.make("(or/c (and/c (listof? keyword?) sorted? distinct?) #f)");var or_part1897 = arity1885;if (or_part1897!==false) {var if_res1216 = or_part1897;} else {var if_res1216 = mask1886;}var if_res1218 = M0.raise_argument_error(who1883,temp1217,3,proc1884,if_res1216,req_kw1888,allowed_kw1889);}if_res1218;if (subset_p(req_kw1888,allowed_kw1889)!==false) {var if_res1219 = M0.rvoid();} else {var if_res1219 = M0.raise_arguments_error(who1883,$rjs_core.UString.make("allowed-keyword list does not include all required keywords"),$rjs_core.UString.make("allowed-keyword list"),allowed_kw1889,$rjs_core.UString.make("required keywords"),req_kw1888);}var if_res1220 = if_res1219;} else {var if_res1220 = M0.rvoid();}if_res1220;var let_result1221 = procedure_keywords(proc1884);var old_req1898 = let_result1221.getAt(0);var old_allowed1899 = let_result1221.getAt(1);if (subset_p(old_req1898,req_kw1888)!==false) {var if_res1222 = M0.rvoid();} else {var if_res1222 = M0.raise_arguments_error(who1883,$rjs_core.UString.make("cannot reduce required keyword set"),$rjs_core.UString.make("required keywords"),old_req1898,$rjs_core.UString.make("requested required keywords"),req_kw1888);}if_res1222;if (old_allowed1899!==false) {if (subset_p(req_kw1888,old_allowed1899)!==false) {var if_res1223 = M0.rvoid();} else {var if_res1223 = M0.raise_arguments_error(who1883,$rjs_core.UString.make("cannot require keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed1899,$rjs_core.UString.make("requested required keywords"),req_kw1888);}if_res1223;var or_part1900 = M0.not(allowed_kw1889);if (or_part1900!==false) {var if_res1224 = or_part1900;} else {var if_res1224 = subset_p(allowed_kw1889,old_allowed1899);}if (if_res1224!==false) {var if_res1225 = M0.rvoid();} else {var if_res1225 = M0.raise_arguments_error(who1883,$rjs_core.UString.make("cannot allow keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed1899,$rjs_core.UString.make("requested allowed keywords"),allowed_kw1889);}var if_res1226 = if_res1225;} else {var if_res1226 = M0.rvoid();}if_res1226;if (M0.null_p(allowed_kw1889)!==false) {var if_res1234 = plain_proc1890;} else {var or_part1902 = mask1886;if (or_part1902!==false) {var if_res1227 = or_part1902;} else {var if_res1227 = arity__gt_mask(arity1885);}var mask1901 = if_res1227;var new_mask1903 = M0.arithmetic_shift(mask1901,2);var kw_checker1904 = make_keyword_checker(req_kw1888,allowed_kw1889,new_mask1903);var proc1905 = normalize_proc(proc1884);var new_kw_proc1906 = M0.__rjs_quoted__.procedure_reduce_arity_mask(keyword_procedure_proc(proc1905),new_mask1903);if (M0.null_p(req_kw1888)!==false) {if (okm_p(proc1905)!==false) {var if_res1228 = make_optional_keyword_method;} else {var if_res1228 = make_optional_keyword_procedure;}var if_res1233 = if_res1228(kw_checker1904,new_kw_proc1906,req_kw1888,allowed_kw1889,plain_proc1890);} else {if (named_keyword_procedure_p(proc1905)!==false) {var if_res1231 = M0.car(keyword_procedure_name_plus_fail(proc1905));} else {var if_res1231 = false;}var or_part1907 = if_res1231;if (or_part1907!==false) {var if_res1232 = or_part1907;} else {var if_res1232 = M0.object_name(proc1905);}var temp1230 = M0.__rjs_quoted__.procedure_reduce_arity_mask(missing_kw,M0.arithmetic_shift(mask1901,1));var or_part1908 = okm_p(proc1905);if (or_part1908!==false) {var if_res1229 = or_part1908;} else {var if_res1229 = keyword_method_p(proc1905);}var if_res1233 = make_required(if_res1232,temp1230,if_res1229,false)(kw_checker1904,new_kw_proc1906,req_kw1888,allowed_kw1889);}var if_res1234 = if_res1233;}return if_res1234;};var arity__gt_mask = function(a1909) {if (M0.exact_nonnegative_integer_p(a1909)!==false) {var if_res1240 = M0.arithmetic_shift(1,a1909);} else {if (M0.arity_at_least_p(a1909)!==false) {var if_res1239 = M0.bitwise_xor(-1,M0.sub1(M0.arithmetic_shift(1,M0.arity_at_least_value(a1909))));} else {if (M0.list_p(a1909)!==false) {var loop1910 = function(mask1911, l1912) {if (M0.null_p(l1912)!==false) {var if_res1237 = mask1911;} else {var a1913 = M0.car(l1912);var or_part1914 = M0.exact_nonnegative_integer_p(a1913);if (or_part1914!==false) {var if_res1235 = or_part1914;} else {var if_res1235 = M0.arity_at_least_p(a1913);}if (if_res1235!==false) {var if_res1236 = loop1910(M0.bitwise_ior(mask1911,arity__gt_mask(a1913)),M0.cdr(l1912));} else {var if_res1236 = false;}var if_res1237 = if_res1236;}return if_res1237;};var if_res1238 = loop1910(0,a1909);} else {var if_res1238 = false;}var if_res1239 = if_res1238;}var if_res1240 = if_res1239;}return if_res1240;};var cl1241 = function(proc1916, arity1917, name1918) {if (M0.procedure_p(proc1916)!==false) {var let_result1244 = procedure_keywords(proc1916);var req1919 = let_result1244.getAt(0);var allows1920 = let_result1244.getAt(1);if (M0.pair_p(req1919)!==false) {var if_res1245 = M0.not(M0.null_p(arity1917));} else {var if_res1245 = false;}var if_res1246 = if_res1245;} else {var if_res1246 = false;}if (if_res1246!==false) {var if_res1248 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1916);} else {if (okm_p(proc1916)!==false) {var if_res1247 = M0.__rjs_quoted__.procedure__gt_method(proc1916);} else {var if_res1247 = proc1916;}var if_res1248 = M0.__rjs_quoted__.procedure_reduce_arity(if_res1247,arity1917,name1918);}return if_res1248;};var cl1242 = function(proc1921, arity1922) {return new_procedure_reduce_arity(proc1921,arity1922,false);};var procedure_reduce_arity1915 = $rjs_core.attachProcedureArity(function() {var fixed_lam1243 = {'3':cl1241,'2':cl1242}[arguments.length];if (fixed_lam1243!==undefined) {return fixed_lam1243.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity = procedure_reduce_arity1915;var cl1249 = function(proc1924, mask1925, name1926) {if (M0.procedure_p(proc1924)!==false) {var let_result1252 = procedure_keywords(proc1924);var req1927 = let_result1252.getAt(0);var allows1928 = let_result1252.getAt(1);if (M0.pair_p(req1927)!==false) {var if_res1253 = M0.not(M0.eqv_p(mask1925,0));} else {var if_res1253 = false;}var if_res1254 = if_res1253;} else {var if_res1254 = false;}if (if_res1254!==false) {var if_res1256 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1924);} else {if (okm_p(proc1924)!==false) {var if_res1255 = M0.__rjs_quoted__.procedure__gt_method(proc1924);} else {var if_res1255 = proc1924;}var if_res1256 = M0.__rjs_quoted__.procedure_reduce_arity_mask(if_res1255,mask1925,name1926);}return if_res1256;};var cl1250 = function(proc1929, mask1930) {return new_procedure_reduce_arity_mask(proc1929,mask1930,false);};var procedure_reduce_arity1923 = $rjs_core.attachProcedureArity(function() {var fixed_lam1251 = {'3':cl1249,'2':cl1250}[arguments.length];if (fixed_lam1251!==undefined) {return fixed_lam1251.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity_mask = procedure_reduce_arity1923;var procedure__gt_method1931 = function(proc1932) {var proc1933 = normalize_proc(proc1932);if (keyword_procedure_p(proc1933)!==false) {if (okm_p(proc1933)!==false) {var if_res1259 = proc1933;} else {if (keyword_method_p(proc1933)!==false) {var if_res1258 = proc1933;} else {if (okp_p(proc1933)!==false) {var if_res1257 = make_optional_keyword_method(keyword_procedure_checker(proc1933),keyword_procedure_proc(proc1933),keyword_procedure_required(proc1933),keyword_procedure_allowed(proc1933),okp_ref(proc1933,0));} else {var name_plus_fail1934 = keyword_procedure_name_plus_fail(proc1933);var mk1935 = make_required(M0.car(name_plus_fail1934),M0.cdr(name_plus_fail1934),true,false);var if_res1257 = mk1935(keyword_procedure_checker(proc1933),keyword_procedure_proc(proc1933),keyword_procedure_required(proc1933),keyword_procedure_allowed(proc1933));}var if_res1258 = if_res1257;}var if_res1259 = if_res1258;}var if_res1260 = if_res1259;} else {var if_res1260 = M0.__rjs_quoted__.procedure__gt_method(proc1933);}return if_res1260;};var new_procedure__gt_method = procedure__gt_method1931;var procedure_rename1936 = function(proc1937, name1938) {if (keyword_procedure_p(proc1937)!==false) {var if_res1261 = M0.symbol_p(name1938);} else {var if_res1261 = false;}if (M0.not(if_res1261)!==false) {var if_res1264 = M0.__rjs_quoted__.procedure_rename(proc1937,name1938);} else {if (okp_p(proc1937)!==false) {if (okm_p(proc1937)!==false) {var if_res1262 = make_optional_keyword_method;} else {var if_res1262 = make_optional_keyword_procedure;}var if_res1263 = if_res1262(keyword_procedure_checker(proc1937),keyword_procedure_proc(proc1937),keyword_procedure_required(proc1937),keyword_procedure_allowed(proc1937),M0.__rjs_quoted__.procedure_rename(okp_ref(proc1937,0),name1938));} else {var name_plus_fail1939 = keyword_procedure_name_plus_fail(proc1937);var mk1940 = make_required(name1938,M0.cdr(name_plus_fail1939),keyword_method_p(proc1937),false);var if_res1263 = mk1940(keyword_procedure_checker(proc1937),keyword_procedure_proc(proc1937),keyword_procedure_required(proc1937),keyword_procedure_allowed(proc1937));}var if_res1264 = if_res1263;}return if_res1264;};var new_procedure_rename = procedure_rename1936;var chaperone_procedure1941 = $rjs_core.attachProcedureArity(function(proc1942, wrap_proc1943, ...props19441265) {var props1944 = $rjs_core.Pair.listFromArray(props19441265);return do_chaperone_procedure(false,false,M0.__rjs_quoted__.chaperone_procedure,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc1942,wrap_proc1943,props1944);});var new_chaperone_procedure = chaperone_procedure1941;var unsafe_chaperone_procedure1945 = $rjs_core.attachProcedureArity(function(proc1946, wrap_proc1947, ...props19481266) {var props1948 = $rjs_core.Pair.listFromArray(props19481266);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_chaperone_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-chaperone-procedure"),proc1946,wrap_proc1947,props1948);});var new_unsafe_chaperone_procedure = unsafe_chaperone_procedure1945;var impersonate_procedure1949 = $rjs_core.attachProcedureArity(function(proc1950, wrap_proc1951, ...props19521267) {var props1952 = $rjs_core.Pair.listFromArray(props19521267);return do_chaperone_procedure(true,false,M0.__rjs_quoted__.impersonate_procedure,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc1950,wrap_proc1951,props1952);});var new_impersonate_procedure = impersonate_procedure1949;var unsafe_impersonate_procedure1953 = $rjs_core.attachProcedureArity(function(proc1954, wrap_proc1955, ...props19561268) {var props1956 = $rjs_core.Pair.listFromArray(props19561268);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_impersonate_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-impersonate-procedure"),proc1954,wrap_proc1955,props1956);});var new_unsafe_impersonate_procedure = unsafe_impersonate_procedure1953;var chaperone_procedure_times_1957 = $rjs_core.attachProcedureArity(function(proc1958, wrap_proc1959, ...props19601269) {var props1960 = $rjs_core.Pair.listFromArray(props19601269);return do_chaperone_procedure(false,true,M0.__rjs_quoted__.chaperone_procedure_times_,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc1958,wrap_proc1959,props1960);});var new_chaperone_procedure_times_ = chaperone_procedure_times_1957;var impersonate_procedure_times_1961 = $rjs_core.attachProcedureArity(function(proc1962, wrap_proc1963, ...props19641270) {var props1964 = $rjs_core.Pair.listFromArray(props19641270);return do_chaperone_procedure(true,true,M0.__rjs_quoted__.impersonate_procedure_times_,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc1962,wrap_proc1963,props1964);});var new_impersonate_procedure_times_ = impersonate_procedure_times_1961;var do_chaperone_procedure = function(is_impersonator_p1965, self_arg_p1966, chaperone_procedure1967, name1968, proc1969, wrap_proc1970, props1971) {var n_proc1972 = normalize_proc(proc1969);var n_wrap_proc1973 = normalize_proc(wrap_proc1970);var or_part1974 = M0.not(keyword_procedure_p(n_proc1972));if (or_part1974!==false) {var if_res1272 = or_part1974;} else {var or_part1975 = M0.not(M0.procedure_p(wrap_proc1970));if (or_part1975!==false) {var if_res1271 = or_part1975;} else {var if_res1271 = bad_props_p(props1971);}var if_res1272 = if_res1271;}if (if_res1272!==false) {var if_res1339 = M0.apply(chaperone_procedure1967,proc1969,wrap_proc1970,props1971);} else {chaperone_arity_match_checking(self_arg_p1966,name1968,proc1969,wrap_proc1970,props1971);var loop1977 = function(props1978) {if (M0.null_p(props1978)!==false) {var if_res1274 = false;} else {if (M0.eq_p(M0.car(props1978),M0.__rjs_quoted__.impersonator_prop_application_mark)!==false) {var if_res1273 = M0.cadr(props1978);} else {var if_res1273 = loop1977(M0.cddr(props1978));}var if_res1274 = if_res1273;}return if_res1274;};var mark_prop1976 = loop1977(props1971);var chaperone_procedure_by_add_mark1979 = function(proc1980, wrap_proc1981) {if (mark_prop1976!==false) {var if_res1275 = chaperone_procedure1967(proc1980,wrap_proc1981,M0.__rjs_quoted__.impersonator_prop_application_mark,mark_prop1976);} else {var if_res1275 = chaperone_procedure1967(proc1980,wrap_proc1981);}return if_res1275;};var p1983 = keyword_procedure_proc(n_wrap_proc1973);if (self_arg_p1966!==false) {var cl1276 = $rjs_core.attachProcedureArity(function(self_proc1984, kws1985, args1986, ...rest19871281) {var rest1987 = $rjs_core.Pair.listFromArray(rest19871281);return M0.call_with_values(function() {return M0.apply(p1983,kws1985,args1986,self_proc1984,rest1987);},$rjs_core.attachProcedureArity(function(...results19881282) {var results1988 = $rjs_core.Pair.listFromArray(results19881282);var len1989 = M0.length(results1988);var alen1990 = M0.length(rest1987);if (M0.__lt_(len1989,alen1990+1)!==false) {var if_res1283 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen1990+1,$rjs_core.UString.make("received number of results"),len1989,$rjs_core.UString.make("wrapper procedure"),wrap_proc1970);} else {var if_res1283 = M0.rvoid();}if_res1283;var num_extra1991 = len1989-(alen1990+1);var new_args1992 = M0.list_ref(results1988,num_extra1991);if (M0.list_p(new_args1992)!==false) {var if_res1284 = M0.__eq_(M0.length(new_args1992),M0.length(args1986));} else {var if_res1284 = false;}if (if_res1284!==false) {var if_res1288 = M0.rvoid();} else {var temp1287 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp1286 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len1989,alen1990)!==false) {var if_res1285 = $rjs_core.UString.make("");} else {var if_res1285 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res1288 = M0.raise_arguments_error(temp1287,M0.format(temp1286,if_res1285),$rjs_core.UString.make("first result"),new_args1992,$rjs_core.UString.make("wrapper procedure"),wrap_proc1970);}if_res1288;M0.for_each(function(kw1993, new_arg1994, arg1995) {if (is_impersonator_p1965!==false) {var if_res1290 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg1994,arg1995)!==false) {var if_res1289 = M0.rvoid();} else {var if_res1289 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw1993),$rjs_core.UString.make("result"),new_arg1994,$rjs_core.UString.make("wrapper procedure"),wrap_proc1970);}var if_res1290 = if_res1289;}return if_res1290;},kws1985,new_args1992,args1986);var tmp1996 = num_extra1991;if (M0.equal_p(tmp1996,0)!==false) {var if_res1293 = M0.apply(M0.values,kws1985,results1988);} else {if (M0.equal_p(tmp1996,1)!==false) {var if_res1292 = M0.apply(M0.values,M0.car(results1988),kws1985,M0.cdr(results1988));} else {var loop1997 = function(results1998, c1999) {if (M0.zero_p(c1999)!==false) {var if_res1291 = M0.cons(kws1985,results1998);} else {var if_res1291 = M0.cons(M0.car(results1998),loop1997(M0.cdr(results1998),M0.sub1(c1999)));}return if_res1291;};var if_res1292 = M0.apply(M0.values,loop1997(results1988,num_extra1991));}var if_res1293 = if_res1292;}return if_res1293;}));});var cl1277 = $rjs_core.attachProcedureArity(function(...other20001294) {var other2000 = $rjs_core.Pair.listFromArray(other20001294);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res1314 = $rjs_core.attachProcedureArity(function() {var fixed_lam1278 = {}[arguments.length];if (fixed_lam1278!==undefined) {return fixed_lam1278.apply(null,arguments);} else {if (M0.__gt__eq_(cl1276.length,1)!==false) {var if_res1280 = cl1276.apply(null,arguments);} else {if (true!==false) {var if_res1279 = cl1277.apply(null,arguments);} else {var if_res1279 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res1280 = if_res1279;}return if_res1280;}},[M0.make_arity_at_least(0)]);} else {var cl1295 = $rjs_core.attachProcedureArity(function(kws2001, args2002, ...rest20031300) {var rest2003 = $rjs_core.Pair.listFromArray(rest20031300);return M0.call_with_values(function() {return M0.apply(p1983,kws2001,args2002,rest2003);},$rjs_core.attachProcedureArity(function(...results20041301) {var results2004 = $rjs_core.Pair.listFromArray(results20041301);var len2005 = M0.length(results2004);var alen2006 = M0.length(rest2003);if (M0.__lt_(len2005,alen2006+1)!==false) {var if_res1302 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen2006+1,$rjs_core.UString.make("received number of results"),len2005,$rjs_core.UString.make("wrapper procedure"),wrap_proc1970);} else {var if_res1302 = M0.rvoid();}if_res1302;var num_extra2007 = len2005-(alen2006+1);var new_args2008 = M0.list_ref(results2004,num_extra2007);if (M0.list_p(new_args2008)!==false) {var if_res1303 = M0.__eq_(M0.length(new_args2008),M0.length(args2002));} else {var if_res1303 = false;}if (if_res1303!==false) {var if_res1307 = M0.rvoid();} else {var temp1306 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp1305 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len2005,alen2006)!==false) {var if_res1304 = $rjs_core.UString.make("");} else {var if_res1304 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res1307 = M0.raise_arguments_error(temp1306,M0.format(temp1305,if_res1304),$rjs_core.UString.make("first result"),new_args2008,$rjs_core.UString.make("wrapper procedure"),wrap_proc1970);}if_res1307;M0.for_each(function(kw2009, new_arg2010, arg2011) {if (is_impersonator_p1965!==false) {var if_res1309 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg2010,arg2011)!==false) {var if_res1308 = M0.rvoid();} else {var if_res1308 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw2009),$rjs_core.UString.make("result"),new_arg2010,$rjs_core.UString.make("wrapper procedure"),wrap_proc1970);}var if_res1309 = if_res1308;}return if_res1309;},kws2001,new_args2008,args2002);var tmp2012 = num_extra2007;if (M0.equal_p(tmp2012,0)!==false) {var if_res1312 = M0.apply(M0.values,kws2001,results2004);} else {if (M0.equal_p(tmp2012,1)!==false) {var if_res1311 = M0.apply(M0.values,M0.car(results2004),kws2001,M0.cdr(results2004));} else {var loop2013 = function(results2014, c2015) {if (M0.zero_p(c2015)!==false) {var if_res1310 = M0.cons(kws2001,results2014);} else {var if_res1310 = M0.cons(M0.car(results2014),loop2013(M0.cdr(results2014),M0.sub1(c2015)));}return if_res1310;};var if_res1311 = M0.apply(M0.values,loop2013(results2004,num_extra2007));}var if_res1312 = if_res1311;}return if_res1312;}));});var cl1296 = $rjs_core.attachProcedureArity(function(...other20161313) {var other2016 = $rjs_core.Pair.listFromArray(other20161313);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res1314 = $rjs_core.attachProcedureArity(function() {var fixed_lam1297 = {}[arguments.length];if (fixed_lam1297!==undefined) {return fixed_lam1297.apply(null,arguments);} else {if (M0.__gt__eq_(cl1295.length,1)!==false) {var if_res1299 = cl1295.apply(null,arguments);} else {if (true!==false) {var if_res1298 = cl1296.apply(null,arguments);} else {var if_res1298 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res1299 = if_res1298;}return if_res1299;}},[M0.make_arity_at_least(0)]);}var kw_chaperone1982 = if_res1314;var wrap2019 = function(proc2020, n_proc2021) {if (M0.not(M0.eq_p(n_proc2021,proc2020))!==false) {var if_res1315 = new_procedure_p(proc2020);} else {var if_res1315 = false;}if (if_res1315!==false) {var v2022 = new_procedure_ref(proc2020);if (M0.exact_integer_p(v2022)!==false) {var acc2023 = procedure_accessor_ref(proc2020);var if_res1331 = M0.values(M0.__rjs_quoted__.chaperone_struct(proc2020,acc2023,function(self2024, sub_proc2025) {var let_result1316 = wrap2019(sub_proc2025,normalize_proc(sub_proc2025));var f2026 = let_result1316.getAt(0);var acc2027 = let_result1316.getAt(1);return f2026;}),acc2023);} else {if (is_impersonator_p1965!==false) {var if_res1330 = M0.__rjs_quoted__.impersonate_struct;} else {var if_res1330 = M0.__rjs_quoted__.chaperone_struct;}if (okp_p(n_proc2021)!==false) {var if_res1329 = chaperone_procedure_by_add_mark1979(proc2020,wrap_proc1970);} else {var if_res1329 = proc2020;}var new_kw_proc2028 = if_res1330(if_res1329,new_procedure_ref,function(self2029, proc2030) {if (is_impersonator_p1965!==false) {var if_res1328 = new_impersonate_procedure;} else {var if_res1328 = new_chaperone_procedure;}if (self_arg_p1966!==false) {var if_res1327 = $rjs_core.attachProcedureArity(function(proc_self2031, kws2032, kw_args2033, self2034, ...args20351317) {var args2035 = $rjs_core.Pair.listFromArray(args20351317);var len2036 = M0.length(args2035);return M0.call_with_values(function() {return M0.apply(kw_chaperone1982,proc_self2031,kws2032,kw_args2033,args2035);},$rjs_core.attachProcedureArity(function(...results20371318) {var results2037 = $rjs_core.Pair.listFromArray(results20371318);var r_len2038 = M0.length(results2037);var list_take2039 = function(l2040, n2041) {if (M0.zero_p(n2041)!==false) {var if_res1319 = M0.rnull;} else {var if_res1319 = M0.cons(M0.car(l2040),list_take2039(M0.cdr(l2040),M0.sub1(n2041)));}return if_res1319;};if (M0.null_p($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("proc-self")))!==false) {var if_res1320 = M0.__eq_(r_len2038,2+len2036);} else {var if_res1320 = false;}if (if_res1320!==false) {var if_res1321 = M0.apply(M0.values,M0.cadr(results2037),self2034,M0.cddr(results2037));} else {var skip2042 = r_len2038-len2036;var if_res1321 = M0.apply(M0.values,M0.append(list_take2039(results2037,skip2042-2),M0.list(M0.list_ref(results2037,M0.sub1(skip2042)),self2034),M0.__rjs_quoted__.list_tail(results2037,skip2042)));}return if_res1321;}));});} else {var if_res1327 = $rjs_core.attachProcedureArity(function(kws2043, kw_args2044, self2045, ...args20461322) {var args2046 = $rjs_core.Pair.listFromArray(args20461322);var len2047 = M0.length(args2046);return M0.call_with_values(function() {return M0.apply(kw_chaperone1982,kws2043,kw_args2044,args2046);},$rjs_core.attachProcedureArity(function(...results20481323) {var results2048 = $rjs_core.Pair.listFromArray(results20481323);var r_len2049 = M0.length(results2048);var list_take2050 = function(l2051, n2052) {if (M0.zero_p(n2052)!==false) {var if_res1324 = M0.rnull;} else {var if_res1324 = M0.cons(M0.car(l2051),list_take2050(M0.cdr(l2051),M0.sub1(n2052)));}return if_res1324;};if (M0.null_p($rjs_core.Pair.makeList())!==false) {var if_res1325 = M0.__eq_(r_len2049,2+len2047);} else {var if_res1325 = false;}if (if_res1325!==false) {var if_res1326 = M0.apply(M0.values,M0.cadr(results2048),self2045,M0.cddr(results2048));} else {var skip2053 = r_len2049-len2047;var if_res1326 = M0.apply(M0.values,M0.append(list_take2050(results2048,skip2053-2),M0.list(M0.list_ref(results2048,M0.sub1(skip2053)),self2045),M0.__rjs_quoted__.list_tail(results2048,skip2053)));}return if_res1326;}));});}return if_res1328(proc2030,make_keyword_procedure(if_res1327));});var if_res1331 = M0.values(new_kw_proc2028,new_procedure_ref);}var if_res1336 = if_res1331;} else {if (okp_p(n_proc2021)!==false) {if (is_impersonator_p1965!==false) {if (okm_p(n_proc2021)!==false) {var if_res1332 = make_optional_keyword_method_impersonator;} else {var if_res1332 = make_optional_keyword_procedure_impersonator;}var if_res1333 = if_res1332(keyword_procedure_checker(n_proc2021),chaperone_procedure_by_add_mark1979(keyword_procedure_proc(n_proc2021),kw_chaperone1982),keyword_procedure_required(n_proc2021),keyword_procedure_allowed(n_proc2021),chaperone_procedure_by_add_mark1979(okp_ref(n_proc2021,0),okp_ref(n_wrap_proc1973,0)),n_proc2021);} else {var if_res1333 = M0.__rjs_quoted__.chaperone_struct(proc2020,keyword_procedure_proc,function(self2054, proc2055) {return chaperone_procedure_by_add_mark1979(proc2055,kw_chaperone1982);},M0.make_struct_field_accessor(okp_ref,0),function(self2056, proc2057) {return chaperone_procedure_by_add_mark1979(proc2057,okp_ref(n_wrap_proc1973,0));});}var if_res1335 = M0.values(if_res1333,keyword_procedure_proc);} else {if (is_impersonator_p1965!==false) {var name_plus_fail2058 = keyword_procedure_name_plus_fail(n_proc2021);var mk2059 = make_required(M0.car(name_plus_fail2058),M0.cdr(name_plus_fail2058),keyword_method_p(n_proc2021),true);var if_res1334 = mk2059(keyword_procedure_checker(n_proc2021),chaperone_procedure_by_add_mark1979(keyword_procedure_proc(n_proc2021),kw_chaperone1982),keyword_procedure_required(n_proc2021),keyword_procedure_allowed(n_proc2021),n_proc2021);} else {var if_res1334 = M0.__rjs_quoted__.chaperone_struct(n_proc2021,keyword_procedure_proc,function(self2060, proc2061) {return chaperone_procedure_by_add_mark1979(proc2061,kw_chaperone1982);});}var if_res1335 = M0.values(if_res1334,keyword_procedure_proc);}var if_res1336 = if_res1335;}return if_res1336;};var let_result1337 = wrap2019(proc1969,n_proc1972);var new_proc2017 = let_result1337.getAt(0);var chap_accessor2018 = let_result1337.getAt(1);if (M0.null_p(props1971)!==false) {var if_res1338 = new_proc2017;} else {var if_res1338 = M0.apply(M0.__rjs_quoted__.chaperone_struct,new_proc2017,chap_accessor2018,false,props1971);}var if_res1339 = if_res1338;}return if_res1339;};var do_unsafe_chaperone_procedure = function(unsafe_chaperone_procedure2062, name2063, proc2064, wrap_proc2065, props2066) {var n_proc2067 = normalize_proc(proc2064);var n_wrap_proc2068 = normalize_proc(wrap_proc2065);var or_part2069 = M0.not(keyword_procedure_p(n_proc2067));if (or_part2069!==false) {var if_res1341 = or_part2069;} else {var or_part2070 = M0.not(M0.procedure_p(wrap_proc2065));if (or_part2070!==false) {var if_res1340 = or_part2070;} else {var if_res1340 = bad_props_p(props2066);}var if_res1341 = if_res1340;}if (if_res1341!==false) {var if_res1342 = M0.apply(unsafe_chaperone_procedure2062,proc2064,wrap_proc2065,props2066);} else {chaperone_arity_match_checking(false,name2063,proc2064,wrap_proc2065,props2066);var if_res1342 = M0.apply(unsafe_chaperone_procedure2062,proc2064,wrap_proc2065,props2066);}return if_res1342;};var bad_props_p = function(props2071) {var loop2072 = function(props2073) {if (M0.null_p(props2073)!==false) {var if_res1345 = false;} else {if (M0.__rjs_quoted__.impersonator_property_p(M0.car(props2073))!==false) {var props2074 = M0.cdr(props2073);var or_part2075 = M0.null_p(props2074);if (or_part2075!==false) {var if_res1343 = or_part2075;} else {var if_res1343 = loop2072(M0.cdr(props2074));}var if_res1344 = if_res1343;} else {var if_res1344 = true;}var if_res1345 = if_res1344;}return if_res1345;};return loop2072(props2071);};var chaperone_arity_match_checking = function(self_arg_p2076, name2077, proc2078, wrap_proc2079, props2080) {var a2081 = M0.procedure_arity(proc2078);var b2082 = M0.procedure_arity(wrap_proc2079);if (self_arg_p2076!==false) {var if_res1346 = 1;} else {var if_res1346 = 0;}var d2083 = if_res1346;var let_result1347 = procedure_keywords(proc2078);var a_req2084 = let_result1347.getAt(0);var a_allow2085 = let_result1347.getAt(1);var let_result1348 = procedure_keywords(wrap_proc2079);var b_req2086 = let_result1348.getAt(0);var b_allow2087 = let_result1348.getAt(1);var includes_p2088 = function(a2089, b2090) {if (M0.number_p(b2090)!==false) {if (M0.number_p(a2089)!==false) {var if_res1350 = M0.__eq_(b2090,a2089+d2083);} else {if (M0.arity_at_least_p(a2089)!==false) {var if_res1349 = M0.__gt__eq_(b2090,M0.arity_at_least_value(a2089)+d2083);} else {var if_res1349 = M0.ormap(function(a2091) {return includes_p2088(a2091,b2090);},a2089);}var if_res1350 = if_res1349;}var if_res1354 = if_res1350;} else {if (M0.arity_at_least_p(b2090)!==false) {if (M0.number_p(a2089)!==false) {var if_res1352 = false;} else {if (M0.arity_at_least_p(a2089)!==false) {var if_res1351 = M0.__gt__eq_(M0.arity_at_least_value(b2090),M0.arity_at_least_value(a2089)+d2083);} else {var if_res1351 = M0.ormap(function(a2092) {return includes_p2088(b2090,a2092);},a2089);}var if_res1352 = if_res1351;}var if_res1353 = if_res1352;} else {var if_res1353 = M0.andmap(function(b2093) {return includes_p2088(a2089,b2093);},b2090);}var if_res1354 = if_res1353;}return if_res1354;};if (includes_p2088(b2082,a2081)!==false) {var if_res1355 = M0.rvoid();} else {var if_res1355 = M0.apply(M0.__rjs_quoted__.chaperone_procedure,proc2078,wrap_proc2079,props2080);}if_res1355;if (subset_p(b_req2086,a_req2084)!==false) {var if_res1356 = M0.rvoid();} else {var if_res1356 = M0.raise_arguments_error(name2077,$rjs_core.UString.make("wrapper procedure requires more keywords than original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc2079,$rjs_core.UString.make("original procedure"),proc2078);}if_res1356;var or_part2094 = M0.not(b_allow2087);if (or_part2094!==false) {var if_res1358 = or_part2094;} else {if (a_allow2085!==false) {var if_res1357 = subset_p(a_allow2085,b_allow2087);} else {var if_res1357 = false;}var if_res1358 = if_res1357;}if (if_res1358!==false) {var if_res1359 = M0.rvoid();} else {var if_res1359 = M0.raise_arguments_error(name2077,$rjs_core.UString.make("wrapper procedure does not accept all keywords of original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc2079,$rjs_core.UString.make("original procedure"),proc2078);}if_res1359;return M0.rvoid();};var normalize_proc = function(proc2095) {if (keyword_procedure_p(proc2095)!==false) {var if_res1367 = proc2095;} else {if (new_procedure_p(proc2095)!==false) {var let_result1360 = procedure_keywords(proc2095);var req_kws2096 = let_result1360.getAt(0);var allowed_kws2097 = let_result1360.getAt(1);if (M0.null_p(allowed_kws2097)!==false) {var if_res1365 = proc2095;} else {var if_res1365 = make_optional_keyword_procedure(function(given_kws2098, given_argc2099) {if (M0.procedure_arity_includes_p(proc2095,given_argc2099-2,true)!==false) {var or_part2100 = M0.not(allowed_kws2097);if (or_part2100!==false) {var if_res1362 = or_part2100;} else {var if_res1362 = subset_p(given_kws2098,allowed_kws2097);}if (if_res1362!==false) {var if_res1363 = subset_p(req_kws2096,given_kws2098);} else {var if_res1363 = false;}var if_res1364 = if_res1363;} else {var if_res1364 = false;}return if_res1364;},$rjs_core.attachProcedureArity(function(kws2101, kw_args2102, ...vals21031361) {var vals2103 = $rjs_core.Pair.listFromArray(vals21031361);return keyword_apply(proc2095,kws2101,kw_args2102,vals2103);}),req_kws2096,allowed_kws2097,proc2095);}var if_res1366 = if_res1365;} else {var if_res1366 = proc2095;}var if_res1367 = if_res1366;}return if_res1367;};var __rjs_quoted__ = {};__rjs_quoted__.make_optional_keyword_method = make_optional_keyword_method;__rjs_quoted__.struct_keyword_procedure_by_arity_error = struct_keyword_procedure_by_arity_error;__rjs_quoted__.prop_named_keyword_procedure = prop_named_keyword_procedure;__rjs_quoted__.make_optional_keyword_procedure = make_optional_keyword_procedure;__rjs_quoted__.struct_keyword_procedure = struct_keyword_procedure;__rjs_quoted__.struct_keyword_method_by_arity_error = struct_keyword_method_by_arity_error;__rjs_quoted__.subset_p = subset_p;__rjs_quoted__.missing_kw = missing_kw;__rjs_quoted__.subsets_p = subsets_p;__rjs_quoted__.keyword_procedure_extract = keyword_procedure_extract;export { __rjs_quoted__,new_impersonate_procedure_times_,new_chaperone_procedure_times_,new_unsafe_impersonate_procedure,new_impersonate_procedure,new_unsafe_chaperone_procedure,new_chaperone_procedure,new_procedure_rename,new_procedure__gt_method,new_prop_procedure,procedure_reduce_keyword_arity_mask,procedure_reduce_keyword_arity,new_procedure_reduce_arity_mask,new_procedure_reduce_arity,procedure_keywords,keyword_apply,make_keyword_procedure };