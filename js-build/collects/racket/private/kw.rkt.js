import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/unsafe.rkt.js";var let_result1559 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("keyword-impersonator"));var prop_keyword_impersonator = let_result1559.getAt(0);var keyword_impersonator_p = let_result1559.getAt(1);var keyword_impersonator_ref = let_result1559.getAt(2);var keyword_procedure_impersonator_of = function(v2843) {if (keyword_impersonator_p(v2843)!==false) {var if_res1560 = keyword_impersonator_ref(v2843)(v2843);} else {var if_res1560 = false;}return if_res1560;};var let_result1561 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("keyword-procedure"),false,4,0,false,M0.list(M0.cons(M0.prop_checked_procedure,true),M0.cons(M0.prop_impersonator_of,keyword_procedure_impersonator_of)),M0.current_inspector(),false,$rjs_core.Pair.makeList(0,1,2,3));var struct_keyword_procedure = let_result1561.getAt(0);var mk_kw_proc = let_result1561.getAt(1);var keyword_procedure_p = let_result1561.getAt(2);var keyword_procedure_ref = let_result1561.getAt(3);var keyword_procedure_set_bang_ = let_result1561.getAt(4);var keyword_procedure_checker = M0.make_struct_field_accessor(keyword_procedure_ref,0);var keyword_procedure_proc = M0.make_struct_field_accessor(keyword_procedure_ref,1);var keyword_procedure_required = M0.make_struct_field_accessor(keyword_procedure_ref,2);var keyword_procedure_allowed = M0.make_struct_field_accessor(keyword_procedure_ref,3);var let_result1562 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_keyword_method = let_result1562.getAt(0);var make_km = let_result1562.getAt(1);var keyword_method_p = let_result1562.getAt(2);var km_ref = let_result1562.getAt(3);var km_set_bang_ = let_result1562.getAt(4);var generate_arity_string = function(proc2844) {var let_result1563 = procedure_keywords(proc2844);var req2845 = let_result1563.getAt(0);var allowed2846 = let_result1563.getAt(1);var a2847 = M0.procedure_arity(proc2844);var keywords_desc2848 = function(opt2850, req2851) {var temp1569 = $rjs_core.UString.make("~a with keyword~a~a");if (M0.null_p(M0.cdr(req2851))!==false) {var if_res1568 = M0.format($rjs_core.UString.make("an ~aargument"),opt2850);} else {var if_res1568 = M0.format($rjs_core.UString.make("~aarguments"),opt2850);}if (M0.null_p(M0.cdr(req2851))!==false) {var if_res1567 = $rjs_core.UString.make("");} else {var if_res1567 = $rjs_core.UString.make("s");}var tmp2852 = M0.length(req2851);if (M0.equal_p(tmp2852,1)!==false) {var if_res1566 = M0.format($rjs_core.UString.make(" ~a"),M0.car(req2851));} else {if (M0.equal_p(tmp2852,2)!==false) {var if_res1565 = M0.format($rjs_core.UString.make(" ~a and ~a"),M0.car(req2851),M0.cadr(req2851));} else {var loop2853 = function(req2854) {if (M0.null_p(M0.cdr(req2854))!==false) {var if_res1564 = M0.format($rjs_core.UString.make(" and ~a"),M0.car(req2854));} else {var if_res1564 = M0.format($rjs_core.UString.make(" ~a,~a"),M0.car(req2854),loop2853(M0.cdr(req2854)));}return if_res1564;};var if_res1565 = loop2853(req2851);}var if_res1566 = if_res1565;}return M0.format(temp1569,if_res1568,if_res1567,if_res1566);};var method_adjust2849 = function(a2855) {var or_part2856 = okm_p(proc2844);if (or_part2856!==false) {var if_res1570 = or_part2856;} else {var if_res1570 = keyword_method_p(proc2844);}if (if_res1570!==false) {if (M0.zero_p(a2855)!==false) {var if_res1571 = 0;} else {var if_res1571 = M0.sub1(a2855);}var if_res1572 = if_res1571;} else {var if_res1572 = a2855;}return if_res1572;};if (M0.number_p(a2847)!==false) {var a2857 = method_adjust2849(a2847);var if_res1579 = M0.format($rjs_core.UString.make("~a"),a2857);} else {if (M0.arity_at_least_p(a2847)!==false) {var a2858 = method_adjust2849(M0.arity_at_least_value(a2847));var if_res1578 = M0.format($rjs_core.UString.make("at least ~a"),a2858);} else {var if_res1578 = $rjs_core.UString.make("a different number");}var if_res1579 = if_res1578;}if (M0.null_p(req2845)!==false) {var if_res1577 = $rjs_core.UString.make("");} else {var if_res1577 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc2848($rjs_core.UString.make(""),req2845));}if (allowed2846!==false) {var loop2860 = function(req2861, allowed2862) {if (M0.null_p(req2861)!==false) {var if_res1574 = allowed2862;} else {if (M0.eq_p(M0.car(req2861),M0.car(allowed2862))!==false) {var if_res1573 = loop2860(M0.cdr(req2861),M0.cdr(allowed2862));} else {var if_res1573 = M0.cons(M0.car(allowed2862),loop2860(req2861,M0.cdr(allowed2862)));}var if_res1574 = if_res1573;}return if_res1574;};var others2859 = loop2860(req2845,allowed2846);if (M0.null_p(others2859)!==false) {var if_res1575 = $rjs_core.UString.make("");} else {var if_res1575 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc2848($rjs_core.UString.make("optional "),others2859));}var if_res1576 = if_res1575;} else {var if_res1576 = $rjs_core.UString.make(" plus arbitrary keyword arguments");}return M0.string_append(if_res1579,if_res1577,if_res1576);};var let_result1580 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string)),M0.current_inspector(),0);var struct_okp = let_result1580.getAt(0);var make_optional_keyword_procedure = let_result1580.getAt(1);var okp_p = let_result1580.getAt(2);var okp_ref = let_result1580.getAt(3);var okp_set_bang_ = let_result1580.getAt(4);var let_result1581 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_okm = let_result1581.getAt(0);var make_optional_keyword_method = let_result1581.getAt(1);var okm_p = let_result1581.getAt(2);var okm_ref = let_result1581.getAt(3);var okm_set_bang_ = let_result1581.getAt(4);var let_result1582 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("named-keyword-procedure"));var prop_named_keyword_procedure = let_result1582.getAt(0);var named_keyword_procedure_p = let_result1582.getAt(1);var keyword_procedure_name_plus_fail = let_result1582.getAt(2);var let_result1584 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),function(v2863, info_l2864) {if (M0.exact_integer_p(v2863)!==false) {var if_res1583 = M0.make_struct_field_accessor(M0.list_ref(info_l2864,3),v2863);} else {var if_res1583 = false;}return if_res1583;});var prop_procedure_accessor = let_result1584.getAt(0);var procedure_accessor_p = let_result1584.getAt(1);var procedure_accessor_ref = let_result1584.getAt(2);var let_result1585 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),false,M0.list(M0.cons(M0.prop_procedure,M0.values),M0.cons(prop_procedure_accessor,M0.values)),true);var new_prop_procedure = let_result1585.getAt(0);var new_procedure_p = let_result1585.getAt(1);var new_procedure_ref = let_result1585.getAt(2);var let_result1586 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v2865) {return kpp_ref(v2865,0);})));var struct_keyword_procedure_impersonator = let_result1586.getAt(0);var make_kpp = let_result1586.getAt(1);var keyword_procedure_impersonator_p = let_result1586.getAt(2);var kpp_ref = let_result1586.getAt(3);var kpp_set_bang_ = let_result1586.getAt(4);var let_result1587 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v2866) {return kmp_ref(v2866,0);})));var struct_keyword_method_impersonator = let_result1587.getAt(0);var make_kmp = let_result1587.getAt(1);var keyword_method_impersonator_p = let_result1587.getAt(2);var kmp_ref = let_result1587.getAt(3);var kmp_set_bang_ = let_result1587.getAt(4);var let_result1588 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v2867) {return okpp_ref(v2867,0);})));var struct_okpp = let_result1588.getAt(0);var make_optional_keyword_procedure_impersonator = let_result1588.getAt(1);var okpp_p = let_result1588.getAt(2);var okpp_ref = let_result1588.getAt(3);var okpp_set_bang_ = let_result1588.getAt(4);var let_result1589 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v2868) {return okmp_ref(v2868,0);})));var struct_okmp = let_result1589.getAt(0);var make_optional_keyword_method_impersonator = let_result1589.getAt(1);var okmp_p = let_result1589.getAt(2);var okmp_ref = let_result1589.getAt(3);var okmp_set_bang_ = let_result1589.getAt(4);var let_result1590 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_by_arity_error = let_result1590.getAt(0);var make_kp_by_ae = let_result1590.getAt(1);var kp_by_ae_p = let_result1590.getAt(2);var kp_by_ae_ref = let_result1590.getAt(3);var kp_by_ae_set_bang_ = let_result1590.getAt(4);var let_result1591 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_by_arity_error = let_result1591.getAt(0);var make_km_by_ae = let_result1591.getAt(1);var km_by_ae_p = let_result1591.getAt(2);var km_by_ae_ref = let_result1591.getAt(3);var km_by_ae_set_bang_ = let_result1591.getAt(4);var let_result1592 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_impersonator_by_arity_error = let_result1592.getAt(0);var make_kpi_by_ae = let_result1592.getAt(1);var kpi_by_ae_p = let_result1592.getAt(2);var kpi_by_ae_ref = let_result1592.getAt(3);var kpi_by_ae_set_bang_ = let_result1592.getAt(4);var let_result1593 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_impersonator_by_arity_error = let_result1593.getAt(0);var make_kmi_by_ae = let_result1593.getAt(1);var kmi_by_ae_p = let_result1593.getAt(2);var kmi_by_ae_ref = let_result1593.getAt(3);var kmi_by_ae_set_bang_ = let_result1593.getAt(4);var make_required = function(name2869, fail_proc2870, method_p2871, impersonator_p2872) {var or_part2878 = name2869;if (or_part2878!==false) {var if_res1597 = or_part2878;} else {var if_res1597 = $rjs_core.PrimitiveSymbol.make("unknown");}if (impersonator_p2872!==false) {if (method_p2871!==false) {var if_res1594 = struct_keyword_method_impersonator_by_arity_error;} else {var if_res1594 = struct_keyword_procedure_impersonator_by_arity_error;}var if_res1596 = if_res1594;} else {if (method_p2871!==false) {var if_res1595 = struct_keyword_method_by_arity_error;} else {var if_res1595 = struct_keyword_procedure_by_arity_error;}var if_res1596 = if_res1595;}var let_result1598 = M0.make_struct_type(if_res1597,if_res1596,0,0,false,M0.list(M0.cons(prop_named_keyword_procedure,M0.cons(name2869,fail_proc2870))),M0.current_inspector(),fail_proc2870);var s_2873 = let_result1598.getAt(0);var mk2874 = let_result1598.getAt(1);var __p2875 = let_result1598.getAt(2);var __ref2876 = let_result1598.getAt(3);var __set_bang_2877 = let_result1598.getAt(4);return mk2874;};var cl1599 = function(proc2879) {var proc_name2880 = M0.object_name(proc2879);var plain_proc2881 = $rjs_core.attachProcedureArity(function(...args28821602) {var args2882 = $rjs_core.Pair.listFromArray(args28821602);return M0.apply(proc2879,M0.rnull,M0.rnull,args2882);});if (M0.symbol_p(proc_name2880)!==false) {var if_res1603 = M0.__rjs_quoted__.procedure_rename(plain_proc2881,proc_name2880);} else {var if_res1603 = plain_proc2881;}return make_keyword_procedure(proc2879,if_res1603);};var cl1600 = function(proc2883, plain_proc2884) {if (M0.procedure_p(proc2883)!==false) {var if_res1604 = M0.procedure_arity_mask(proc2883);} else {var if_res1604 = false;}return make_optional_keyword_procedure(make_keyword_checker(M0.rnull,false,if_res1604),proc2883,M0.rnull,false,plain_proc2884);};var make_keyword_procedure = $rjs_core.attachProcedureArity(function() {var fixed_lam1601 = {'1':cl1599,'2':cl1600}[arguments.length];if (fixed_lam1601!==undefined) {return fixed_lam1601.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var keyword_apply = $rjs_core.attachProcedureArity(function(proc2885, kws2886, kw_vals2887, normal_args2888, ...normal_argss28891605) {var normal_argss2889 = $rjs_core.Pair.listFromArray(normal_argss28891605);var type_error2890 = function(what2891, which2892) {return M0.apply(M0.raise_argument_error,$rjs_core.PrimitiveSymbol.make("keyword-apply"),what2891,which2892,proc2885,kws2886,kw_vals2887,normal_args2888,normal_argss2889);};if (M0.procedure_p(proc2885)!==false) {var if_res1606 = M0.rvoid();} else {var if_res1606 = type_error2890($rjs_core.UString.make("procedure?"),0);}if_res1606;var loop2893 = function(ks2894) {if (M0.null_p(ks2894)!==false) {var if_res1613 = M0.rvoid();} else {var or_part2895 = M0.not(M0.pair_p(ks2894));if (or_part2895!==false) {var if_res1607 = or_part2895;} else {var if_res1607 = M0.not(M0.keyword_p(M0.car(ks2894)));}if (if_res1607!==false) {var if_res1612 = type_error2890($rjs_core.UString.make("(listof keyword?)"),1);} else {if (M0.null_p(M0.cdr(ks2894))!==false) {var if_res1611 = M0.rvoid();} else {var or_part2896 = M0.not(M0.pair_p(M0.cdr(ks2894)));if (or_part2896!==false) {var if_res1608 = or_part2896;} else {var if_res1608 = M0.not(M0.keyword_p(M0.cadr(ks2894)));}if (if_res1608!==false) {var if_res1610 = loop2893(M0.cdr(ks2894));} else {if (M0.keyword_lt__p(M0.car(ks2894),M0.cadr(ks2894))!==false) {var if_res1609 = loop2893(M0.cdr(ks2894));} else {var if_res1609 = type_error2890($rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)"),1);}var if_res1610 = if_res1609;}var if_res1611 = if_res1610;}var if_res1612 = if_res1611;}var if_res1613 = if_res1612;}return if_res1613;};loop2893(kws2886);if (M0.list_p(kw_vals2887)!==false) {var if_res1614 = M0.rvoid();} else {var if_res1614 = type_error2890($rjs_core.UString.make("list?"),2);}if_res1614;if (M0.__eq_(M0.length(kws2886),M0.length(kw_vals2887))!==false) {var if_res1615 = M0.rvoid();} else {var if_res1615 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword-apply"),$rjs_core.UString.make("keyword list length does not match value list length"),$rjs_core.UString.make("keyword list length"),M0.length(kws2886),$rjs_core.UString.make("value list length"),M0.length(kw_vals2887),$rjs_core.UString.make("keyword list"),kws2886,$rjs_core.UString.make("value list"),kw_vals2887);}if_res1615;var loop2898 = function(normal_argss2899, pos2900) {if (M0.null_p(M0.cdr(normal_argss2899))!==false) {var l2901 = M0.car(normal_argss2899);if (M0.list_p(l2901)!==false) {var if_res1616 = l2901;} else {var if_res1616 = type_error2890($rjs_core.UString.make("list?"),pos2900);}var if_res1617 = if_res1616;} else {var if_res1617 = M0.cons(M0.car(normal_argss2899),loop2898(M0.cdr(normal_argss2899),M0.add1(pos2900)));}return if_res1617;};var normal_args2897 = loop2898(M0.cons(normal_args2888,normal_argss2889),3);if (M0.null_p(kws2886)!==false) {var if_res1618 = M0.apply(proc2885,normal_args2897);} else {var if_res1618 = M0.apply(keyword_procedure_extract_by_method(kws2886,2+M0.length(normal_args2897),proc2885,0),kws2886,kw_vals2887,normal_args2897);}return if_res1618;});var procedure_keywords = function(p2902) {if (keyword_procedure_p(p2902)!==false) {var if_res1623 = M0.values(keyword_procedure_required(p2902),keyword_procedure_allowed(p2902));} else {if (M0.procedure_p(p2902)!==false) {if (new_procedure_p(p2902)!==false) {var v2903 = new_procedure_ref(p2902);if (M0.procedure_p(v2903)!==false) {var if_res1620 = procedure_keywords(v2903);} else {var a2904 = procedure_accessor_ref(p2902);if (a2904!==false) {var if_res1619 = procedure_keywords(a2904(p2902));} else {var if_res1619 = M0.values(M0.rnull,M0.rnull);}var if_res1620 = if_res1619;}var if_res1621 = if_res1620;} else {var if_res1621 = M0.values(M0.rnull,M0.rnull);}var if_res1622 = if_res1621;} else {var if_res1622 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("procedure-keywords"),$rjs_core.UString.make("procedure?"),p2902);}var if_res1623 = if_res1622;}return if_res1623;};var missing_kw = $rjs_core.attachProcedureArity(function(proc2905, ...args29061624) {var args2906 = $rjs_core.Pair.listFromArray(args29061624);return M0.apply(keyword_procedure_extract_by_method(M0.rnull,0,proc2905,0),M0.rnull,M0.rnull,args2906);});var check_kw_args = function(p2907, kws2908) {var loop2909 = function(kws2910, required2911, allowed2912) {if (M0.null_p(kws2910)!==false) {if (M0.null_p(required2911)!==false) {var if_res1625 = M0.values(false,false);} else {var if_res1625 = M0.values(M0.car(required2911),false);}var if_res1634 = if_res1625;} else {if (M0.pair_p(required2911)!==false) {var if_res1626 = M0.eq_p(M0.car(required2911),M0.car(kws2910));} else {var if_res1626 = false;}if (if_res1626!==false) {var temp1629 = M0.cdr(kws2910);var temp1628 = M0.cdr(required2911);if (allowed2912!==false) {var if_res1627 = M0.cdr(allowed2912);} else {var if_res1627 = false;}var if_res1633 = loop2909(temp1629,temp1628,if_res1627);} else {if (M0.not(allowed2912)!==false) {var if_res1632 = loop2909(M0.cdr(kws2910),required2911,false);} else {if (M0.pair_p(allowed2912)!==false) {if (M0.eq_p(M0.car(allowed2912),M0.car(kws2910))!==false) {var if_res1630 = loop2909(M0.cdr(kws2910),required2911,M0.cdr(allowed2912));} else {var if_res1630 = loop2909(kws2910,required2911,M0.cdr(allowed2912));}var if_res1631 = if_res1630;} else {var if_res1631 = M0.values(false,M0.car(kws2910));}var if_res1632 = if_res1631;}var if_res1633 = if_res1632;}var if_res1634 = if_res1633;}return if_res1634;};return loop2909(kws2908,keyword_procedure_required(p2907),keyword_procedure_allowed(p2907));};var make_keyword_checker = function(req_kws2913, allowed_kws2914, arity_mask2915) {if (M0.not(allowed_kws2914)!==false) {if (M0.null_p(req_kws2913)!==false) {var if_res1637 = function(kws2916, a2917) {if (true!==false) {var if_res1635 = M0.bitwise_bit_set_p(arity_mask2915,a2917);} else {var if_res1635 = false;}return if_res1635;};} else {var if_res1637 = function(kws2918, a2919) {if (subset_p(req_kws2913,kws2918)!==false) {var if_res1636 = M0.bitwise_bit_set_p(arity_mask2915,a2919);} else {var if_res1636 = false;}return if_res1636;};}var if_res1650 = if_res1637;} else {if (M0.null_p(allowed_kws2914)!==false) {var if_res1649 = function(kws2920, a2921) {if (M0.null_p(kws2920)!==false) {var if_res1638 = M0.bitwise_bit_set_p(arity_mask2915,a2921);} else {var if_res1638 = false;}return if_res1638;};} else {if (M0.null_p(req_kws2913)!==false) {var if_res1648 = function(kws2922, a2923) {if (subset_p(kws2922,allowed_kws2914)!==false) {var if_res1639 = M0.bitwise_bit_set_p(arity_mask2915,a2923);} else {var if_res1639 = false;}return if_res1639;};} else {if (M0.list_p(req_kws2913)!==false) {if (M0.list_p(allowed_kws2914)!==false) {var if_res1640 = M0.eq_p(M0.length(req_kws2913),M0.length(allowed_kws2914));} else {var if_res1640 = false;}var if_res1641 = if_res1640;} else {var if_res1641 = false;}if (if_res1641!==false) {var if_res1647 = function(kws2924, a2925) {var loop2926 = function(kws2927, req_kws2928) {if (M0.null_p(req_kws2928)!==false) {var if_res1644 = M0.null_p(kws2927);} else {if (M0.null_p(kws2927)!==false) {var if_res1643 = false;} else {if (M0.eq_p(M0.car(kws2927),M0.car(req_kws2928))!==false) {var if_res1642 = loop2926(M0.cdr(kws2927),M0.cdr(req_kws2928));} else {var if_res1642 = false;}var if_res1643 = if_res1642;}var if_res1644 = if_res1643;}return if_res1644;};if (loop2926(kws2924,req_kws2913)!==false) {var if_res1645 = M0.bitwise_bit_set_p(arity_mask2915,a2925);} else {var if_res1645 = false;}return if_res1645;};} else {var if_res1647 = function(kws2929, a2930) {if (subsets_p(req_kws2913,kws2929,allowed_kws2914)!==false) {var if_res1646 = M0.bitwise_bit_set_p(arity_mask2915,a2930);} else {var if_res1646 = false;}return if_res1646;};}var if_res1648 = if_res1647;}var if_res1649 = if_res1648;}var if_res1650 = if_res1649;}return if_res1650;};var subset_p = function(l12931, l22932) {if (M0.null_p(l12931)!==false) {var if_res1653 = true;} else {if (M0.null_p(l22932)!==false) {var if_res1652 = false;} else {if (M0.eq_p(M0.car(l12931),M0.car(l22932))!==false) {var if_res1651 = subset_p(M0.cdr(l12931),M0.cdr(l22932));} else {var if_res1651 = subset_p(l12931,M0.cdr(l22932));}var if_res1652 = if_res1651;}var if_res1653 = if_res1652;}return if_res1653;};var subsets_p = function(l12933, l22934, l32935) {if (M0.null_p(l12933)!==false) {var if_res1658 = subset_p(l22934,l32935);} else {if (M0.null_p(l22934)!==false) {var if_res1657 = false;} else {if (M0.null_p(l32935)!==false) {var if_res1656 = false;} else {var v22936 = M0.car(l22934);if (M0.eq_p(M0.car(l12933),v22936)!==false) {var if_res1655 = subsets_p(M0.cdr(l12933),M0.cdr(l22934),M0.cdr(l32935));} else {if (M0.eq_p(v22936,M0.car(l32935))!==false) {var if_res1654 = subsets_p(l12933,M0.cdr(l22934),M0.cdr(l32935));} else {var if_res1654 = subsets_p(l12933,l22934,M0.cdr(l32935));}var if_res1655 = if_res1654;}var if_res1656 = if_res1655;}var if_res1657 = if_res1656;}var if_res1658 = if_res1657;}return if_res1658;};var keyword_procedure_extract_by_method = function(kws2937, n2938, p2939, method_n2940) {if (keyword_procedure_p(p2939)!==false) {var if_res1659 = keyword_procedure_checker(p2939)(kws2937,n2938);} else {var if_res1659 = false;}if (if_res1659!==false) {var if_res1689 = keyword_procedure_proc(p2939);} else {if (M0.not(keyword_procedure_p(p2939))!==false) {if (M0.procedure_p(p2939)!==false) {if (new_procedure_p(p2939)!==false) {var a2943 = procedure_accessor_ref(p2939);if (a2943!==false) {var if_res1660 = a2943(p2939);} else {var if_res1660 = false;}var if_res1661 = if_res1660;} else {var if_res1661 = false;}var or_part2942 = if_res1661;if (or_part2942!==false) {var if_res1664 = or_part2942;} else {var or_part2944 = M0.procedure_extract_target(p2939);if (or_part2944!==false) {var if_res1663 = or_part2944;} else {if (new_procedure_p(p2939)!==false) {var if_res1662 = $rjs_core.PrimitiveSymbol.make("method");} else {var if_res1662 = false;}var if_res1663 = if_res1662;}var if_res1664 = if_res1663;}var if_res1665 = if_res1664;} else {var if_res1665 = false;}var if_res1666 = if_res1665;} else {var if_res1666 = false;}var p22941 = if_res1666;if (p22941!==false) {if (M0.eq_p(p22941,$rjs_core.PrimitiveSymbol.make("method"))!==false) {var p32945 = keyword_procedure_extract_by_method(kws2937,M0.add1(n2938),new_procedure_ref(p2939),M0.add1(method_n2940));var if_res1668 = $rjs_core.attachProcedureArity(function(kws2946, kw_args2947, ...args29481667) {var args2948 = $rjs_core.Pair.listFromArray(args29481667);return M0.apply(p32945,kws2946,kw_args2947,M0.cons(p2939,args2948));});} else {var if_res1668 = keyword_procedure_extract_by_method(kws2937,n2938,p22941,method_n2940);}var if_res1688 = if_res1668;} else {var if_res1688 = $rjs_core.attachProcedureArity(function(kws2949, kw_args2950, ...args29511669) {var args2951 = $rjs_core.Pair.listFromArray(args29511669);if (keyword_procedure_p(p2939)!==false) {var if_res1670 = check_kw_args(p2939,kws2949);} else {var if_res1670 = M0.values(false,M0.car(kws2949));}var let_result1671 = if_res1670;var missing_kw2952 = let_result1671.getAt(0);var extra_kw2953 = let_result1671.getAt(1);var or_part2958 = keyword_method_p(p2939);if (or_part2958!==false) {var if_res1672 = or_part2958;} else {var if_res1672 = okm_p(p2939);}if (if_res1672!==false) {var if_res1673 = 1;} else {var if_res1673 = 0;}var method_n2957 = method_n2940+if_res1673;if (M0.__gt__eq_(n2938,method_n2957)!==false) {var if_res1674 = n2938-method_n2957;} else {var if_res1674 = n2938;}var n2954 = if_res1674;if (M0.null_p(args2951)!==false) {var if_res1675 = M0.null_p(kws2949);} else {var if_res1675 = false;}if (if_res1675!==false) {var if_res1676 = $rjs_core.UString.make("");} else {var if_res1676 = M0.apply(M0.string_append,$rjs_core.UString.make("\n  arguments...:"),M0.append(M0.map(function(v2959) {return M0.format($rjs_core.UString.make("\n   ~e"),v2959);},args2951),M0.map(function(kw2960, kw_arg2961) {return M0.format($rjs_core.UString.make("\n   ~a ~e"),kw2960,kw_arg2961);},kws2949,kw_args2950)));}var args_str2955 = if_res1676;var proc_name2956 = function(p2962) {if (named_keyword_procedure_p(p2962)!==false) {var if_res1677 = M0.car(keyword_procedure_name_plus_fail(p2962));} else {var if_res1677 = false;}var or_part2963 = if_res1677;if (or_part2963!==false) {var if_res1679 = or_part2963;} else {var or_part2964 = M0.object_name(p2962);if (or_part2964!==false) {var if_res1678 = or_part2964;} else {var if_res1678 = p2962;}var if_res1679 = if_res1678;}return if_res1679;};var or_part2965 = extra_kw2953;if (or_part2965!==false) {var if_res1686 = or_part2965;} else {var if_res1686 = missing_kw2952;}if (if_res1686!==false) {var if_res1687 = M0.__rjs_quoted__.exn_fail_contract;} else {var if_res1687 = M0.__rjs_quoted__.exn_fail_contract_arity;}if (extra_kw2953!==false) {if (keyword_procedure_p(p2939)!==false) {var if_res1681 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not expect an argument with given keyword\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  given keyword: ~a"),$rjs_core.UString.make("~a")),proc_name2956(p2939),extra_kw2953,args_str2955);} else {if (M0.procedure_p(p2939)!==false) {var if_res1680 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not accept keyword arguments\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a")),proc_name2956(p2939),args_str2955);} else {var if_res1680 = M0.format(M0.string_append($rjs_core.UString.make("application: not a procedure;\n"),$rjs_core.UString.make(" expected a procedure that can be applied to arguments\n"),$rjs_core.UString.make("  given: ~e"),$rjs_core.UString.make("~a")),p2939,args_str2955);}var if_res1681 = if_res1680;}var if_res1685 = if_res1681;} else {if (missing_kw2952!==false) {var if_res1684 = M0.format(M0.string_append($rjs_core.UString.make("application: required keyword argument not supplied\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  required keyword: ~a"),$rjs_core.UString.make("~a")),proc_name2956(p2939),missing_kw2952,args_str2955);} else {var temp1683 = M0.string_append($rjs_core.UString.make("application: no case matching ~a non-keyword argument~a\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a"));if (M0.__eq_(1,n2954-2)!==false) {var if_res1682 = $rjs_core.UString.make("");} else {var if_res1682 = $rjs_core.UString.make("s");}var if_res1684 = M0.format(temp1683,n2954-2,if_res1682,proc_name2956(p2939),args_str2955);}var if_res1685 = if_res1684;}return M0.raise(if_res1687(if_res1685,M0.current_continuation_marks()));});}var if_res1689 = if_res1688;}return if_res1689;};var keyword_procedure_extract = function(p2966, kws2967, n2968) {return keyword_procedure_extract_by_method(kws2967,n2968,p2966,0);};var cl1690 = function(proc2969, arity2970, req_kw2971, allowed_kw2972, name2973) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc2969,arity2970,false,name2973,req_kw2971,allowed_kw2972);};var cl1691 = function(proc2974, arity2975, req_kw2976, allowed_kw2977) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc2974,arity2975,false,false,req_kw2976,allowed_kw2977);};var procedure_reduce_keyword_arity = $rjs_core.attachProcedureArity(function() {var fixed_lam1692 = {'5':cl1690,'4':cl1691}[arguments.length];if (fixed_lam1692!==undefined) {return fixed_lam1692.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var cl1693 = function(proc2978, mask2979, req_kw2980, allowed_kw2981, name2982) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc2978,false,mask2979,name2982,req_kw2980,allowed_kw2981);};var cl1694 = function(proc2983, mask2984, req_kw2985, allowed_kw2986) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc2983,false,mask2984,false,req_kw2985,allowed_kw2986);};var procedure_reduce_keyword_arity_mask = $rjs_core.attachProcedureArity(function() {var fixed_lam1695 = {'5':cl1693,'4':cl1694}[arguments.length];if (fixed_lam1695!==undefined) {return fixed_lam1695.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var do_procedure_reduce_keyword_arity = function(who2987, proc2988, arity2989, mask2990, name2991, req_kw2992, allowed_kw2993) {if (okp_p(proc2988)!==false) {var if_res1696 = okp_ref(proc2988,0);} else {var if_res1696 = proc2988;}var p2995 = if_res1696;if (arity2989!==false) {var if_res1697 = M0.__rjs_quoted__.procedure_reduce_arity(p2995,arity2989);} else {var if_res1697 = M0.__rjs_quoted__.procedure_reduce_arity_mask(p2995,mask2990,name2991);}var plain_proc2994 = if_res1697;var sorted_p2996 = function(kws2997) {var loop2998 = function(kws2999) {if (M0.null_p(kws2999)!==false) {var if_res1700 = true;} else {if (M0.null_p(M0.cdr(kws2999))!==false) {var if_res1699 = true;} else {if (M0.keyword_lt__p(M0.car(kws2999),M0.cadr(kws2999))!==false) {var if_res1698 = loop2998(M0.cdr(kws2999));} else {var if_res1698 = false;}var if_res1699 = if_res1698;}var if_res1700 = if_res1699;}return if_res1700;};return loop2998(kws2997);};if (M0.list_p(req_kw2992)!==false) {if (M0.andmap(M0.keyword_p,req_kw2992)!==false) {var if_res1701 = sorted_p2996(req_kw2992);} else {var if_res1701 = false;}var if_res1702 = if_res1701;} else {var if_res1702 = false;}if (if_res1702!==false) {var if_res1705 = M0.rvoid();} else {var temp1704 = $rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)");var or_part3000 = arity2989;if (or_part3000!==false) {var if_res1703 = or_part3000;} else {var if_res1703 = mask2990;}var if_res1705 = M0.raise_argument_error(who2987,temp1704,2,proc2988,if_res1703,req_kw2992,allowed_kw2993);}if_res1705;if (allowed_kw2993!==false) {if (M0.list_p(allowed_kw2993)!==false) {if (M0.andmap(M0.keyword_p,allowed_kw2993)!==false) {var if_res1706 = sorted_p2996(allowed_kw2993);} else {var if_res1706 = false;}var if_res1707 = if_res1706;} else {var if_res1707 = false;}if (if_res1707!==false) {var if_res1710 = M0.rvoid();} else {var temp1709 = $rjs_core.UString.make("(or/c (and/c (listof? keyword?) sorted? distinct?) #f)");var or_part3001 = arity2989;if (or_part3001!==false) {var if_res1708 = or_part3001;} else {var if_res1708 = mask2990;}var if_res1710 = M0.raise_argument_error(who2987,temp1709,3,proc2988,if_res1708,req_kw2992,allowed_kw2993);}if_res1710;if (subset_p(req_kw2992,allowed_kw2993)!==false) {var if_res1711 = M0.rvoid();} else {var if_res1711 = M0.raise_arguments_error(who2987,$rjs_core.UString.make("allowed-keyword list does not include all required keywords"),$rjs_core.UString.make("allowed-keyword list"),allowed_kw2993,$rjs_core.UString.make("required keywords"),req_kw2992);}var if_res1712 = if_res1711;} else {var if_res1712 = M0.rvoid();}if_res1712;var let_result1713 = procedure_keywords(proc2988);var old_req3002 = let_result1713.getAt(0);var old_allowed3003 = let_result1713.getAt(1);if (subset_p(old_req3002,req_kw2992)!==false) {var if_res1714 = M0.rvoid();} else {var if_res1714 = M0.raise_arguments_error(who2987,$rjs_core.UString.make("cannot reduce required keyword set"),$rjs_core.UString.make("required keywords"),old_req3002,$rjs_core.UString.make("requested required keywords"),req_kw2992);}if_res1714;if (old_allowed3003!==false) {if (subset_p(req_kw2992,old_allowed3003)!==false) {var if_res1715 = M0.rvoid();} else {var if_res1715 = M0.raise_arguments_error(who2987,$rjs_core.UString.make("cannot require keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed3003,$rjs_core.UString.make("requested required keywords"),req_kw2992);}if_res1715;var or_part3004 = M0.not(allowed_kw2993);if (or_part3004!==false) {var if_res1716 = or_part3004;} else {var if_res1716 = subset_p(allowed_kw2993,old_allowed3003);}if (if_res1716!==false) {var if_res1717 = M0.rvoid();} else {var if_res1717 = M0.raise_arguments_error(who2987,$rjs_core.UString.make("cannot allow keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed3003,$rjs_core.UString.make("requested allowed keywords"),allowed_kw2993);}var if_res1718 = if_res1717;} else {var if_res1718 = M0.rvoid();}if_res1718;if (M0.null_p(allowed_kw2993)!==false) {var if_res1726 = plain_proc2994;} else {var or_part3006 = mask2990;if (or_part3006!==false) {var if_res1719 = or_part3006;} else {var if_res1719 = arity__gt_mask(arity2989);}var mask3005 = if_res1719;var new_mask3007 = M0.arithmetic_shift(mask3005,2);var kw_checker3008 = make_keyword_checker(req_kw2992,allowed_kw2993,new_mask3007);var proc3009 = normalize_proc(proc2988);var new_kw_proc3010 = M0.__rjs_quoted__.procedure_reduce_arity_mask(keyword_procedure_proc(proc3009),new_mask3007);if (M0.null_p(req_kw2992)!==false) {if (okm_p(proc3009)!==false) {var if_res1720 = make_optional_keyword_method;} else {var if_res1720 = make_optional_keyword_procedure;}var if_res1725 = if_res1720(kw_checker3008,new_kw_proc3010,req_kw2992,allowed_kw2993,plain_proc2994);} else {if (named_keyword_procedure_p(proc3009)!==false) {var if_res1723 = M0.car(keyword_procedure_name_plus_fail(proc3009));} else {var if_res1723 = false;}var or_part3011 = if_res1723;if (or_part3011!==false) {var if_res1724 = or_part3011;} else {var if_res1724 = M0.object_name(proc3009);}var temp1722 = M0.__rjs_quoted__.procedure_reduce_arity_mask(missing_kw,M0.arithmetic_shift(mask3005,1));var or_part3012 = okm_p(proc3009);if (or_part3012!==false) {var if_res1721 = or_part3012;} else {var if_res1721 = keyword_method_p(proc3009);}var if_res1725 = make_required(if_res1724,temp1722,if_res1721,false)(kw_checker3008,new_kw_proc3010,req_kw2992,allowed_kw2993);}var if_res1726 = if_res1725;}return if_res1726;};var arity__gt_mask = function(a3013) {if (M0.exact_nonnegative_integer_p(a3013)!==false) {var if_res1732 = M0.arithmetic_shift(1,a3013);} else {if (M0.arity_at_least_p(a3013)!==false) {var if_res1731 = M0.bitwise_xor(-1,M0.sub1(M0.arithmetic_shift(1,M0.arity_at_least_value(a3013))));} else {if (M0.list_p(a3013)!==false) {var loop3014 = function(mask3015, l3016) {if (M0.null_p(l3016)!==false) {var if_res1729 = mask3015;} else {var a3017 = M0.car(l3016);var or_part3018 = M0.exact_nonnegative_integer_p(a3017);if (or_part3018!==false) {var if_res1727 = or_part3018;} else {var if_res1727 = M0.arity_at_least_p(a3017);}if (if_res1727!==false) {var if_res1728 = loop3014(M0.bitwise_ior(mask3015,arity__gt_mask(a3017)),M0.cdr(l3016));} else {var if_res1728 = false;}var if_res1729 = if_res1728;}return if_res1729;};var if_res1730 = loop3014(0,a3013);} else {var if_res1730 = false;}var if_res1731 = if_res1730;}var if_res1732 = if_res1731;}return if_res1732;};var cl1733 = function(proc3020, arity3021, name3022) {if (M0.procedure_p(proc3020)!==false) {var let_result1736 = procedure_keywords(proc3020);var req3023 = let_result1736.getAt(0);var allows3024 = let_result1736.getAt(1);if (M0.pair_p(req3023)!==false) {var if_res1737 = M0.not(M0.null_p(arity3021));} else {var if_res1737 = false;}var if_res1738 = if_res1737;} else {var if_res1738 = false;}if (if_res1738!==false) {var if_res1740 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc3020);} else {if (okm_p(proc3020)!==false) {var if_res1739 = M0.__rjs_quoted__.procedure__gt_method(proc3020);} else {var if_res1739 = proc3020;}var if_res1740 = M0.__rjs_quoted__.procedure_reduce_arity(if_res1739,arity3021,name3022);}return if_res1740;};var cl1734 = function(proc3025, arity3026) {return new_procedure_reduce_arity(proc3025,arity3026,false);};var procedure_reduce_arity3019 = $rjs_core.attachProcedureArity(function() {var fixed_lam1735 = {'3':cl1733,'2':cl1734}[arguments.length];if (fixed_lam1735!==undefined) {return fixed_lam1735.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity = procedure_reduce_arity3019;var cl1741 = function(proc3028, mask3029, name3030) {if (M0.procedure_p(proc3028)!==false) {var let_result1744 = procedure_keywords(proc3028);var req3031 = let_result1744.getAt(0);var allows3032 = let_result1744.getAt(1);if (M0.pair_p(req3031)!==false) {var if_res1745 = M0.not(M0.eqv_p(mask3029,0));} else {var if_res1745 = false;}var if_res1746 = if_res1745;} else {var if_res1746 = false;}if (if_res1746!==false) {var if_res1748 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc3028);} else {if (okm_p(proc3028)!==false) {var if_res1747 = M0.__rjs_quoted__.procedure__gt_method(proc3028);} else {var if_res1747 = proc3028;}var if_res1748 = M0.__rjs_quoted__.procedure_reduce_arity_mask(if_res1747,mask3029,name3030);}return if_res1748;};var cl1742 = function(proc3033, mask3034) {return new_procedure_reduce_arity_mask(proc3033,mask3034,false);};var procedure_reduce_arity3027 = $rjs_core.attachProcedureArity(function() {var fixed_lam1743 = {'3':cl1741,'2':cl1742}[arguments.length];if (fixed_lam1743!==undefined) {return fixed_lam1743.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity_mask = procedure_reduce_arity3027;var procedure__gt_method3035 = function(proc3036) {var proc3037 = normalize_proc(proc3036);if (keyword_procedure_p(proc3037)!==false) {if (okm_p(proc3037)!==false) {var if_res1751 = proc3037;} else {if (keyword_method_p(proc3037)!==false) {var if_res1750 = proc3037;} else {if (okp_p(proc3037)!==false) {var if_res1749 = make_optional_keyword_method(keyword_procedure_checker(proc3037),keyword_procedure_proc(proc3037),keyword_procedure_required(proc3037),keyword_procedure_allowed(proc3037),okp_ref(proc3037,0));} else {var name_plus_fail3038 = keyword_procedure_name_plus_fail(proc3037);var mk3039 = make_required(M0.car(name_plus_fail3038),M0.cdr(name_plus_fail3038),true,false);var if_res1749 = mk3039(keyword_procedure_checker(proc3037),keyword_procedure_proc(proc3037),keyword_procedure_required(proc3037),keyword_procedure_allowed(proc3037));}var if_res1750 = if_res1749;}var if_res1751 = if_res1750;}var if_res1752 = if_res1751;} else {var if_res1752 = M0.__rjs_quoted__.procedure__gt_method(proc3037);}return if_res1752;};var new_procedure__gt_method = procedure__gt_method3035;var procedure_rename3040 = function(proc3041, name3042) {if (keyword_procedure_p(proc3041)!==false) {var if_res1753 = M0.symbol_p(name3042);} else {var if_res1753 = false;}if (M0.not(if_res1753)!==false) {var if_res1756 = M0.__rjs_quoted__.procedure_rename(proc3041,name3042);} else {if (okp_p(proc3041)!==false) {if (okm_p(proc3041)!==false) {var if_res1754 = make_optional_keyword_method;} else {var if_res1754 = make_optional_keyword_procedure;}var if_res1755 = if_res1754(keyword_procedure_checker(proc3041),keyword_procedure_proc(proc3041),keyword_procedure_required(proc3041),keyword_procedure_allowed(proc3041),M0.__rjs_quoted__.procedure_rename(okp_ref(proc3041,0),name3042));} else {var name_plus_fail3043 = keyword_procedure_name_plus_fail(proc3041);var mk3044 = make_required(name3042,M0.cdr(name_plus_fail3043),keyword_method_p(proc3041),false);var if_res1755 = mk3044(keyword_procedure_checker(proc3041),keyword_procedure_proc(proc3041),keyword_procedure_required(proc3041),keyword_procedure_allowed(proc3041));}var if_res1756 = if_res1755;}return if_res1756;};var new_procedure_rename = procedure_rename3040;var chaperone_procedure3045 = $rjs_core.attachProcedureArity(function(proc3046, wrap_proc3047, ...props30481757) {var props3048 = $rjs_core.Pair.listFromArray(props30481757);return do_chaperone_procedure(false,false,M0.__rjs_quoted__.chaperone_procedure,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc3046,wrap_proc3047,props3048);});var new_chaperone_procedure = chaperone_procedure3045;var unsafe_chaperone_procedure3049 = $rjs_core.attachProcedureArity(function(proc3050, wrap_proc3051, ...props30521758) {var props3052 = $rjs_core.Pair.listFromArray(props30521758);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_chaperone_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-chaperone-procedure"),proc3050,wrap_proc3051,props3052);});var new_unsafe_chaperone_procedure = unsafe_chaperone_procedure3049;var impersonate_procedure3053 = $rjs_core.attachProcedureArity(function(proc3054, wrap_proc3055, ...props30561759) {var props3056 = $rjs_core.Pair.listFromArray(props30561759);return do_chaperone_procedure(true,false,M0.__rjs_quoted__.impersonate_procedure,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc3054,wrap_proc3055,props3056);});var new_impersonate_procedure = impersonate_procedure3053;var unsafe_impersonate_procedure3057 = $rjs_core.attachProcedureArity(function(proc3058, wrap_proc3059, ...props30601760) {var props3060 = $rjs_core.Pair.listFromArray(props30601760);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_impersonate_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-impersonate-procedure"),proc3058,wrap_proc3059,props3060);});var new_unsafe_impersonate_procedure = unsafe_impersonate_procedure3057;var chaperone_procedure_times_3061 = $rjs_core.attachProcedureArity(function(proc3062, wrap_proc3063, ...props30641761) {var props3064 = $rjs_core.Pair.listFromArray(props30641761);return do_chaperone_procedure(false,true,M0.__rjs_quoted__.chaperone_procedure_times_,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc3062,wrap_proc3063,props3064);});var new_chaperone_procedure_times_ = chaperone_procedure_times_3061;var impersonate_procedure_times_3065 = $rjs_core.attachProcedureArity(function(proc3066, wrap_proc3067, ...props30681762) {var props3068 = $rjs_core.Pair.listFromArray(props30681762);return do_chaperone_procedure(true,true,M0.__rjs_quoted__.impersonate_procedure_times_,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc3066,wrap_proc3067,props3068);});var new_impersonate_procedure_times_ = impersonate_procedure_times_3065;var do_chaperone_procedure = function(is_impersonator_p3069, self_arg_p3070, chaperone_procedure3071, name3072, proc3073, wrap_proc3074, props3075) {var n_proc3076 = normalize_proc(proc3073);var n_wrap_proc3077 = normalize_proc(wrap_proc3074);var or_part3078 = M0.not(keyword_procedure_p(n_proc3076));if (or_part3078!==false) {var if_res1764 = or_part3078;} else {var or_part3079 = M0.not(M0.procedure_p(wrap_proc3074));if (or_part3079!==false) {var if_res1763 = or_part3079;} else {var if_res1763 = bad_props_p(props3075);}var if_res1764 = if_res1763;}if (if_res1764!==false) {var if_res1831 = M0.apply(chaperone_procedure3071,proc3073,wrap_proc3074,props3075);} else {chaperone_arity_match_checking(self_arg_p3070,name3072,proc3073,wrap_proc3074,props3075);var loop3081 = function(props3082) {if (M0.null_p(props3082)!==false) {var if_res1766 = false;} else {if (M0.eq_p(M0.car(props3082),M0.__rjs_quoted__.impersonator_prop_application_mark)!==false) {var if_res1765 = M0.cadr(props3082);} else {var if_res1765 = loop3081(M0.cddr(props3082));}var if_res1766 = if_res1765;}return if_res1766;};var mark_prop3080 = loop3081(props3075);var chaperone_procedure_by_add_mark3083 = function(proc3084, wrap_proc3085) {if (mark_prop3080!==false) {var if_res1767 = chaperone_procedure3071(proc3084,wrap_proc3085,M0.__rjs_quoted__.impersonator_prop_application_mark,mark_prop3080);} else {var if_res1767 = chaperone_procedure3071(proc3084,wrap_proc3085);}return if_res1767;};var p3087 = keyword_procedure_proc(n_wrap_proc3077);if (self_arg_p3070!==false) {var cl1768 = $rjs_core.attachProcedureArity(function(self_proc3088, kws3089, args3090, ...rest30911773) {var rest3091 = $rjs_core.Pair.listFromArray(rest30911773);return M0.call_with_values(function() {return M0.apply(p3087,kws3089,args3090,self_proc3088,rest3091);},$rjs_core.attachProcedureArity(function(...results30921774) {var results3092 = $rjs_core.Pair.listFromArray(results30921774);var len3093 = M0.length(results3092);var alen3094 = M0.length(rest3091);if (M0.__lt_(len3093,alen3094+1)!==false) {var if_res1775 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen3094+1,$rjs_core.UString.make("received number of results"),len3093,$rjs_core.UString.make("wrapper procedure"),wrap_proc3074);} else {var if_res1775 = M0.rvoid();}if_res1775;var num_extra3095 = len3093-(alen3094+1);var new_args3096 = M0.list_ref(results3092,num_extra3095);if (M0.list_p(new_args3096)!==false) {var if_res1776 = M0.__eq_(M0.length(new_args3096),M0.length(args3090));} else {var if_res1776 = false;}if (if_res1776!==false) {var if_res1780 = M0.rvoid();} else {var temp1779 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp1778 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len3093,alen3094)!==false) {var if_res1777 = $rjs_core.UString.make("");} else {var if_res1777 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res1780 = M0.raise_arguments_error(temp1779,M0.format(temp1778,if_res1777),$rjs_core.UString.make("first result"),new_args3096,$rjs_core.UString.make("wrapper procedure"),wrap_proc3074);}if_res1780;M0.for_each(function(kw3097, new_arg3098, arg3099) {if (is_impersonator_p3069!==false) {var if_res1782 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg3098,arg3099)!==false) {var if_res1781 = M0.rvoid();} else {var if_res1781 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw3097),$rjs_core.UString.make("result"),new_arg3098,$rjs_core.UString.make("wrapper procedure"),wrap_proc3074);}var if_res1782 = if_res1781;}return if_res1782;},kws3089,new_args3096,args3090);var tmp3100 = num_extra3095;if (M0.equal_p(tmp3100,0)!==false) {var if_res1785 = M0.apply(M0.values,kws3089,results3092);} else {if (M0.equal_p(tmp3100,1)!==false) {var if_res1784 = M0.apply(M0.values,M0.car(results3092),kws3089,M0.cdr(results3092));} else {var loop3101 = function(results3102, c3103) {if (M0.zero_p(c3103)!==false) {var if_res1783 = M0.cons(kws3089,results3102);} else {var if_res1783 = M0.cons(M0.car(results3102),loop3101(M0.cdr(results3102),M0.sub1(c3103)));}return if_res1783;};var if_res1784 = M0.apply(M0.values,loop3101(results3092,num_extra3095));}var if_res1785 = if_res1784;}return if_res1785;}));});var cl1769 = $rjs_core.attachProcedureArity(function(...other31041786) {var other3104 = $rjs_core.Pair.listFromArray(other31041786);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res1806 = $rjs_core.attachProcedureArity(function() {var fixed_lam1770 = {}[arguments.length];if (fixed_lam1770!==undefined) {return fixed_lam1770.apply(null,arguments);} else {if (M0.__gt__eq_(cl1768.length,1)!==false) {var if_res1772 = cl1768.apply(null,arguments);} else {if (true!==false) {var if_res1771 = cl1769.apply(null,arguments);} else {var if_res1771 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res1772 = if_res1771;}return if_res1772;}},[M0.make_arity_at_least(0)]);} else {var cl1787 = $rjs_core.attachProcedureArity(function(kws3105, args3106, ...rest31071792) {var rest3107 = $rjs_core.Pair.listFromArray(rest31071792);return M0.call_with_values(function() {return M0.apply(p3087,kws3105,args3106,rest3107);},$rjs_core.attachProcedureArity(function(...results31081793) {var results3108 = $rjs_core.Pair.listFromArray(results31081793);var len3109 = M0.length(results3108);var alen3110 = M0.length(rest3107);if (M0.__lt_(len3109,alen3110+1)!==false) {var if_res1794 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen3110+1,$rjs_core.UString.make("received number of results"),len3109,$rjs_core.UString.make("wrapper procedure"),wrap_proc3074);} else {var if_res1794 = M0.rvoid();}if_res1794;var num_extra3111 = len3109-(alen3110+1);var new_args3112 = M0.list_ref(results3108,num_extra3111);if (M0.list_p(new_args3112)!==false) {var if_res1795 = M0.__eq_(M0.length(new_args3112),M0.length(args3106));} else {var if_res1795 = false;}if (if_res1795!==false) {var if_res1799 = M0.rvoid();} else {var temp1798 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp1797 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len3109,alen3110)!==false) {var if_res1796 = $rjs_core.UString.make("");} else {var if_res1796 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res1799 = M0.raise_arguments_error(temp1798,M0.format(temp1797,if_res1796),$rjs_core.UString.make("first result"),new_args3112,$rjs_core.UString.make("wrapper procedure"),wrap_proc3074);}if_res1799;M0.for_each(function(kw3113, new_arg3114, arg3115) {if (is_impersonator_p3069!==false) {var if_res1801 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg3114,arg3115)!==false) {var if_res1800 = M0.rvoid();} else {var if_res1800 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw3113),$rjs_core.UString.make("result"),new_arg3114,$rjs_core.UString.make("wrapper procedure"),wrap_proc3074);}var if_res1801 = if_res1800;}return if_res1801;},kws3105,new_args3112,args3106);var tmp3116 = num_extra3111;if (M0.equal_p(tmp3116,0)!==false) {var if_res1804 = M0.apply(M0.values,kws3105,results3108);} else {if (M0.equal_p(tmp3116,1)!==false) {var if_res1803 = M0.apply(M0.values,M0.car(results3108),kws3105,M0.cdr(results3108));} else {var loop3117 = function(results3118, c3119) {if (M0.zero_p(c3119)!==false) {var if_res1802 = M0.cons(kws3105,results3118);} else {var if_res1802 = M0.cons(M0.car(results3118),loop3117(M0.cdr(results3118),M0.sub1(c3119)));}return if_res1802;};var if_res1803 = M0.apply(M0.values,loop3117(results3108,num_extra3111));}var if_res1804 = if_res1803;}return if_res1804;}));});var cl1788 = $rjs_core.attachProcedureArity(function(...other31201805) {var other3120 = $rjs_core.Pair.listFromArray(other31201805);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res1806 = $rjs_core.attachProcedureArity(function() {var fixed_lam1789 = {}[arguments.length];if (fixed_lam1789!==undefined) {return fixed_lam1789.apply(null,arguments);} else {if (M0.__gt__eq_(cl1787.length,1)!==false) {var if_res1791 = cl1787.apply(null,arguments);} else {if (true!==false) {var if_res1790 = cl1788.apply(null,arguments);} else {var if_res1790 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res1791 = if_res1790;}return if_res1791;}},[M0.make_arity_at_least(0)]);}var kw_chaperone3086 = if_res1806;var wrap3123 = function(proc3124, n_proc3125) {if (M0.not(M0.eq_p(n_proc3125,proc3124))!==false) {var if_res1807 = new_procedure_p(proc3124);} else {var if_res1807 = false;}if (if_res1807!==false) {var v3126 = new_procedure_ref(proc3124);if (M0.exact_integer_p(v3126)!==false) {var acc3127 = procedure_accessor_ref(proc3124);var if_res1823 = M0.values(M0.__rjs_quoted__.chaperone_struct(proc3124,acc3127,function(self3128, sub_proc3129) {var let_result1808 = wrap3123(sub_proc3129,normalize_proc(sub_proc3129));var f3130 = let_result1808.getAt(0);var acc3131 = let_result1808.getAt(1);return f3130;}),acc3127);} else {if (is_impersonator_p3069!==false) {var if_res1822 = M0.__rjs_quoted__.impersonate_struct;} else {var if_res1822 = M0.__rjs_quoted__.chaperone_struct;}if (okp_p(n_proc3125)!==false) {var if_res1821 = chaperone_procedure_by_add_mark3083(proc3124,wrap_proc3074);} else {var if_res1821 = proc3124;}var new_kw_proc3132 = if_res1822(if_res1821,new_procedure_ref,function(self3133, proc3134) {if (is_impersonator_p3069!==false) {var if_res1820 = new_impersonate_procedure;} else {var if_res1820 = new_chaperone_procedure;}if (self_arg_p3070!==false) {var if_res1819 = $rjs_core.attachProcedureArity(function(proc_self3135, kws3136, kw_args3137, self3138, ...args31391809) {var args3139 = $rjs_core.Pair.listFromArray(args31391809);var len3140 = M0.length(args3139);return M0.call_with_values(function() {return M0.apply(kw_chaperone3086,proc_self3135,kws3136,kw_args3137,args3139);},$rjs_core.attachProcedureArity(function(...results31411810) {var results3141 = $rjs_core.Pair.listFromArray(results31411810);var r_len3142 = M0.length(results3141);var list_take3143 = function(l3144, n3145) {if (M0.zero_p(n3145)!==false) {var if_res1811 = M0.rnull;} else {var if_res1811 = M0.cons(M0.car(l3144),list_take3143(M0.cdr(l3144),M0.sub1(n3145)));}return if_res1811;};if (M0.null_p($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("proc-self")))!==false) {var if_res1812 = M0.__eq_(r_len3142,2+len3140);} else {var if_res1812 = false;}if (if_res1812!==false) {var if_res1813 = M0.apply(M0.values,M0.cadr(results3141),self3138,M0.cddr(results3141));} else {var skip3146 = r_len3142-len3140;var if_res1813 = M0.apply(M0.values,M0.append(list_take3143(results3141,skip3146-2),M0.list(M0.list_ref(results3141,M0.sub1(skip3146)),self3138),M0.__rjs_quoted__.list_tail(results3141,skip3146)));}return if_res1813;}));});} else {var if_res1819 = $rjs_core.attachProcedureArity(function(kws3147, kw_args3148, self3149, ...args31501814) {var args3150 = $rjs_core.Pair.listFromArray(args31501814);var len3151 = M0.length(args3150);return M0.call_with_values(function() {return M0.apply(kw_chaperone3086,kws3147,kw_args3148,args3150);},$rjs_core.attachProcedureArity(function(...results31521815) {var results3152 = $rjs_core.Pair.listFromArray(results31521815);var r_len3153 = M0.length(results3152);var list_take3154 = function(l3155, n3156) {if (M0.zero_p(n3156)!==false) {var if_res1816 = M0.rnull;} else {var if_res1816 = M0.cons(M0.car(l3155),list_take3154(M0.cdr(l3155),M0.sub1(n3156)));}return if_res1816;};if (M0.null_p($rjs_core.Pair.makeList())!==false) {var if_res1817 = M0.__eq_(r_len3153,2+len3151);} else {var if_res1817 = false;}if (if_res1817!==false) {var if_res1818 = M0.apply(M0.values,M0.cadr(results3152),self3149,M0.cddr(results3152));} else {var skip3157 = r_len3153-len3151;var if_res1818 = M0.apply(M0.values,M0.append(list_take3154(results3152,skip3157-2),M0.list(M0.list_ref(results3152,M0.sub1(skip3157)),self3149),M0.__rjs_quoted__.list_tail(results3152,skip3157)));}return if_res1818;}));});}return if_res1820(proc3134,make_keyword_procedure(if_res1819));});var if_res1823 = M0.values(new_kw_proc3132,new_procedure_ref);}var if_res1828 = if_res1823;} else {if (okp_p(n_proc3125)!==false) {if (is_impersonator_p3069!==false) {if (okm_p(n_proc3125)!==false) {var if_res1824 = make_optional_keyword_method_impersonator;} else {var if_res1824 = make_optional_keyword_procedure_impersonator;}var if_res1825 = if_res1824(keyword_procedure_checker(n_proc3125),chaperone_procedure_by_add_mark3083(keyword_procedure_proc(n_proc3125),kw_chaperone3086),keyword_procedure_required(n_proc3125),keyword_procedure_allowed(n_proc3125),chaperone_procedure_by_add_mark3083(okp_ref(n_proc3125,0),okp_ref(n_wrap_proc3077,0)),n_proc3125);} else {var if_res1825 = M0.__rjs_quoted__.chaperone_struct(proc3124,keyword_procedure_proc,function(self3158, proc3159) {return chaperone_procedure_by_add_mark3083(proc3159,kw_chaperone3086);},M0.make_struct_field_accessor(okp_ref,0),function(self3160, proc3161) {return chaperone_procedure_by_add_mark3083(proc3161,okp_ref(n_wrap_proc3077,0));});}var if_res1827 = M0.values(if_res1825,keyword_procedure_proc);} else {if (is_impersonator_p3069!==false) {var name_plus_fail3162 = keyword_procedure_name_plus_fail(n_proc3125);var mk3163 = make_required(M0.car(name_plus_fail3162),M0.cdr(name_plus_fail3162),keyword_method_p(n_proc3125),true);var if_res1826 = mk3163(keyword_procedure_checker(n_proc3125),chaperone_procedure_by_add_mark3083(keyword_procedure_proc(n_proc3125),kw_chaperone3086),keyword_procedure_required(n_proc3125),keyword_procedure_allowed(n_proc3125),n_proc3125);} else {var if_res1826 = M0.__rjs_quoted__.chaperone_struct(n_proc3125,keyword_procedure_proc,function(self3164, proc3165) {return chaperone_procedure_by_add_mark3083(proc3165,kw_chaperone3086);});}var if_res1827 = M0.values(if_res1826,keyword_procedure_proc);}var if_res1828 = if_res1827;}return if_res1828;};var let_result1829 = wrap3123(proc3073,n_proc3076);var new_proc3121 = let_result1829.getAt(0);var chap_accessor3122 = let_result1829.getAt(1);if (M0.null_p(props3075)!==false) {var if_res1830 = new_proc3121;} else {var if_res1830 = M0.apply(M0.__rjs_quoted__.chaperone_struct,new_proc3121,chap_accessor3122,false,props3075);}var if_res1831 = if_res1830;}return if_res1831;};var do_unsafe_chaperone_procedure = function(unsafe_chaperone_procedure3166, name3167, proc3168, wrap_proc3169, props3170) {var n_proc3171 = normalize_proc(proc3168);var n_wrap_proc3172 = normalize_proc(wrap_proc3169);var or_part3173 = M0.not(keyword_procedure_p(n_proc3171));if (or_part3173!==false) {var if_res1833 = or_part3173;} else {var or_part3174 = M0.not(M0.procedure_p(wrap_proc3169));if (or_part3174!==false) {var if_res1832 = or_part3174;} else {var if_res1832 = bad_props_p(props3170);}var if_res1833 = if_res1832;}if (if_res1833!==false) {var if_res1834 = M0.apply(unsafe_chaperone_procedure3166,proc3168,wrap_proc3169,props3170);} else {chaperone_arity_match_checking(false,name3167,proc3168,wrap_proc3169,props3170);var if_res1834 = M0.apply(unsafe_chaperone_procedure3166,proc3168,wrap_proc3169,props3170);}return if_res1834;};var bad_props_p = function(props3175) {var loop3176 = function(props3177) {if (M0.null_p(props3177)!==false) {var if_res1837 = false;} else {if (M0.__rjs_quoted__.impersonator_property_p(M0.car(props3177))!==false) {var props3178 = M0.cdr(props3177);var or_part3179 = M0.null_p(props3178);if (or_part3179!==false) {var if_res1835 = or_part3179;} else {var if_res1835 = loop3176(M0.cdr(props3178));}var if_res1836 = if_res1835;} else {var if_res1836 = true;}var if_res1837 = if_res1836;}return if_res1837;};return loop3176(props3175);};var chaperone_arity_match_checking = function(self_arg_p3180, name3181, proc3182, wrap_proc3183, props3184) {var a3185 = M0.procedure_arity(proc3182);var b3186 = M0.procedure_arity(wrap_proc3183);if (self_arg_p3180!==false) {var if_res1838 = 1;} else {var if_res1838 = 0;}var d3187 = if_res1838;var let_result1839 = procedure_keywords(proc3182);var a_req3188 = let_result1839.getAt(0);var a_allow3189 = let_result1839.getAt(1);var let_result1840 = procedure_keywords(wrap_proc3183);var b_req3190 = let_result1840.getAt(0);var b_allow3191 = let_result1840.getAt(1);var includes_p3192 = function(a3193, b3194) {if (M0.number_p(b3194)!==false) {if (M0.number_p(a3193)!==false) {var if_res1842 = M0.__eq_(b3194,a3193+d3187);} else {if (M0.arity_at_least_p(a3193)!==false) {var if_res1841 = M0.__gt__eq_(b3194,M0.arity_at_least_value(a3193)+d3187);} else {var if_res1841 = M0.ormap(function(a3195) {return includes_p3192(a3195,b3194);},a3193);}var if_res1842 = if_res1841;}var if_res1846 = if_res1842;} else {if (M0.arity_at_least_p(b3194)!==false) {if (M0.number_p(a3193)!==false) {var if_res1844 = false;} else {if (M0.arity_at_least_p(a3193)!==false) {var if_res1843 = M0.__gt__eq_(M0.arity_at_least_value(b3194),M0.arity_at_least_value(a3193)+d3187);} else {var if_res1843 = M0.ormap(function(a3196) {return includes_p3192(b3194,a3196);},a3193);}var if_res1844 = if_res1843;}var if_res1845 = if_res1844;} else {var if_res1845 = M0.andmap(function(b3197) {return includes_p3192(a3193,b3197);},b3194);}var if_res1846 = if_res1845;}return if_res1846;};if (includes_p3192(b3186,a3185)!==false) {var if_res1847 = M0.rvoid();} else {var if_res1847 = M0.apply(M0.__rjs_quoted__.chaperone_procedure,proc3182,wrap_proc3183,props3184);}if_res1847;if (subset_p(b_req3190,a_req3188)!==false) {var if_res1848 = M0.rvoid();} else {var if_res1848 = M0.raise_arguments_error(name3181,$rjs_core.UString.make("wrapper procedure requires more keywords than original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc3183,$rjs_core.UString.make("original procedure"),proc3182);}if_res1848;var or_part3198 = M0.not(b_allow3191);if (or_part3198!==false) {var if_res1850 = or_part3198;} else {if (a_allow3189!==false) {var if_res1849 = subset_p(a_allow3189,b_allow3191);} else {var if_res1849 = false;}var if_res1850 = if_res1849;}if (if_res1850!==false) {var if_res1851 = M0.rvoid();} else {var if_res1851 = M0.raise_arguments_error(name3181,$rjs_core.UString.make("wrapper procedure does not accept all keywords of original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc3183,$rjs_core.UString.make("original procedure"),proc3182);}if_res1851;return M0.rvoid();};var normalize_proc = function(proc3199) {if (keyword_procedure_p(proc3199)!==false) {var if_res1859 = proc3199;} else {if (new_procedure_p(proc3199)!==false) {var let_result1852 = procedure_keywords(proc3199);var req_kws3200 = let_result1852.getAt(0);var allowed_kws3201 = let_result1852.getAt(1);if (M0.null_p(allowed_kws3201)!==false) {var if_res1857 = proc3199;} else {var if_res1857 = make_optional_keyword_procedure(function(given_kws3202, given_argc3203) {if (M0.procedure_arity_includes_p(proc3199,given_argc3203-2,true)!==false) {var or_part3204 = M0.not(allowed_kws3201);if (or_part3204!==false) {var if_res1854 = or_part3204;} else {var if_res1854 = subset_p(given_kws3202,allowed_kws3201);}if (if_res1854!==false) {var if_res1855 = subset_p(req_kws3200,given_kws3202);} else {var if_res1855 = false;}var if_res1856 = if_res1855;} else {var if_res1856 = false;}return if_res1856;},$rjs_core.attachProcedureArity(function(kws3205, kw_args3206, ...vals32071853) {var vals3207 = $rjs_core.Pair.listFromArray(vals32071853);return keyword_apply(proc3199,kws3205,kw_args3206,vals3207);}),req_kws3200,allowed_kws3201,proc3199);}var if_res1858 = if_res1857;} else {var if_res1858 = proc3199;}var if_res1859 = if_res1858;}return if_res1859;};var __rjs_quoted__ = {};__rjs_quoted__.make_optional_keyword_method = make_optional_keyword_method;__rjs_quoted__.struct_keyword_procedure_by_arity_error = struct_keyword_procedure_by_arity_error;__rjs_quoted__.prop_named_keyword_procedure = prop_named_keyword_procedure;__rjs_quoted__.make_optional_keyword_procedure = make_optional_keyword_procedure;__rjs_quoted__.struct_keyword_procedure = struct_keyword_procedure;__rjs_quoted__.struct_keyword_method_by_arity_error = struct_keyword_method_by_arity_error;__rjs_quoted__.subset_p = subset_p;__rjs_quoted__.missing_kw = missing_kw;__rjs_quoted__.subsets_p = subsets_p;__rjs_quoted__.keyword_procedure_extract = keyword_procedure_extract;export { __rjs_quoted__,new_impersonate_procedure_times_,new_chaperone_procedure_times_,new_unsafe_impersonate_procedure,new_impersonate_procedure,new_unsafe_chaperone_procedure,new_chaperone_procedure,new_procedure_rename,new_procedure__gt_method,new_prop_procedure,procedure_reduce_keyword_arity_mask,procedure_reduce_keyword_arity,new_procedure_reduce_arity_mask,new_procedure_reduce_arity,procedure_keywords,keyword_apply,make_keyword_procedure };