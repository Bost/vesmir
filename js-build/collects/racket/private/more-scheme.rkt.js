import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/paramz.rkt.js";var current_parameterization = function() {return M0.continuation_mark_set_first(false,M1.parameterization_key);};var call_with_parameterization = function(paramz2766, thunk2767) {if (M0.__rjs_quoted__.parameterization_p(paramz2766)!==false) {var if_res1471 = M0.rvoid();} else {var if_res1471 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("call-with-parameterization"),$rjs_core.UString.make("parameterization?"),0,paramz2766,thunk2767);}if_res1471;if (M0.procedure_p(thunk2767)!==false) {var if_res1472 = M0.procedure_arity_includes_p(thunk2767,0);} else {var if_res1472 = false;}if (if_res1472!==false) {var if_res1473 = M0.rvoid();} else {var if_res1473 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("call-with-parameterization"),$rjs_core.UString.make("(-> any)"),1,paramz2766,thunk2767);}if_res1473;var __context1474 = $rjs_core.Marks.getFrames();var __context1475;try {__context1475 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.parameterization_key,paramz2766);var __wcm_result1476 = thunk2767();} finally {$rjs_core.Marks.updateFrame(__context1474,__context1475);}return __wcm_result1476;};var let_result1478 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("break-parameterization"),false,1,0,false);var struct_break_paramz = let_result1478.getAt(0);var make_break_paramz = let_result1478.getAt(1);var break_paramz_p = let_result1478.getAt(2);var break_paramz_ref = let_result1478.getAt(3);var break_paramz_set_bang_ = let_result1478.getAt(4);var let_result1479 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("break-parameterization"),false,1,0,false,M0.rnull,M0.current_inspector());var type2768 = let_result1479.getAt(0);var maker2769 = let_result1479.getAt(1);var pred2770 = let_result1479.getAt(2);var access2771 = let_result1479.getAt(3);var mutate2772 = let_result1479.getAt(4);var let_result1480 = M0.values(type2768,maker2769,pred2770,M0.make_struct_field_accessor(access2771,0,$rjs_core.PrimitiveSymbol.make("cell")),M0.make_struct_field_mutator(mutate2772,0,$rjs_core.PrimitiveSymbol.make("cell")));var struct_break_parameterization = let_result1480.getAt(0);var make_break_parameterization = let_result1480.getAt(1);var break_parameterization_p = let_result1480.getAt(2);var break_parameterization_cell = let_result1480.getAt(3);var set_break_parameterization_cell_bang_ = let_result1480.getAt(4);var current_break_parameterization = function() {return make_break_paramz(M0.continuation_mark_set_first(false,M1.break_enabled_key));};var call_with_break_parameterization = function(paramz2773, thunk2774) {if (break_paramz_p(paramz2773)!==false) {var if_res1481 = M0.rvoid();} else {var if_res1481 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("call-with-break-parameterization"),$rjs_core.UString.make("break-parameterization?"),0,paramz2773,thunk2774);}if_res1481;if (M0.procedure_p(thunk2774)!==false) {var if_res1482 = M0.procedure_arity_includes_p(thunk2774,0);} else {var if_res1482 = false;}if (if_res1482!==false) {var if_res1483 = M0.rvoid();} else {var if_res1483 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("call-with-parameterization"),$rjs_core.UString.make("(-> any)"),1,paramz2773,thunk2774);}if_res1483;var __context1485 = $rjs_core.Marks.getFrames();var __context1486;try {__context1486 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,break_paramz_ref(paramz2773,0));M1.check_for_break();var __wcm_result1487 = thunk2774();} finally {$rjs_core.Marks.updateFrame(__context1485,__context1486);}var begin_res1484 = __wcm_result1487;M1.check_for_break();return begin_res1484;};var select_handler_by_no_breaks = function(e2775, bpz2776, l2777) {var __context1496 = $rjs_core.Marks.getFrames();var __context1497;try {__context1497 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,M0.make_thread_cell(false));var loop2778 = function(l2779) {if (M0.null_p(l2779)!==false) {var if_res1495 = M0.raise(e2775);} else {if (M0.caar(l2779)(e2775)!==false) {var begin_res1489 = M0.cdar(l2779)(e2775);var __context1490 = $rjs_core.Marks.getFrames();var __context1491;try {__context1491 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,bpz2776);var __wcm_result1492 = M1.check_for_break();} finally {$rjs_core.Marks.updateFrame(__context1490,__context1491);}__wcm_result1492;var if_res1494 = begin_res1489;} else {var if_res1494 = loop2778(M0.cdr(l2779));}var if_res1495 = if_res1494;}return if_res1495;};var __wcm_result1498 = loop2778(l2777);} finally {$rjs_core.Marks.updateFrame(__context1496,__context1497);}return __wcm_result1498;};var select_handler_by_breaks_as_is = function(e2780, bpz2781, l2782) {if (M0.null_p(l2782)!==false) {var if_res1505 = M0.raise(e2780);} else {if (M0.caar(l2782)(e2780)!==false) {var __context1500 = $rjs_core.Marks.getFrames();var __context1501;try {__context1501 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,bpz2781);M1.check_for_break();var __wcm_result1502 = M0.cdar(l2782)(e2780);} finally {$rjs_core.Marks.updateFrame(__context1500,__context1501);}var if_res1504 = __wcm_result1502;} else {var if_res1504 = select_handler_by_breaks_as_is(e2780,bpz2781,M0.cdr(l2782));}var if_res1505 = if_res1504;}return if_res1505;};var false_thread_cell = M0.make_thread_cell(false);var check_with_handlers_in_context = function(handler_prompt_key2783) {if (M0.__rjs_quoted__.continuation_prompt_available_p(handler_prompt_key2783)!==false) {var if_res1506 = M0.rvoid();} else {var if_res1506 = M0.error($rjs_core.PrimitiveSymbol.make("with-handlers"),$rjs_core.UString.make("exception handler used out of context"));}return if_res1506;};var handler_prompt_key = M0.make_continuation_prompt_tag($rjs_core.PrimitiveSymbol.make("handler-prompt-tag"));var call_handled_body = function(bpz2784, handle_proc2785, body_thunk2786) {var __context1515 = $rjs_core.Marks.getFrames();var __context1516;try {__context1516 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,false_thread_cell);var __wcm_result1517 = M0.call_with_continuation_prompt(function(bpz2787, body_thunk2788) {var __context1511 = $rjs_core.Marks.getFrames();var __context1512;try {__context1512 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,bpz2787);var __context1507 = $rjs_core.Marks.getFrames();var __context1508;try {__context1508 = __context1507;$rjs_core.Marks.setMark(M1.exception_handler_key,function(e2789) {return M0.abort_current_continuation(handler_prompt_key,e2789);});var __wcm_result1509 = body_thunk2788();} finally {$rjs_core.Marks.updateFrame(__context1507,__context1508);}var __wcm_result1513 = __wcm_result1509;} finally {$rjs_core.Marks.updateFrame(__context1511,__context1512);}return __wcm_result1513;},handler_prompt_key,handle_proc2785,bpz2784,body_thunk2786);} finally {$rjs_core.Marks.updateFrame(__context1515,__context1516);}return __wcm_result1517;};var call_with_exception_handler = function(exnh2790, thunk2791) {var __context1520 = $rjs_core.Marks.getFrames();var __context1521;try {__context1521 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.exception_handler_key,exnh2790);var __wcm_result1522 = thunk2791();} finally {$rjs_core.Marks.updateFrame(__context1520,__context1521);}var begin_res1519 = __wcm_result1522;M0.rvoid();return begin_res1519;};var call_by_cc = M0.__rjs_quoted__.call_with_current_continuation;var not_there = M0.gensym();var do_hash_update = function(who2792, mut_p2793, set2794, ht2795, key2796, xform2797, default2798) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1530 = M0.rvoid();} else {if (M0.hash_p(ht2795)!==false) {if (mut_p2793!==false) {var if_res1524 = M0.not(M0.immutable_p(ht2795));} else {var if_res1524 = M0.immutable_p(ht2795);}var if_res1525 = if_res1524;} else {var if_res1525 = false;}if (if_res1525!==false) {var if_res1527 = M0.rvoid();} else {if (mut_p2793!==false) {var if_res1526 = $rjs_core.UString.make("(and/c hash? (not/c immutable?))");} else {var if_res1526 = $rjs_core.UString.make("(and/c hash? immutable?)");}var if_res1527 = M0.raise_argument_error(who2792,if_res1526,ht2795);}if_res1527;if (M0.procedure_p(xform2797)!==false) {var if_res1528 = M0.procedure_arity_includes_p(xform2797,1);} else {var if_res1528 = false;}if (if_res1528!==false) {var if_res1529 = M0.rvoid();} else {var if_res1529 = M0.raise_argument_error(who2792,$rjs_core.UString.make("(any/c . -> . any/c)"),xform2797);}var if_res1530 = if_res1529;}if_res1530;var v2799 = M0.hash_ref(ht2795,key2796,default2798);if (M0.eq_p(v2799,not_there)!==false) {var if_res1531 = M0.raise_mismatch_error(who2792,$rjs_core.UString.make("no value found for key: "),key2796);} else {var if_res1531 = set2794(ht2795,key2796,xform2797(v2799));}return if_res1531;};var cl1532 = function(ht2800, key2801, xform2802, default2803) {return do_hash_update($rjs_core.PrimitiveSymbol.make("hash-update"),false,M0.hash_set,ht2800,key2801,xform2802,default2803);};var cl1533 = function(ht2804, key2805, xform2806) {return hash_update(ht2804,key2805,xform2806,not_there);};var hash_update = $rjs_core.attachProcedureArity(function() {var fixed_lam1534 = {'4':cl1532,'3':cl1533}[arguments.length];if (fixed_lam1534!==undefined) {return fixed_lam1534.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[3,4]);var cl1535 = function(ht2807, key2808, xform2809, default2810) {return do_hash_update($rjs_core.PrimitiveSymbol.make("hash-update!"),true,M0.hash_set_bang_,ht2807,key2808,xform2809,default2810);};var cl1536 = function(ht2811, key2812, xform2813) {return hash_update_bang_(ht2811,key2812,xform2813,not_there);};var hash_update_bang_ = $rjs_core.attachProcedureArity(function() {var fixed_lam1537 = {'4':cl1535,'3':cl1536}[arguments.length];if (fixed_lam1537!==undefined) {return fixed_lam1537.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[3,4]);var hash_has_key_p = function(ht2814, key2815) {if (M0.hash_p(ht2814)!==false) {var if_res1538 = M0.rvoid();} else {var if_res1538 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("hash-has-key?"),$rjs_core.UString.make("hash?"),0,ht2814,key2815);}if_res1538;return M0.not(M0.eq_p(not_there,M0.hash_ref(ht2814,key2815,not_there)));};var hash_ref_bang_ = function(ht2816, key2817, new2818) {if (M0.hash_p(ht2816)!==false) {var if_res1539 = M0.not(M0.immutable_p(ht2816));} else {var if_res1539 = false;}if (if_res1539!==false) {var if_res1540 = M0.rvoid();} else {var if_res1540 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("hash-ref!"),$rjs_core.UString.make("(and/c hash? (not/c immutable?))"),0,ht2816,key2817,new2818);}if_res1540;var v2819 = M0.hash_ref(ht2816,key2817,not_there);if (M0.eq_p(not_there,v2819)!==false) {if (M0.procedure_p(new2818)!==false) {var if_res1541 = new2818();} else {var if_res1541 = new2818;}var n2820 = if_res1541;M0.hash_set_bang_(ht2816,key2817,n2820);var if_res1542 = n2820;} else {var if_res1542 = v2819;}return if_res1542;};var __rjs_quoted__ = {};__rjs_quoted__.call_by_cc = call_by_cc;__rjs_quoted__.select_handler_by_no_breaks = select_handler_by_no_breaks;__rjs_quoted__.call_handled_body = call_handled_body;__rjs_quoted__.select_handler_by_breaks_as_is = select_handler_by_breaks_as_is;export { __rjs_quoted__,hash_update_bang_,hash_update,hash_has_key_p,hash_ref_bang_,call_by_cc,call_with_exception_handler,break_paramz_p as break_parameterization_p,call_with_break_parameterization,current_break_parameterization,call_with_parameterization,current_parameterization };